
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/mongoDB.html">
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="neo4j.html">
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>MongoDB - Big Data Aplicado</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="MongoDB - Big Data Aplicado" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD2 - Procesado y Presentación Datos Almacenados/mongoDB.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/mongoDB.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="MongoDB - Big Data Aplicado" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD2 - Procesado y Presentación Datos Almacenados/mongoDB.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ud-2-procesado-y-presentacion-datos-almacenados-mongodb" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Big Data Aplicado" class="md-header__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Data Aplicado
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MongoDB
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Big Data Aplicado" class="md-nav__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Big Data Aplicado
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadatos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadatos
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guia_didactica.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía Didáctica
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD1 - Gestión de Soluciones
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            UD1 - Gestión de Soluciones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/1_dis_const_soluc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diseño y Construcción de Soluciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/2_proced_mecan_ingesta_datos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedimientos y Mecanismos de Ingesta de Datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/3_form_datos_almacenamiento.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formato de Datos Adecuado para el Almacenamiento
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD2 - Procesado y Presentación Datos Almacenados
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            UD2 - Procesado y Presentación Datos Almacenados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="mongoDB.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-caracteristicas" class="md-nav__link">
    <span class="md-ellipsis">
      1. Características
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-conceptos-basicos" class="md-nav__link">
    <span class="md-ellipsis">
      2. Conceptos básicos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Conceptos básicos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-bson" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 BSON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-document-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Document Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-comandos-de-administracion" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Comandos de Administración
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-instalacion-y-uso" class="md-nav__link">
    <span class="md-ellipsis">
      3. Instalación y uso
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Instalación y uso">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-docker" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-soluciones-mongo" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Soluciones Mongo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-mongo-atlas" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Mongo Atlas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-mongodb-shell" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 MongoDB Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-mongodb-para-vs-code" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 MongoDB para VS Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-mongodb-compass" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 MongoDB Compass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-mongodb-tools" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 MongoDB Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-operaciones-crud" class="md-nav__link">
    <span class="md-ellipsis">
      4. Operaciones CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Operaciones CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-create-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Create Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-read-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Read Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-update-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Update Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-delete-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Delete Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5. Aggregations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Aggregations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-operator-aggregation-pipelines-stages" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Operator Aggregation Pipelines Stages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-aggregation-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Aggregation Pipelines
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-ejemplo" class="md-nav__link">
    <span class="md-ellipsis">
      6. Ejemplo
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="neo4j.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neo4j
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD3 - Introducción a la computación paralela y distribuida
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            UD3 - Introducción a la computación paralela y distribuida
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/comput_paralela_distribuida.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computación Paralela y Distribuida
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD4%20-%20Apache%20Hadoop/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD4 - Apache Hadoop
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            UD4 - Apache Hadoop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD4%20-%20Apache%20Hadoop/1_Plataforma_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plataforma y Ecosistema Hadoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD4%20-%20Apache%20Hadoop/2_Hadoop_HDFS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD4%20-%20Apache%20Hadoop/3_Hadoop_Map_Reduce.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Map Reduce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD4%20-%20Apache%20Hadoop/4_Hadoop_Yarn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yarn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD4%20-%20Apache%20Hadoop/5_Cluster_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Hadoop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../creditos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creditos
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-caracteristicas" class="md-nav__link">
    <span class="md-ellipsis">
      1. Características
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-conceptos-basicos" class="md-nav__link">
    <span class="md-ellipsis">
      2. Conceptos básicos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Conceptos básicos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-bson" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 BSON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-document-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Document Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-comandos-de-administracion" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Comandos de Administración
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-instalacion-y-uso" class="md-nav__link">
    <span class="md-ellipsis">
      3. Instalación y uso
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Instalación y uso">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-docker" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-soluciones-mongo" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Soluciones Mongo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-mongo-atlas" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Mongo Atlas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-mongodb-shell" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 MongoDB Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-mongodb-para-vs-code" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 MongoDB para VS Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-mongodb-compass" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 MongoDB Compass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-mongodb-tools" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 MongoDB Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-operaciones-crud" class="md-nav__link">
    <span class="md-ellipsis">
      4. Operaciones CRUD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Operaciones CRUD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-create-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Create Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-read-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Read Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-update-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Update Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-delete-operations" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Delete Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5. Aggregations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Aggregations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-operator-aggregation-pipelines-stages" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Operator Aggregation Pipelines Stages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-aggregation-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Aggregation Pipelines
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-ejemplo" class="md-nav__link">
    <span class="md-ellipsis">
      6. Ejemplo
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ud-2-procesado-y-presentacion-datos-almacenados-mongodb">UD 2 - Procesado y Presentación Datos Almacenados - MongoDB<a class="headerlink" href="#ud-2-procesado-y-presentacion-datos-almacenados-mongodb" title="Permanent link">&para;</a></h1>
<p>El nombre <strong>MongoDB</strong> proviene de la palabra inglesa <strong>"homongous"</strong> que significa enorme. <strong>MongoDB es, por tanto, un sistema de base de datos NoSQL, open source, orientado a documentos y escrito en lenguaje C++</strong>. Este sistema de bases de datos está disponible no solo para múltiples plataformas y sistemas operativos (Windows, Linux, OS X) sino también como servicio empresarial en la nube y se puede integrar con otros servicios como, por ejemplo, Amazon Web Services (AWS).</p>
<h2 id="1-caracteristicas">1. Características<a class="headerlink" href="#1-caracteristicas" title="Permanent link">&para;</a></h2>
<p>Tal y como se ha presentado anteriormente, MongoDB es un sistema de bases de datos documental u orientado a documentos. Esta orientación hace que los datos se almacenen de forma estructurada en forma de documentos, los cuales se acoplan sin problema en los tipos de datos utilizados por los lenguajes de programación. Además, esta concepción hace que una base de datos MongoDB disponga de un esquema dinámico y fácilmente modificable.</p>
<p>En este apartado se pretende poner de relieve <strong>las principales características de MongoDB</strong> que hacen que sea en la actualidad uno de los sistemas de bases de datos NoSQL más utilizados tanto en el ámbito académico como en el profesional. </p>
<ul>
<li>
<p><strong>Alto rendimiento</strong>: Gracias a la definición de los documentos y la creación de índices que hace que las lecturas y escrituras se realicen de forma más rápida.</p>
</li>
<li>
<p><strong>Alta disponibilidad</strong>: MongoDB dispone de servidores replicados con restablecimiento automático maestro.</p>
</li>
<li>
<p><strong>Fácil escalabilidad</strong>: Permitiendo distribuir colecciones de documentos entre diferentes máquinas de forma muy sencilla.</p>
</li>
<li>
<p><strong>Indexación</strong>: Similar al concepto de índice en una base de datos relacional, permite crear índices e índices secundarios para mejorar el rendimiento de las consultas.</p>
</li>
<li>
<p><strong>Consultas ad-hoc</strong>: Al igual que en una base de datos relacional, MongoDB da soporte a la búsqueda por campos, consultas de rangos, uso de expresiones regulares... A todo lo anterior, se añade la posibilidad de ejecutar y devolver una función JavaScript definida por el programador.</p>
</li>
<li>
<p><strong>Replicación</strong>: Siguiendo el modelo maestro-esclavo. El maestro puede ejecutar comandos de lectura y escritura mientras que el esclavo solo tiene acceso de lectura y la posibilidad de realizar copias de seguridad. En caso de que el maestro caiga, el esclavo puede elegir un nuevo maestro para mantener el servicio de replicación.</p>
</li>
<li>
<p><strong>Balanceo de carga</strong>: MongoDB es capaz de ejecutarse en múltiples servidores, pudiendo balancear la carga y/o duplicar los datos para mantener el correcto funcionamiento del sistema aunque se produzca un fallo hardware.</p>
</li>
<li>
<p><strong>Almacenamiento de archivos</strong>: Todo lo anterior, facilita que este sistema de base de datos pueda ser usado con un sistema de archivos GridFS con balanceo de carga y replicación.</p>
</li>
<li>
<p><strong>Agregación</strong>: Proporciona operadores de agregación y la posibilidad de utilizar funciones MapReduce para el procesamiento de datos por lotes.</p>
</li>
<li>
<p><strong>Ejecución de Javscript del lado del servidor</strong>: Es posible realizar consultas utilizando JavaScript, de forma que éstas son enviadas directamente a la base de datos para ser ejecutadas.</p>
</li>
</ul>
<p>Todas estas características hacen que, en la actualidad, MongoDB sea uno de los principales sistemas de bases de datos NoSQL elegidos en multitud de aplicaciones como: <strong>almacenamiento y registro de eventos, comercio electrónico, juegos, aplicaciones móviles, almacenes de datos, gestión de estadísticas en tiempo real y cualquier aplicación que requiera llevar a cabo analíticas sobre grandes volúmenes de datos</strong>.</p>
<h2 id="2-conceptos-basicos">2. Conceptos básicos<a class="headerlink" href="#2-conceptos-basicos" title="Permanent link">&para;</a></h2>
<p>Aunque MongoDB es un sistema de bases de datos NoSQL con todo lo que ello implica, también ofrece toda la funcionalidad de la que disponen las bases de datos relacionales. Sin embargo, <strong>la estructura de una base de datos MongoDB difiere de la de una base de datos relacional</strong>.</p>
<p>En un servidor MongoDB es posible crear tantas bases de datos como se desee. El concepto de <strong>base de datos</strong> es en este caso equivalente al de <strong>base de datos</strong> en los sistemas relacionales. Una vez creada, la base de datos estará compuesta por una o más <strong>colecciones</strong>. El término colección en el ámbito NoSQL es el equivalente al concepto de <strong>tabla</strong> en los sistemas relacionales.</p>
<p>Cada colección, por tanto, estará formada por un conjunto de <strong>documentos</strong> (o incluso ninguno, en cuyo caso la colección estaría vacía). El concepto de documento en NoSQL se corresponde con el concepto de <strong>registro</strong> en una base de datos relacional. Un documento estará compuesto por una serie de <strong>campos</strong>, al igual que lo están los registros de una base de datos relacional.</p>
<p>En el ámbito NoSQL, y más concretamente en MongoDB, cada documento viene dado por un archivo <strong>JSON</strong> <a href="http://www.json.org/">http://www.json.org/</a> <em>(BSON, en realidad, que veremos justo en el siguiente punto)</em> en el cual, siguiendo una estructura clave-valor se especifican las características de cada documento. El siguiente código muestra un ejemplo de documento que define un barco.</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">    </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="w"> </span><span class="err">E</span><span class="kc">nter</span><span class="err">prise</span><span class="mi">-</span><span class="err">D&#39;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">    </span><span class="err">opera</span><span class="kc">t</span><span class="err">or</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;S</span><span class="kc">tarfleet</span><span class="err">&#39;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">    </span><span class="kc">t</span><span class="err">ype</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Explorer&#39;</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">    </span><span class="err">class</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Galaxy&#39;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">    </span><span class="err">crew</span><span class="p">:</span><span class="w"> </span><span class="mi">750</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos="7 "></span></a><span class="w">    </span><span class="err">codes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos="8 "></span></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="21-bson">2.1 BSON<a class="headerlink" href="#21-bson" title="Permanent link">&para;</a></h3>
<p>BSON es un formato de intercambio de datos usado principalmente para su almacenamiento y transferencia en la base de datos <strong><em>MongoDB</em></strong>. Es una representación binaria de estructuras de datos y mapas. El nombre BSON está basado en el término <strong>JSON</strong> y significa <strong>Binary JSON (JSON Binario)</strong>. Consulta su especificación en su página oficial <a href="https://bsonspec.org/">https://bsonspec.org/</a></p>
<div class="admonition info">
<p class="admonition-title">BSON fue diseñado para tener las siguientes características</p>
<ul>
<li><strong>Ligero</strong>: Mantener la sobrecarga espacial al mínimo es importante para cualquier formato de representación de datos, especialmente cuando se utiliza a través de la red.</li>
<li><strong>Transitable</strong>: BSON está diseñado para ser recorrido fácilmente. Esta es una propiedad vital en su papel como la principal representación de datos para MongoDB.</li>
<li><strong>Eficiente</strong>: La codificación de datos a BSON y la decodificación desde BSON puede realizarse muy rápidamente en la mayoría de lenguajes debido al uso de tipos de datos C.</li>
</ul>
</div>
<p>Un <strong>objeto BSON</strong> consiste en una lista ordenada de elementos. Cada elemento consta de un campo nombre, un tipo y un valor. Los nombres son de tipo String y los tipos pueden ser:</p>
<figure style="align: center;">
    <img src="images/MongoDB_BSON_1_Tipos.jpg">
    <figcaption>Figura BSON 1: Tipos de datos BSON. (Fuente: MongoDB)</figcaption>
</figure>

<p>Un ejemplo de un objeto BSON podría ser</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">var</span><span class="w"> </span><span class="err">mydoc</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">               </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">Objec</span><span class="kc">t</span><span class="err">Id(</span><span class="s2">&quot;5099803df3f4948bd2f98391&quot;</span><span class="err">)</span><span class="p">,</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><a href="#__codelineno-1-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">               </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kc">f</span><span class="err">irs</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alan&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">las</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Turing&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><a href="#__codelineno-1-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">               </span><span class="err">bir</span><span class="kc">t</span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="kc">ne</span><span class="err">w</span><span class="w"> </span><span class="err">Da</span><span class="kc">te</span><span class="err">(&#39;Ju</span><span class="kc">n</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">1912</span><span class="err">&#39;)</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><a href="#__codelineno-1-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">               </span><span class="err">dea</span><span class="kc">t</span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="kc">ne</span><span class="err">w</span><span class="w"> </span><span class="err">Da</span><span class="kc">te</span><span class="err">(&#39;Ju</span><span class="kc">n</span><span class="w"> </span><span class="mi">07</span><span class="p">,</span><span class="w"> </span><span class="mi">1954</span><span class="err">&#39;)</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><a href="#__codelineno-1-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">               </span><span class="err">co</span><span class="kc">ntr</span><span class="err">ibs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;Turing machine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Turing test&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Turingery&quot;</span><span class="w"> </span><span class="p">],</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><a href="#__codelineno-1-7"><span class="linenos" data-linenos="7 "></span></a><span class="w">               </span><span class="err">views</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">NumberLo</span><span class="kc">n</span><span class="err">g(</span><span class="mi">1250000</span><span class="err">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a><a href="#__codelineno-1-8"><span class="linenos" data-linenos="8 "></span></a><span class="w">            </span><span class="p">}</span>
</span></code></pre></div>
<p>Donde los campos del ejemplo anterior tienen los siguientes tipos de datos:</p>
<ul>
<li><strong>_id</strong> contiene un <code>ObjectId</code>.</li>
<li><strong>name</strong> contiene un documento embebido que contiene los campos <strong>first</strong> y <strong>last</strong>.</li>
<li><strong>birth</strong> y <strong>death</strong> mantienen valores del tipo <code>Date</code>.</li>
<li><strong>contribs</strong> contiene un <code>string</code>.</li>
<li><strong>views</strong> tiene un valor del tipo <code>NumberLong</code>.</li>
</ul>
<p>Además, BSON también contiene expresiones que permiten la representación de tipos de datos que no forman parte de la especificación JSON. <em>Puedes consultarlos todos en <a href="https://www.mongodb.com/docs/manual/reference/bson-types/">https://www.mongodb.com/docs/manual/reference/bson-types/</a></em></p>
<p>De todos estos tipos de datos, en MongoDB debemos hacer mayor consideración a estos particulares:</p>
<h4 id="binary-data">Binary Data<a class="headerlink" href="#binary-data" title="Permanent link">&para;</a></h4>
<p>EL valor de un Binary Data <code>bindata</code> es un array de bytes. Un valor de <code>bindata</code> tiene un subtipo que indica cómo interpretar los datos binarios. La siguiente tabla muestra los subtipos. </p>
<figure style="align: center;">
    <img src="images/MongoDB_BSON_2_binData.jpg">
    <figcaption>Figura BSON 2: Subtipos de datos BSON Binary Data. (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="objectids">ObjectIds<a class="headerlink" href="#objectids" title="Permanent link">&para;</a></h4>
<p>Los ObjectIds <code>object</code> son pequeños, probablemente únicos, rápidos de generar y ordenados. Los valores de ObjectId tienen una longitud de 12 bytes y constan de:</p>
<ul>
<li>4-byte timestamp, que representa la creación del ObjectId, medida en segundos desde la época de Unix.</li>
<li>Un valor aleatorio de 5 bytes generado una vez por proceso. Este valor aleatorio es exclusivo de la máquina y del proceso.</li>
<li>Un contador incremental de 3 bytes, inicializado a un valor aleatorio.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>En MongoDB, cada documento almacenado en una colección <strong>requiere un campo _id único que actúa como clave principal</strong>. Si un documento insertado omite el campo _id, el controlador MongoDB genera automáticamente un ID de objeto para el campo _id.</p>
</div>
<h4 id="string">String<a class="headerlink" href="#string" title="Permanent link">&para;</a></h4>
<p>BSON String <code>string</code> son UTF-8. En general, los controladores para cada lenguaje de programación convierten del formato de cadena del lenguaje a UTF-8 al serializar y deserializar BSON. Esto hace posible almacenar la mayoría de los caracteres internacionales en cadenas BSON con facilidad. Además, las consultas <em>$regex</em> de MongoDB admiten UTF-8 en la cadena de expresiones regulares.</p>
<h4 id="timestamp">Timestamp<a class="headerlink" href="#timestamp" title="Permanent link">&para;</a></h4>
<p>BSON tiene un tipo <code>timestamp</code> especial para uso interno de MongoDB y no está asociado con el estándar Tipo <em>Date</em>. Este tipo de marca de tiempo interna es un valor de 64 bits donde:</p>
<ul>
<li>los 32 bits más significativos son un valor <code>time_t</code>(segundos desde la época Unix)</li>
<li>los 32 bits menos significativos son un <code>ordinal</code> incremental para operaciones dentro de un segundo determinado.</li>
</ul>
<h3 id="22-document-limitations">2.2 Document Limitations<a class="headerlink" href="#22-document-limitations" title="Permanent link">&para;</a></h3>
<div class="admonition info end inline">
<p class="admonition-title">Info</p>
<p><em>Puedes consultar toda la información relacionada con documentos en <a href="https://www.mongodb.com/docs/manual/core/document/">https://www.mongodb.com/docs/manual/core/document/</a></em></p>
</div>
<h4 id="limite-de-tamano-del-documento">Límite de tamaño del documento<a class="headerlink" href="#limite-de-tamano-del-documento" title="Permanent link">&para;</a></h4>
<p>El tamaño máximo de documento BSON es de 16MB (ayuda a garantizar que un solo documento no pueda utilizar una cantidad excesiva de RAM ni ancho de banda). Para almacenar documentos que superen el tamaño máximo, MongoDB proporciona la API GridFS.</p>
<h4 id="orden-de-campos-del-documento">Orden de campos del documento<a class="headerlink" href="#orden-de-campos-del-documento" title="Permanent link">&para;</a></h4>
<p>A diferencia de los objetos JavaScript, los campos de un documento BSON están ordenados. Pero no asegura que el orden de los campos se respete</p>
<h4 id="case-sensitive">Case sensitive<a class="headerlink" href="#case-sensitive" title="Permanent link">&para;</a></h4>
<p>Es sensible a las mayúsculas y minúsculas</p>
<h3 id="23-comandos-de-administracion">2.3 Comandos de Administración<a class="headerlink" href="#23-comandos-de-administracion" title="Permanent link">&para;</a></h3>
<p>Para la administración del sistema de bases de datos, MongoDB pone a disposición de los usuarios las siguientes utilidades:</p>
<ul>
<li>
<p><strong>mongo</strong>: Se trata del shell interactivo de MongoDB que permite insertar, eliminar, actualizar datos y realizar consultas, además de replicar la información, apagar servidores y ejecutar código JavaScript.</p>
</li>
<li>
<p><strong>mongostat</strong>: Herramienta de línea de comandos que muestra las estadísticas de una instancia en ejecución de MongoDB</p>
</li>
<li>
<p><strong>mongotop</strong>: Herramienta de línea de comandos que muestra la cantidad de tiempo empleado en la lectura y escritura de datos por parte de la instancia en ejecución</p>
</li>
<li>
<p><strong>mongosniff</strong>: Herramienta de línea de comandos que permite hacer un rastreo del tráfico de la red que va desde y hacia MongoDB.</p>
</li>
<li>
<p><strong>mongoimport/mongoexport</strong>: Herramienta de línea de comandos para importar y exportar contenido en o desde .json, .csv o .tsv entre otros.</p>
</li>
<li>
<p><strong>mongodump/mongorestore</strong>: Herramienta de línea de comandos para la creación de una exportación binaria del contenido de la base de datos.</p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">BSON =&gt; JSON</p>
<p>Si necesitamos transformar un fichero BSON a JSON, usaríamos el comando (bsondump)[https://www.mongodb.com/docs/database-tools/bsondump/]:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a>bsondump file.bson &gt; file.json
</span></code></pre></div>
</div>
<h2 id="3-instalacion-y-uso">3. Instalación y uso<a class="headerlink" href="#3-instalacion-y-uso" title="Permanent link">&para;</a></h2>
<h3 id="31-docker">3.1 Docker<a class="headerlink" href="#31-docker" title="Permanent link">&para;</a></h3>
<p>Vamos a explicar como levantar un contenedor MongoDB con Docker</p>
<div class="admonition warning">
<p class="admonition-title">Docker engine vs Docker Desktop on Linux</p>
<p>Linux, ya tenemos por defecto docker engine para la ejecución de contenedores. Si instalamos docker desktop hay que tener en cuenta que docker desktop trabaja sobre un maquina virtual <strong>KVM</strong>. Esto significa que las imágenes desplegadas en docker engine no están disponibles en docker desktop y viceversa. Para ello podemos "jugar" con el contexto de docker.</p>
<p>Para más información observa la documentación oficial de docker: <a href="https://docs.docker.com/desktop/faqs/linuxfaqs/#what-is-the-difference-between-docker-desktop-for-linux-and-docker-engine">What is the difference between Docker Desktop for Linux and Docker Engine</a></p>
<p><figure style="align: center; width:600px;">
<img src="images/MongoDB_Docker_1.jpg">
    <figcaption>Figura Docker 1. Docker Desktop on Linux. (Fuente: Docker)</figcaption>
</figure></p>
<p>Para más información observa los siguientes recursos:</p>
<ul>
<li><a href="https://docs.docker.com/desktop/faqs/linuxfaqs/#why-does-docker-desktop-for-linux-run-a-vm">Why does Docker Desktop for Linux run a VM?</a></li>
<li><a href="https://www.youtube.com/watch?v=9hW6SC8VPLQ">Docker Desktop vs. Docker Engine en Ubuntu LTS</a>. Video explicativo</li>
</ul>
</div>
<ol>
<li>Instalar MondoDB en Docker</li>
<li>Vamos a la <a href="https://hub.docker.com/_/mongo">imagen oficial de mondodb en docker</a></li>
<li>Observa con detenimiento la información que nos facilita la imagen oficial para el despliegue y configuración de los contenedores</li>
<li>
<p>Seguimos los pasos, que tienen este formato</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a>docker run -d --network some-network --name some-mongo \
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos="2 "></span></a>-e MONGO_INITDB_ROOT_USERNAME=mongoadmin \
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos="3 "></span></a>-e MONGO_INITDB_ROOT_PASSWORD=secret \
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos="4 "></span></a>mongo:tag
</span></code></pre></div>
En mi caso voy a añadir un bind mount para poder luego importar un fichero para el ejemplo. Por tanto sería:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a>docker run -d --name mongodb-bda1 -e MONGO_INITDB_ROOT_USERNAME=admin -e MONGO_INITDB_ROOT_PASSWORD=admin --mount type=bind,src=/home/jaime/BigData/BDA/,dst=/home/bda mongo:latest
</span></code></pre></div>
También podemos crear el contenedor sin bind mount y copiarla directamente con <code>docker cp</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a>docker run -d --name mongodb-bda1 -e MONGO_INITDB_ROOT_USERNAME=admin -e MONGO_INITDB_ROOT_PASSWORD=admin mongo:latest
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos="2 "></span></a>docker cp fichero mongo:/directorio
</span></code></pre></div>
</li>
<li>
<p>Para añadir documentos, podemos importar datos de un dataset <code>mongoimport</code>, por ejemplo de kaggle, o restaurar una Base de datos <code>mongorestore</code> </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Dataset restaurantes1.csv</label><label for="__tabbed_1_2">sampledata (muestra de datos de MongoDB, la misma de Mongo Atlas)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Descarga <a href="Ejercicios_clase/restaurantes1.csv">restaurantes1.csv</a></p>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a>wget https://atlas-education.s3.amazonaws.com/sampledata.archive
</span></code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Copiamos los archivos que vamos a importar/restaurar</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">restaurantes1.csv</label><label for="__tabbed_2_2">sampledata</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a>docker cp restaurantes1.csv mongodb-bda1:/tmp
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos="1 "></span></a>docker cp sampledata.archive mongodb-bda1:/tmp
</span></code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Abre una terminal en el contenedor (<em>puedes abrirla por Docker Desptop también</em>)</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a>docker exec -it mongodb-bda1 sh
</span></code></pre></div>
</li>
<li>
<p>Restauramos/importamos</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Importamos restaurantes1.csv</label><label for="__tabbed_3_2">Restauramos sampledata</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a>mongoimport --db=db_ej1_restaurantes --collection=restaurantes --file=tmp/restaurantes1.csv --authenticationDatabase=admin --username=admin --password=admin
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a>mongorestore --archive=/tmp/sampledata.archive --authenticationDatabase=admin --username=admin --password=admin
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos="1 "></span></a>2023-10-13T19:20:03.814+0000    preparing collections to restore from
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos="2 "></span></a>2023-10-13T19:20:03.817+0000    reading metadata for sample_airbnb.listingsAndReviews from archive &#39;/tmp/sampledata.archive&#39;
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><a href="#__codelineno-12-3"><span class="linenos" data-linenos="3 "></span></a>2023-10-13T19:20:03.817+0000    reading metadata for sample_analytics.accounts from archive &#39;/tmp/sampledata.archive&#39;
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a><a href="#__codelineno-12-4"><span class="linenos" data-linenos="4 "></span></a>2023-10-13T19:20:03.817+0000    reading metadata for sample_analytics.customers from archive &#39;/tmp/sampledata.archive&#39;
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a><a href="#__codelineno-12-5"><span class="linenos" data-linenos="5 "></span></a>...
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a><a href="#__codelineno-12-6"><span class="linenos" data-linenos="6 "></span></a>2023-10-13T19:20:14.010+0000    425367 document(s) restored successfully. 0 document(s) failed to restore.
</span></code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Comprobamos. Entrar a la consola de mongo y autorizarnos</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="1 "></span></a>mongosh
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a><a href="#__codelineno-13-2"><span class="linenos" data-linenos="2 "></span></a>use admin
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><a href="#__codelineno-13-3"><span class="linenos" data-linenos="3 "></span></a>db.auth(&quot;admin&quot;,&quot;admin&quot;)
</span></code></pre></div>
</li>
<li>
<p>Ver las bases de datos</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos="1 "></span></a>show dbs
</span></code></pre></div>
<p><figure style="align: center;">
<img src="images/MongoDB_Docker_2_Mongosh_Show_dbs.jpg">
    <figcaption>Figura Docker 2. Mostrar las Bases de datos con Mongo. (Fuente: Propia)</figcaption>
</figure></p>
</li>
<li>
<p>Usar la Base de datos (<em>use nombre_bd</em> , también sirve para crear una Base de datos) </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos="1 "></span></a>use db_ej1_restaurantes
</span></code></pre></div>
</li>
<li>
<p>Ver las colecciones de la base de datos que estamos usando</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos="1 "></span></a>show collections
</span></code></pre></div>
</li>
<li>
<p>Mostramos los documentos</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos="1 "></span></a>db.restaurantes.find()
</span></code></pre></div>
</li>
</ol>
<h3 id="32-soluciones-mongo">3.2 Soluciones Mongo<a class="headerlink" href="#32-soluciones-mongo" title="Permanent link">&para;</a></h3>
<p>En la actualidad, MongoDB se comercializa mediante tres productos:</p>
<ul>
<li><a href="https://www.mongodb.com/es/products/mongodb-enterprise-advanced">MongoDB Enterprise Advanced</a>, versión de pago con soporte, herramientas avanzadas de monitorización y seguridad, y administración automatizada.</li>
<li><a href="https://www.mongodb.com/try/download/community">MongoDB Community Edition</a>, Software gratuito para trabajar on-premise, con versiones para diferentes sistemas operativos.</li>
<li><a href="https://www.mongodb.com/atlas">Mongo Atlas</a>, como plataforma cloud, con una opción gratuita mediante un cluster de 512MB.</li>
</ul>
<h4 id="mongodb-community-edition">MongoDB Community Edition<a class="headerlink" href="#mongodb-community-edition" title="Permanent link">&para;</a></h4>
<p>Instalación on-promise de MongoDB. Si deseas una instalación en local puedes seguir las instrucciones de la <a href="https://www.mongodb.com/try/download/community">documentación oficial</a>.</p>
<h3 id="33-mongo-atlas">3.3 Mongo Atlas<a class="headerlink" href="#33-mongo-atlas" title="Permanent link">&para;</a></h3>
<p>Podemos hacer uso de una solución gratuita cloud de Mongo Atlas ofrecida por MongoDB, con 512MB de RAM compartida y 5GB de almacenamiento</p>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_1.jpg">
    <figcaption>Figura Atlas 1: MongoDB Atlas. (Fuente: Propia)</figcaption>
</figure>

<p>Para ello seguimos todos los pasos: <strong><em><a href="https://www.mongodb.com/docs/manual/tutorial/getting-started/">Getting Started MongoDB</a></em></strong></p>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Atlas_2.jpg">
    <figcaption>Figura Atlas 2: MongoDB Atlas. Get Started. (Fuente: Propia)</figcaption>
</figure>

<ol>
<li>
<p>Creamos cuenta</p>
</li>
<li>
<p>Añadir tu dirección ip a la lista de ips de acceso al cluster</p>
<ul>
<li>
<p>Menú izquierdo =&gt; Network Access</p>
</li>
<li>
<p>Add IP Address (Derecha)</p>
</li>
</ul>
</li>
</ol>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_3_Add_IP.jpg">
    <figcaption>Figura Atlas 3: MongoDB Atlas. Añadir IP. (Fuente: MongoDB)</figcaption>
</figure>

<ol start="3">
<li>Desplegamos cluster gratuito. Creamos una Organización, Proyecto y una Base de Datos del cluster</li>
</ol>
<ul>
<li>Crear Organización</li>
</ul>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_4_New_Organization.jpg">
    <figcaption>Figura Atlas 4: Añadir Organización. (Fuente: Propia)</figcaption>
</figure>

<ul>
<li>Crear Proyecto</li>
</ul>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_5_Add_Project.jpg">
    <figcaption>Figura Atlas 5: Añadir Proyecto. (Fuente: Propia)</figcaption>
</figure>

<ul>
<li>Nueva Base de datos</li>
</ul>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_6_New_Database.jpg">
    <figcaption>Figura Atlas 6: Añadir Base de datos. (Fuente: Propia)</figcaption>
</figure>

<ul>
<li>Creando cluster</li>
</ul>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_7_Cluster.jpg">
    <figcaption>Figura Atlas 7: Cluster. (Fuente: Propia)</figcaption>
</figure>

<ol start="4">
<li>Crear un usuario para la Base de Datos</li>
</ol>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_8_New_User.jpg">
    <figcaption>Figura 8 Atlas: Nuevo usuario. (Fuente: Propia)</figcaption>
</figure>

<ol start="5">
<li>
<p>Cargar contenido en nuestra Base de Datos. Vamos a usar uno de los Data Set de ejemplo facilitados por el propio MongoDB.</p>
<ul>
<li>Damos a la opción de los <strong>...</strong> y Load Data Sample.</li>
</ul>
</li>
</ol>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_9_LoadDataSample.jpg">
    <figcaption>Figura Atlas 9. Cargar datos a la Base de Datos. (Fuente: Propia)</figcaption>
</figure>

<ul>
<li>Browser Collections</li>
</ul>
<figure style="align: center;">
    <img src="images/MongoDB_Atlas_10_BrowserCollections.jpg"/>
    <figcaption>Figura Atlas 10: Browser Collections. (Fuente: Propia)</figcaption>
</figure>

<ol>
<li>Conectarte a tu cluster. Hay varias formas de conexión a tu cluster.</li>
</ol>
<ul>
<li>
<p><a href="https://www.mongodb.com/docs/drivers/">A MongoDB driver</a>, un controlador para comunicarse con su base de datos MongoDB mediante programación. Soporta varios lenguajes de programación.</p>
</li>
<li>
<p><a href="https://www.mongodb.com/docs/compass/current/">MongoDB Compass</a>, una GUI para sus datos de MongoDB. Puede utilizar Compass para explorar, modificar y visualizar sus datos.</p>
</li>
<li>
<p><a href="https://www.mongodb.com/docs/mongodb-shell/">The MongoDB Shell</a>, una interfaz de línea de comandos interactiva para MongoDB. Puedes usar mongosh para insertar e interactuar con datos en su clúster Atlas.</p>
</li>
<li>
<p>MongoDB for VS Code. Para trabajar MongoDB en VS Code</p>
</li>
<li>
<p>Atlas SQL. Para conectar fácilmente a Atlas para visualización y análisis de datos</p>
</li>
</ul>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Atlas_11_Connect.jpg">
    <figcaption>Figura Atlas 11. Formas de conexión a Atlas. (Fuente: Propia)</figcaption>
</figure>

<h3 id="34-mongodb-shell">3.4 MongoDB Shell<a class="headerlink" href="#34-mongodb-shell" title="Permanent link">&para;</a></h3>
<p>Para esta conexión, solo necesitamos usar el comando <code>mongosh</code> con las credenciales configuradas anteriormente. Siguiendo los pasos dentro de <strong>connect en la opción Mongo Shell</strong> que nos da Mongo Atlas (figura anterior) </p>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Atlas_12_ConnectShell.jpg">
    <figcaption>Figura Atlas 12. Connect Mongo Shell. (Fuente: Propia)</figcaption>
</figure>

<p>Y escribiendo después la contraseña establecida nos conectamos a nuestro al servicio cloud</p>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Atlas_13_Mongosh_connect.jpg">
    <figcaption>Figura Atlas 13. Connect mongosh. (Fuente: Propia)</figcaption>
</figure>

<h3 id="35-mongodb-para-vs-code">3.5 MongoDB para VS Code<a class="headerlink" href="#35-mongodb-para-vs-code" title="Permanent link">&para;</a></h3>
<ol>
<li>Para ello usamos la <a href="https://marketplace.visualstudio.com/items?itemName=mongodb.mongodb-vscode">extensión</a> <code>MongoDB for VS Code</code> </li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_VSCode_1_extension.jpg">
    <figcaption>Figura MongoDB for VSCode 1. Extensión. (Fuente: Propia)</figcaption>
</figure>

<ol start="2">
<li>Damos a la opción de connect en nuestro MongoDB Atlas y seleccionamos MongoDB for VSCode. Seguimos los pasos que nos indican. Copiamos la url del punto 3 y le añadimos nuestra contraseña</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_VSCode_2_Datos_Conexion.jpg">
    <figcaption>Figura MongoDB for VSCode 2. Conectando con Mondo Atlas. (Fuente: Propia)</figcaption>
</figure>

<ol start="3">
<li>Vamos a nuestra extensión y le damos a <strong>connecting string</strong> y añadimos la url con nuestra contraseña.</li>
</ol>
<figure style="align: center;">
    <img src="images/MongoDB_VSCode_3_Conectado_MongoDB.jpg">
    <figcaption>Figura MongoDB for VSCode 3. Conectado con Mondo Atlas. (Fuente: Propia)</figcaption>
</figure>

<ol start="4">
<li>Seguimos los pasos y creamos un <strong>New Playground</strong>. Como test, ejecutamos (<em>botón play arriba a la derecha</em>) el playground creado por defecto. Observa el resultado, la salida en consola y los nuevos datos creados en nuestra Cloud Database.</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_VSCode_4_PlayGround_Ejecutado.jpg">
    <figcaption>Figura MongoDB for VSCode 4. Ejecutando playground. (Fuente: Propia)</figcaption>
</figure>

<ol start="5">
<li>
<p>Observa el código del playground. Presta especial atención a las palabras reservadas <code>db, use, consolo.log(), print(), printjson()</code>. Para mas información de uso consulta la <a href="https://www.mongodb.com/docs/mongodb-vscode/playgrounds/">documentación oficial</a></p>
</li>
<li>
<p>También puedes ejecutar una shell de mongoDB usando botón derecho sobre la conexión y pulsando <strong><em>Launch MongoDB Shell</em></strong>. <em>Para ello debes tener en tu sistema <a href="https://www.mongodb.com/docs/mongodb-shell/install/">MongoDB Shell</a></em></p>
</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_VSCode_5_MongoDB_Shell.jpg">
    <figcaption>Figura MongoDB for VSCode 5. MongoDB Shell en VSCode. (Fuente: Propia)</figcaption>
</figure>

<h3 id="36-mongodb-compass">3.6 MongoDB Compass<a class="headerlink" href="#36-mongodb-compass" title="Permanent link">&para;</a></h3>
<p>MongoDB <a href="https://www.mongodb.com/es/products/tools/compass">Compass</a> es una potente GUI para consultar, agregar y analizar sus datos de MongoDB en un entorno visual. MongoDB Compass viene con 3 versiones diferentes:</p>
<ul>
<li><strong>Compass</strong>: La <strong>full version</strong> de MongoDB Compass, con todas las características y capacidades.</li>
<li><strong>Readonly Edition</strong>: Esta versión se limita estrictamente a operaciones de lectura, y se eliminan todas las capacidades de escritura y eliminación (ideal para Analista de Datos).</li>
<li><strong>Isolated Edition</strong>: Esta versión deshabilita todas las conexiones de red excepto la conexión a la instancia de MongoDB.</li>
</ul>
<div class="admonition info end inline">
<p class="admonition-title">Info</p>
<p>Compass es de uso gratuito y está disponible en origen, y puede ejecutarse en macOS, Windows y Linux.</p>
</div>
<p>Puedes ver toda la <a href="https://www.mongodb.com/docs/compass/current/">documentación</a> y los pasos de <a href="https://www.mongodb.com/docs/compass/current/install/">instalación</a> en la documentación oficial</p>
<p>Para <strong>comprobar su funcionamiento</strong>, vamos a conectarnos a nuestra Base de Datos en Atlas:</p>
<ol>
<li>Instalamos siguiendo los pasos de la documentación oficial.</li>
<li>Vamos a las opciones de conexión y elegimos la opción compass. Copiamos el string de conexión añadiendo nuestra contraseña.</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Compass_1_Datos_conexion.jpg">
    <figcaption>Figura MongoDB Compass 1. Conexión mediante Compass. (Fuente: Propia)</figcaption>
</figure>

<ol start="3">
<li>En Compass, abrimos la opción de conexión y copiamos nuestro string de conexión.</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Compass_2_String_conexion.jpg">
    <figcaption>Figura MongoDB Compass 2. String de conexión. (Fuente: Propia)</figcaption>
</figure>

<ol start="4">
<li>Ya podemos usar la GUI de Compass.</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Compass_3_Uso_Compass_1.jpg">
    <figcaption>Figura MongoDB Compass 3. GUI de Compass 1. (Fuente: Propia)</figcaption>
</figure>

<ol start="5">
<li>Visualizar las Base de Datos, Collections y Documentos. Debajo también se nos abre una conexión con <code>mongosh</code> para realizar las operaciones que queramos en terminal si lo deseamos (<em>la cual podemos minimizar</em>).</li>
</ol>
<figure style="align: center; width:600px;">
    <img src="images/MongoDB_Compass_4_Uso_Compass_2.jpg">
    <figcaption>Figura MongoDB Compass 4. GUI de Compass 2. (Fuente: Propia)</figcaption>
</figure>

<h3 id="37-mongodb-tools">3.7 MongoDB Tools<a class="headerlink" href="#37-mongodb-tools" title="Permanent link">&para;</a></h3>
<p>The <a href="https://www.mongodb.com/docs/database-tools/">MongoDB Database Tools</a> son una colección de utilidades de línea de comandos para trabajar con una implementación de MongoDB. Las herramientas de base de datos incluyen los siguientes binarios:</p>
<ol>
<li><strong>Binary Import / Export:</strong></li>
</ol>
<ul>
<li><code>mongodump</code>: Crea una exportación binaria del contenido de un demonio <em>mongod</em>.</li>
<li><code>mongorestore</code>: Restaura datos de un volcado de base de datos mongodump en un <em>mongod</em> o <em>mongos</em> (<em>Para un shared cluster, las instancias de _mongos</em> proporcionan la interfaz entre las aplicaciones cliente y el clúster fragmentado.)_</li>
<li><code>bsondump</code>: Convierte archivos <em>BSON dump</em> into <em>JSON</em>.</li>
</ul>
<ol start="2">
<li><strong>Data Import / Export:</strong></li>
</ol>
<ul>
<li><code>mongoimport</code>: Importa el contenido desde un archivo externo E_xtended JSON, CSV, or TSV._</li>
<li><code>mongoexport</code>:Produce una exportación JSON o CSV de datos almacenados en un instancia de <em>mongod</em>.</li>
</ul>
<ol start="3">
<li><strong>Diagnostic Tools:</strong></li>
</ol>
<ul>
<li><code>mongostat</code>: Proporciona una descripción general rápida del estado de una instancia de <em>mongod</em> o <em>mongos</em> actualmente en ejecución.</li>
<li><code>mongotop</code>: Proporciona una descripción general del tiempo que una instancia de <em>mongod</em> dedica a leer y escribir datos.</li>
</ul>
<ol start="4">
<li><strong>GridFS Tools:</strong></li>
</ol>
<ul>
<li><code>mongofiles</code>: admite la manipulación de archivos almacenados en su instancia de MongoDB en objetos <em>GridFS</em>.</li>
</ul>
<p>Puedes optar por descargar estas herramientas en local o utilizar algunas de las opciones mostradas anteriormente. La instancia de MongoDB creada en Docker también tiene por defecto todas estas herramientas.</p>
<h2 id="4-operaciones-crud">4. Operaciones CRUD<a class="headerlink" href="#4-operaciones-crud" title="Permanent link">&para;</a></h2>
<h3 id="41-create-operations">4.1 Create Operations<a class="headerlink" href="#41-create-operations" title="Permanent link">&para;</a></h3>
<p>Las operaciones de creación o inserción agregan nuevos documentos a una colección. Si la colección no existe actualmente, las operaciones de inserción crearán la colección.</p>
<p>MongoDB proporciona los siguientes métodos para insertar documentos en una colección:</p>
<ul>
<li>db.collection.insertOne()</li>
<li>db.collection.insertMany() </li>
</ul>
<p>En MongoDB, las operaciones de inserción tienen como objetivo una única colección. Todas las operaciones de escritura en MongoDB son <strong>atómicas</strong> al nivel de un solo documento.</p>
<figure style="align: center; width: 600px;">
    <img src="https://www.mongodb.com/docs/manual/images/crud-annotated-mongodb-insertOne.bakedsvg.svg">
    <figcaption>Figura MongoDB Create Operations. (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="insertar-un-documento">Insertar un documento<a class="headerlink" href="#insertar-un-documento" title="Permanent link">&para;</a></h4>
<p><code>db.collection.insertOne()</code> inserta un único documento dentro de una collection.</p>
<div class="admonition note insert behavior">
<p class="admonition-title">Note</p>
<p>El siguiente código inserta un nuevo documento en la colección de inventario. Si el documento no especifica un campo _id, MongoDB agrega el campo _id con un valor ObjectId al nuevo documento.</p>
</div>
<div class="language-json highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.i</span><span class="kc">nsert</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;canvas&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="kc">ta</span><span class="err">gs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;cotton&quot;</span><span class="p">],</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">35.5</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos="3 "></span></a><span class="err">)</span>
</span></code></pre></div>
<p><code>insertOne()</code> devuelve un documento que incluye el valor del campo _id del documento recién insertado. </p>
<h4 id="insertar-varios-documentos">Insertar varios documentos<a class="headerlink" href="#insertar-varios-documentos" title="Permanent link">&para;</a></h4>
<p><code>db.collection.insertMany()</code> puede insertar múltiples documentos a una collection. Pasa un array of documentos al método.</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.i</span><span class="kc">nsert</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="p">[</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><a href="#__codelineno-19-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="kc">ta</span><span class="err">gs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;blank&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">],</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><a href="#__codelineno-19-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mat&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="kc">ta</span><span class="err">gs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;gray&quot;</span><span class="p">],</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">27.9</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">35.5</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a><a href="#__codelineno-19-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mousepad&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="kc">ta</span><span class="err">gs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;gel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;blue&quot;</span><span class="p">],</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a><a href="#__codelineno-19-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">]</span><span class="err">)</span>
</span></code></pre></div>
<h3 id="42-read-operations">4.2 Read Operations<a class="headerlink" href="#42-read-operations" title="Permanent link">&para;</a></h3>
<p>En primer lugar, antes de aprender como se realizan consultas en MongoDB, vamos a ver cuales son los operadores que facilita MongoDB para poder realizar todo tipo de consultas. </p>
<p>Seguidamente veremos como realizar consultas.</p>
<h4 id="421-query-operators">4.2.1 Query Operators<a class="headerlink" href="#421-query-operators" title="Permanent link">&para;</a></h4>
<p>Mostraremos un resumen de todos los operadores (salvo <em>aggregation operators</em> que veremos más adelante cuando expliquemos agregaciones). Para más detalle, explicación y ejemplo de cada operador, la puedes encontrar en la <a href="https://www.mongodb.com/docs/manual/reference/operator/query/">documentación oficial</a></p>
<h4 id="query-selectors">Query Selectors<a class="headerlink" href="#query-selectors" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Comparison</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_1_Comparison.jpg">
    <figcaption>Figura MongoDB Operators 1. Comparison Operators (Fuente: MongoDB)</figcaption>
</figure>

<ol start="2">
<li><strong>Logical</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_2_Logical.jpg">
    <figcaption>Figura MongoDB Operators 2. Logical Operators _(Fuente: MongoDB)_</figcaption>
</figure>

<ol start="3">
<li><strong>Element</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_3_Element.jpg">
    <figcaption>Figura MongoDB Operators 3. Element Operators (Fuente: MongoDB)</figcaption>
</figure>

<ol start="4">
<li><strong>Evaluation</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_4_Evaluation.jpg">
    <figcaption>Figura MongoDB Operators 4. Evaluation Operators (Fuente: MongoDB)</figcaption>
</figure>

<ol start="5">
<li><strong>Geospatial</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_5_Geospatial.jpg">
    <figcaption>Figura MongoDB Operators 5. Geospatial Operators (Fuente: MongoDB)</figcaption>
</figure>

<ol start="6">
<li><strong>Array</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_6_Array.jpg">
    <figcaption>Figura MongoDB Operators 6. Array Operators (Fuente: MongoDB)</figcaption>
</figure>

<ol start="7">
<li><strong>Bitwise</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_7_Bitwise.jpg">
    <figcaption>Figura MongoDB Operators 7. Bitwise Operators (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="projection-operators">Projection Operators<a class="headerlink" href="#projection-operators" title="Permanent link">&para;</a></h4>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_8_Projection.jpg">
    <figcaption>Figura MongoDB Operators 8. Projection Operators (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="miscellaneous-operators">Miscellaneous Operators<a class="headerlink" href="#miscellaneous-operators" title="Permanent link">&para;</a></h4>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_Operators_9_Miscellaneous.jpg">
    <figcaption>Figura MongoDB Operators 9. Miscellaneous Operators (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="422-consultas-mondodb">4.2.2 Consultas MondoDB<a class="headerlink" href="#422-consultas-mondodb" title="Permanent link">&para;</a></h4>
<p>Para usar como ejemplo añadimos los siguientes documentos. Primero nos aseguramos de tener la collection vacía.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a>db.inventory.deleteMany({})
</span></code></pre></div>
<div class="language-json highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.i</span><span class="kc">nsert</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="p">[</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><a href="#__codelineno-21-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a><a href="#__codelineno-21-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a><a href="#__codelineno-21-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a><a href="#__codelineno-21-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;planner&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6"></a><a href="#__codelineno-21-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postcard&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">15.25</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7"></a><a href="#__codelineno-21-7"><span class="linenos" data-linenos="7 "></span></a><span class="p">]</span><span class="err">);</span>
</span></code></pre></div>
<h4 id="seleccionar-todos-los-documentos-de-un-collection">Seleccionar todos los documentos de un Collection<a class="headerlink" href="#seleccionar-todos-los-documentos-de-un-collection" title="Permanent link">&para;</a></h4>
<p>Para seleccionar todos los documentos de la colección, pasamos un documento vacío como parámetro de filtro de consulta al método de búsqueda. Esta operación utiliza un predicado de filtro de {}:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Mongosh</label><label for="__tabbed_4_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-json highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span>
</span></code></pre></div>
</div>
</div>
</div>
<p><strong><em>Para poder realizar cualquier tipo de consulta/búsqueda usaremos dentro de las {} los filtros/operadores (vistos en el punto anterior) para realizar todo tipo de consultas</em></strong>.</p>
<h4 id="especificando-una-condicion-de-igualdad">Especificando una condición de igualdad<a class="headerlink" href="#especificando-una-condicion-de-igualdad" title="Permanent link">&para;</a></h4>
<p>Para especificar condiciones de igualdad, utiliza la expresión <code>&lt;field&gt;:&lt;value&gt;</code> como filtro de la consulta del documento:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p>El siguiente ejemplo selecciona de la colección de inventario todos los documentos cuyo estado es "D":</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Mongosh</label><label for="__tabbed_5_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-json highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;D&quot;</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="especificando-condiciones-mediante-operadores-de-consulta">Especificando condiciones mediante operadores de consulta<a class="headerlink" href="#especificando-condiciones-mediante-operadores-de-consulta" title="Permanent link">&para;</a></h4>
<p>Un filtro de consulta de un documento  puede utilizar los operadores de consulta para especificar condiciones de la siguiente forma:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;opera</span><span class="kc">t</span><span class="err">or</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">1</span><span class="err">&gt;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p>El siguiente ejemplo recupera todos los documentos de la colección donde el estado es "A" o "D":</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Mongosh</label><label for="__tabbed_6_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="language-json highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$i</span><span class="kc">n</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<em>Podría usarse también el operador <code>$or</code></em></p>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;D&quot;</span><span class="p">)</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="usando-condicion-and">Usando condición <code>AND</code><a class="headerlink" href="#usando-condicion-and" title="Permanent link">&para;</a></h4>
<p>Una consulta compuesta puede especificar condiciones para más de un campo en los documentos de la colección. Implícitamente, una conjunción lógica <code>AND</code> conecta las cláusulas de una consulta compuesta de modo que la consulta selecciona los documentos de la colección que coinciden con todas las condiciones.</p>
<p>El siguiente ejemplo recupera todos los documentos de la colección donde el estado es igual a "A" y la cantidad es menor que <code>$lt</code> 30:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Mongosh</label><label for="__tabbed_7_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-json highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;A&quot;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="usando-condicion-or">Usando condición <code>OR</code><a class="headerlink" href="#usando-condicion-or" title="Permanent link">&para;</a></h4>
<p>Con el operador <code>$or</code>, puedes especificar una consulta compuesta que una cada cláusula con una conjunción OR lógica para que la consulta seleccione los documentos de la colección que coincidan con al menos una condición.</p>
<p>El siguiente ejemplo recupera todos los documentos de la colección donde el estado es igual a "A" o la cantidad es menor que <code>$lt</code> 30:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Mongosh</label><label for="__tabbed_8_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-json highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$or</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;A&quot;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="especificando-condiciones-and-y-or">Especificando condiciones <code>AND</code> y <code>OR</code><a class="headerlink" href="#especificando-condiciones-and-y-or" title="Permanent link">&para;</a></h4>
<p>En el siguiente ejemplo, el documento de consulta compuesta selecciona todos los documentos de la colección donde el estado es igual a "A" y la cantidad es menor que <code>$lt</code> 30 o el elemento comienza con el carácter p:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Mongosh</label><label for="__tabbed_9_2">Equivalente en SQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-json highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a><a href="#__codelineno-34-2"><span class="linenos" data-linenos="2 "></span></a><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a><a href="#__codelineno-34-3"><span class="linenos" data-linenos="3 "></span></a><span class="w"> </span><span class="err">$or</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="err">/^p/</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">]</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a><a href="#__codelineno-34-4"><span class="linenos" data-linenos="4 "></span></a><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<p>Podría usarse otro operador de filtro:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a><a href="#__codelineno-35-2"><span class="linenos" data-linenos="2 "></span></a><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><a href="#__codelineno-35-3"><span class="linenos" data-linenos="3 "></span></a><span class="w"> </span><span class="err">$or</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$regex</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;^p&#39;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">]</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a><a href="#__codelineno-35-4"><span class="linenos" data-linenos="4 "></span></a><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-sql highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">inventory</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;A&quot;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;p%&quot;</span><span class="p">)</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>Con esta introducción podemos tener una buena introducción a las <em>query operations</em> de MongoDB. Pero existen otros muchos tipos:</p>
<ul>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/query-embedded-documents/">Query on Embedded/Nested Documents</a></li>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/query-arrays/">Query an Array</a></li>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/query-array-of-documents/">Query an Array of Embedded Documents</a></li>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/project-fields-from-query-results/">Project Fields to Return from Query</a></li>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/query-for-null-fields/">Query for Null or Missing Fields</a></li>
</ul>
<p>Puedes consultarlas en la <a href="https://www.mongodb.com/docs/manual/tutorial/query-documents/">documentación oficial</a></p>
<h3 id="43-update-operations">4.3 Update Operations<a class="headerlink" href="#43-update-operations" title="Permanent link">&para;</a></h3>
<p>Como en el caso de las consultas, vamos a ver primero los operadores de actualización y seguidamente como realizamos actualizaciones en MongoDB</p>
<h4 id="431-update-operators">4.3.1 Update Operators<a class="headerlink" href="#431-update-operators" title="Permanent link">&para;</a></h4>
<p>Los siguientes modificadores están disponibles para su uso en operaciones de actualización.</p>
<h4 id="sintaxis">Sintaxis<a class="headerlink" href="#sintaxis" title="Permanent link">&para;</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a><a href="#__codelineno-37-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="err">&lt;opera</span><span class="kc">t</span><span class="err">or</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a><a href="#__codelineno-37-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="err">&lt;opera</span><span class="kc">t</span><span class="err">or</span><span class="mi">2</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">2</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">2</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a><a href="#__codelineno-37-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="err">...</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a><a href="#__codelineno-37-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">}</span>
</span></code></pre></div>
<p>Para más detalle, explicación y ejemplo de cada operador, la puedes encontrar en la <a href="https://www.mongodb.com/docs/manual/reference/operator/update/">documentación oficial. Update Operator</a></p>
<ol>
<li><strong>Field update operators</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_UpdateOperators_1_Field.jpg">
    <figcaption>Figura MongoDB Update Operators 1. Field (Fuente: MongoDB)</figcaption>
</figure>

<ol start="2">
<li><strong>Array update operators</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_UpdateOperators_2_Array.jpg">
    <figcaption>Figura MongoDB Update Operators 2. Array (Fuente: MongoDB)</figcaption>
</figure>

<ol start="3">
<li><strong>Modifiers update operators</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_UpdateOperators_3_Modifiers.jpg">
    <figcaption>Figura MongoDB Update Operators 3. Modifiers (Fuente: MongoDB)</figcaption>
</figure>

<ol start="4">
<li><strong>Bitwise update operators</strong></li>
</ol>
<figure style="align: center; width: 800px;">
    <img src="images/MongoDB_UpdateOperators_4_Bitwise.jpg">
    <figcaption>Figura MongoDB Update Operators 4. Bitwise (Fuente: MongoDB)</figcaption>
</figure>

<h4 id="432-actualizaciones">4.3.2 Actualizaciones<a class="headerlink" href="#432-actualizaciones" title="Permanent link">&para;</a></h4>
<p>Para usar como ejemplo añadimos los siguientes documentos. Primero nos aseguramos de tener la collection vacía.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos="1 "></span></a>db.inventory.deleteMany({})
</span></code></pre></div>
<div class="language-json highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a><a href="#__codelineno-39-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.i</span><span class="kc">nsert</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a><a href="#__codelineno-39-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;canvas&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">35.5</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a><a href="#__codelineno-39-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a><a href="#__codelineno-39-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mat&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">27.9</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">35.5</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a><a href="#__codelineno-39-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mousepad&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a><a href="#__codelineno-39-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a><a href="#__codelineno-39-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8"></a><a href="#__codelineno-39-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;planner&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9"></a><a href="#__codelineno-39-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postcard&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">15.25</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10"></a><a href="#__codelineno-39-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sketchbook&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11"></a><a href="#__codelineno-39-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sketch pad&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">95</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">30.5</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12"></a><a href="#__codelineno-39-12"><span class="linenos" data-linenos="12 "></span></a><span class="p">]</span><span class="w"> </span><span class="err">);</span>
</span></code></pre></div>
<p>MongoDB proporciona los siguientes métodos para actualizar documentos en una colección:</p>
<ul>
<li>db.collection.updateOne(<filter>, <update>, <options>)</li>
<li>db.collection.updateMany(<filter>, <update>, <options>)</li>
<li>db.collection.replaceOne(<filter>, <update>, <options>)</li>
</ul>
<p>Para la actualización de documentos de una colletion usamos la siguiente sintaxis</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><a href="#__codelineno-40-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a><a href="#__codelineno-40-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">  </span><span class="err">&lt;upda</span><span class="kc">te</span><span class="w"> </span><span class="err">opera</span><span class="kc">t</span><span class="err">or&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a><a href="#__codelineno-40-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">  </span><span class="err">&lt;upda</span><span class="kc">te</span><span class="w"> </span><span class="err">opera</span><span class="kc">t</span><span class="err">or&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">f</span><span class="err">ield</span><span class="mi">2</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;value</span><span class="mi">2</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a><a href="#__codelineno-40-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">  </span><span class="err">...</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5"></a><a href="#__codelineno-40-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="update-a-single-document">Update a Single Document<a class="headerlink" href="#update-a-single-document" title="Permanent link">&para;</a></h4>
<p>El siguiente ejemplo utiliza el método <code>db.collection.updateOne()</code> en la colección de inventario para actualizar <strong>el primer documento</strong> donde elemento es igual a "paper":</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a><a href="#__codelineno-41-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.upda</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a><a href="#__codelineno-41-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3"></a><a href="#__codelineno-41-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4"></a><a href="#__codelineno-41-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">     </span><span class="err">$se</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;size.uom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5"></a><a href="#__codelineno-41-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">     </span><span class="err">$curre</span><span class="kc">nt</span><span class="err">Da</span><span class="kc">te</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">las</span><span class="kc">t</span><span class="err">Modi</span><span class="kc">f</span><span class="err">ied</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6"></a><a href="#__codelineno-41-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7"></a><a href="#__codelineno-41-7"><span class="linenos" data-linenos="7 "></span></a><span class="err">)</span>
</span></code></pre></div>
<p>La operación de actualización:</p>
<ul>
<li>utiliza el operador <code>$set</code> para actualizar el valor del campo s<code>ize.uom</code> a "cm" y el valor del campo de estado a "P",</li>
<li>utiliza el operador <code>$currentDate</code> para actualizar el valor del campo <em>lastModified</em> a la fecha actual. Si el campo <em>lastModified</em> no existe, <code>$currentDate</code> creará el campo.</li>
</ul>
<h4 id="update-multiple-documents">Update Multiple Documents<a class="headerlink" href="#update-multiple-documents" title="Permanent link">&para;</a></h4>
<p>El siguiente ejemplo utiliza el método <code>db.collection.updateMany()</code> en la colección de <em>inventory</em> para actualizar <strong>todos los documentos</strong> donde la cantidad es inferior a 50:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a><a href="#__codelineno-42-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.upda</span><span class="kc">te</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a><a href="#__codelineno-42-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;qty&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a><a href="#__codelineno-42-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a><a href="#__codelineno-42-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">     </span><span class="err">$se</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;size.uom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a><a href="#__codelineno-42-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">     </span><span class="err">$curre</span><span class="kc">nt</span><span class="err">Da</span><span class="kc">te</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">las</span><span class="kc">t</span><span class="err">Modi</span><span class="kc">f</span><span class="err">ied</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a><a href="#__codelineno-42-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a><a href="#__codelineno-42-7"><span class="linenos" data-linenos="7 "></span></a><span class="err">)</span>
</span></code></pre></div>
<p>La operación de actualización:</p>
<ul>
<li>utiliza el operador <code>$set</code> para actualizar el valor del campo <code>size.uom</code> a "in" y el valor del campo de estado a "P",</li>
<li>utiliza el operador <code>$currentDate</code> para actualizar el valor del campo <em>lastModified</em> a la fecha actual. Si el campo <em>lastModified</em> no existe, <code>$currentDate</code> creará el campo.</li>
</ul>
<h4 id="replace-a-document">Replace a Document<a class="headerlink" href="#replace-a-document" title="Permanent link">&para;</a></h4>
<p>Para reemplazar todo el contenido de un documento excepto el campo <code>_id</code>, pase un documento completamente nuevo como segundo argumento a <code>db.collection.replaceOne()</code>.</p>
<div class="admonition note">
<p>Al reemplazar un documento, el documento de reemplazo debe consistir únicamente en pares de campo/valor; es decir, no incluir actualizar operadores expresiones.</p>
<p>El documento de reemplazo puede tener campos diferentes a los del documento original. En el documento de reemplazo, puede omitir el campo <code>_id</code> ya que el campo <code>_id</code> <strong>es inmutable</strong>; sin embargo, si incluye el campo <code>_id</code>, debe tener el mismo valor que el valor actual.</p>
</div>
<p>El siguiente ejemplo reemplaza el primer documento de la colección de inventario donde elemento: "papel":</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a><a href="#__codelineno-43-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.replaceO</span><span class="kc">ne</span><span class="err">(</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a><a href="#__codelineno-43-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3"></a><a href="#__codelineno-43-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">i</span><span class="kc">nst</span><span class="err">ock</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">warehouse</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">warehouse</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4"></a><a href="#__codelineno-43-4"><span class="linenos" data-linenos="4 "></span></a><span class="err">)</span>
</span></code></pre></div>
<h4 id="otros-ejemplos">Otros ejemplos<a class="headerlink" href="#otros-ejemplos" title="Permanent link">&para;</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a><a href="#__codelineno-44-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.ships.upda</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">$eq</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="mf">-E</span><span class="kc">nter</span><span class="err">prise</span><span class="mi">-</span><span class="err">D&#39;</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="err">$se</span><span class="kc">t</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="w"> </span><span class="err">Some</span><span class="kc">t</span><span class="err">hi</span><span class="kc">n</span><span class="err">g&#39;</span><span class="p">}}</span><span class="err">)</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2"></a><a href="#__codelineno-44-2"><span class="linenos" data-linenos="2 "></span></a><span class="err">db.ships.upda</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">$eq</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="w"> </span><span class="err">Some</span><span class="kc">t</span><span class="err">hi</span><span class="kc">n</span><span class="err">g&#39;</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="err">$se</span><span class="kc">t</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="w"> </span><span class="err">Prome</span><span class="kc">t</span><span class="err">heus&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">class</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Prome</span><span class="kc">t</span><span class="err">heus&#39;</span><span class="p">}}</span><span class="err">)</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3"></a><a href="#__codelineno-44-3"><span class="linenos" data-linenos="3 "></span></a><span class="err">db.ships.upda</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">$eq</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;USS</span><span class="w"> </span><span class="err">Prome</span><span class="kc">t</span><span class="err">heus&#39;</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="err">$u</span><span class="kc">nset</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">opera</span><span class="kc">t</span><span class="err">or</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}}</span><span class="err">)</span>
</span></code></pre></div>
<h4 id="433-metodos-adicionales">4.3.3 Métodos adicionales<a class="headerlink" href="#433-metodos-adicionales" title="Permanent link">&para;</a></h4>
<p>MongoDB tiene otros métodos menos usados para la actualización de documentos en las colecciones:</p>
<ul>
<li>db.collection.findOneAndReplace()</li>
<li>db.collection.findOneAndUpdate()</li>
<li>db.collection.findAndModify()</li>
<li>db.collection.bulkWrite()</li>
</ul>
<p>Puedes obtener más información en la <a href="https://www.mongodb.com/docs/manual/reference/update-methods/">documentación oficial. Update methods</a></p>
<h3 id="44-delete-operations">4.4 Delete Operations<a class="headerlink" href="#44-delete-operations" title="Permanent link">&para;</a></h3>
<p>Para usar como ejemplo añadimos los siguientes documentos. Primero nos aseguramos de tener la collection vacía.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a><a href="#__codelineno-45-1"><span class="linenos" data-linenos="1 "></span></a>db.inventory.deleteMany({})
</span></code></pre></div>
<div class="language-json highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a><a href="#__codelineno-46-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.i</span><span class="kc">nsert</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a><a href="#__codelineno-46-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a><a href="#__codelineno-46-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a><a href="#__codelineno-46-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;paper&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">8.5</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a><a href="#__codelineno-46-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;planner&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mf">22.85</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6"></a><a href="#__codelineno-46-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postcard&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">q</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">w</span><span class="p">:</span><span class="w"> </span><span class="mf">15.25</span><span class="p">,</span><span class="w"> </span><span class="err">uom</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cm&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7"></a><a href="#__codelineno-46-7"><span class="linenos" data-linenos="7 "></span></a><span class="p">]</span><span class="w"> </span><span class="err">);</span>
</span></code></pre></div>
<p>MongoDB proporciona los siguientes métodos para borrar documentos en una colección:</p>
<ul>
<li>db.collection.deleteMany()</li>
<li>db.collection.deleteOne()</li>
</ul>
<h4 id="delete-all-documents">Delete All Documents<a class="headerlink" href="#delete-all-documents" title="Permanent link">&para;</a></h4>
<p>Para eliminar todos los documentos de una colección, pasamos un documento de filtro vacío {} al método <code>db.collection.deleteMany()</code>.</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a><a href="#__codelineno-47-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">ntar</span><span class="err">io.dele</span><span class="kc">te</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="p">{}</span><span class="err">)</span>
</span></code></pre></div>
<p>El método devuelve un documento con el estado de la operación.</p>
<h4 id="delete-all-documents-that-match-a-condition">Delete All Documents that Match a Condition<a class="headerlink" href="#delete-all-documents-that-match-a-condition" title="Permanent link">&para;</a></h4>
<p>Podemos especificar criterios o filtros que identifiquen los documentos que se eliminarán. Los filtros utilizan la misma sintaxis que las <strong><a href="#421-query-operators">operaciones de lectura</a></strong>.</p>
<p>Para especificar condiciones de igualdad, utilizamos expresiones <code>&lt;campo&gt;:&lt;valor&gt;</code> en el documento de filtro de consulta:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a><a href="#__codelineno-48-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span><span class="w"> </span><span class="err">&lt;campo</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;valor</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">,</span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p>Una consulta de documento con filtro podemos utilizar los operadores de consulta para especificar condiciones de la siguiente forma:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1"></a><a href="#__codelineno-49-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span><span class="w"> </span><span class="err">&lt;campo</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">&lt;operador</span><span class="mi">1</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;valor</span><span class="mi">1</span><span class="err">&gt;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p>Entonces, para eliminar todos los documentos que coincidan con un criterio de eliminación, pasamos un filtro por parámetro al método <code>deleteMany()</code>.</p>
<p>Lo vemos en el siguiente ejemplo, donde eliminamos todos los documentos de la colección de inventario donde el campo de estado es "A":</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1"></a><a href="#__codelineno-50-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.dele</span><span class="kc">te</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="p">{</span><span class="w"> </span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="p">}</span><span class="err">)</span>
</span></code></pre></div>
<p>El método devuelve un documento con el estado de la operación.</p>
<h4 id="delete-only-one-document-that-matches-a-condition">Delete Only One Document that Matches a Condition<a class="headerlink" href="#delete-only-one-document-that-matches-a-condition" title="Permanent link">&para;</a></h4>
<p>Para eliminar como máximo un único documento que coincida con un filtro específico (aunque varios documentos puedan coincidir con el filtro especificado), utilizamos el método <code>db.collection.deleteOne()</code>.</p>
<p>En el siguiente ejemplo elimina el primer documento cuyo estado es "D":</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a><a href="#__codelineno-51-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.i</span><span class="kc">n</span><span class="err">ve</span><span class="kc">nt</span><span class="err">ory.dele</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span><span class="w"> </span><span class="p">{</span><span class="err">s</span><span class="kc">tatus</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<h4 id="otros-ejemplos_1">Otros Ejemplos<a class="headerlink" href="#otros-ejemplos_1" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1"></a><a href="#__codelineno-52-1"><span class="linenos" data-linenos="1 "></span></a>db.ships.deleteOne({name : &#39;USS Prometheus&#39;})
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2"></a><a href="#__codelineno-52-2"><span class="linenos" data-linenos="2 "></span></a>db.ships.deleteOne({name:{$regex:&#39;^A*&#39;}})
</span></code></pre></div>
<h2 id="5-aggregations">5. Aggregations<a class="headerlink" href="#5-aggregations" title="Permanent link">&para;</a></h2>
<p>Las operaciones de agregación procesan múltiples documentos y devuelven resultados calculados. Puede utilizar operaciones de agregación para:</p>
<ul>
<li>Agrupar valores desde varios documentos a la vez.</li>
<li>Realice operaciones sobre los <strong>datos agrupados</strong> para devolver un único resultado.</li>
<li>Analizar los cambios de datos a lo largo del tiempo.</li>
</ul>
<p>Para realizar operaciones de agregación, puede utilizar:</p>
<ul>
<li><strong>Aggregation pipelines</strong>, que son el método preferido para realizar agregaciones.</li>
<li><strong>Single purpose aggregation methods</strong>, que son simples pero carecen de las capacidades de una Aggregation pipelines.</li>
</ul>
<p>Un proceso de agregación consta de <strong>una o más etapas</strong> que procesan documentos:</p>
<ul>
<li>Cada etapa realiza una operación en los documentos de entrada. Por ejemplo, una etapa puede filtrar documentos, agrupar documentos y calcular valores.</li>
<li>Los documentos que salen de una etapa pasan a la siguiente etapa.</li>
<li>Una Aggregation Pipelines puede devolver resultados por grupos de documentos. Por ejemplo, devuelva los valores total, promedio, máximo y mínimo.</li>
</ul>
<p>Para poder realizar estas agrupaciones de datos por etapas MongoDB proporciona una larga lista de Operadores</p>
<h3 id="51-operator-aggregation-pipelines-stages">5.1 Operator Aggregation Pipelines Stages<a class="headerlink" href="#51-operator-aggregation-pipelines-stages" title="Permanent link">&para;</a></h3>
<p>Hay una larga lista de operadores que te permiten establecer cada una de las etapas de los Aggregation Pipelines. En la documentación oficial tienes la <a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation-pipeline/">lista completa</a>.</p>
<p>A continuación extraemos los más utilizados a modo de resumen:</p>
<p><center></p>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Estado</strong></th>
<th style="text-align: left;"><strong>Descripción</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>$project</strong></td>
<td style="text-align: left;">Cambia la forma de cada documento en la secuencia, por ejemplo agregando nuevos campos o eliminando campos existentes. Por cada documento de entrada, genera un documento.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$match</strong></td>
<td style="text-align: left;">Filtra el <em>stream</em> de documentos para permitir que solo los documentos coincidentes pasen sin modificaciones a la siguiente etapa del proceso. <code>$match</code> utiliza consultas estándar de MongoDB. Para cada documento de entrada, genera un documento (una coincidencia) o cero documentos (ninguna coincidencia).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$group</strong></td>
<td style="text-align: left;">Agrupa los documentos de entrada por una expresión de identificador especificada y aplica las expresiones del acumulador, si se especifican, a cada grupo. Consume todos los documentos de entrada y genera un documento por cada grupo distinto. Los documentos de salida solo contienen el campo identificador y, si se especifica, campos acumulados.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$sort</strong></td>
<td style="text-align: left;">Reordena el flujo de documentos según una clave de clasificación especificada. Sólo cambia el orden; los documentos permanecen sin modificaciones. Por cada documento de entrada, genera un documento.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$skip</strong></td>
<td style="text-align: left;">Omite los primeros n documentos donde n es el número de omisión especificado y pasa los documentos restantes sin modificar a la canalización. Para cada documento de entrada, genera cero documentos (para los primeros n documentos) o un documento (si está después de los primeros n documentos).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$limit</strong></td>
<td style="text-align: left;">Pasa los primeros n documentos sin modificar al <em>pipeline</em>, donde n es el límite especificado. Para cada documento de entrada, genera un documento (para los primeros n documentos) o cero documentos (después de los primeros n documentos).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>$unwind</strong></td>
<td style="text-align: left;">Deconstruye un campo de matriz a partir de los documentos de entrada para generar un documento para cada elemento. Cada documento de salida reemplaza la matriz con un valor de elemento. Para cada documento de entrada, genera n documentos donde n es el número de elementos de la matriz y puede ser cero para una matriz vacía.</td>
</tr>
</tbody>
</table>
<p><em>Tabla 1: Operadores de aggregations más usados en MongoDB</em>
</center></p>
<h3 id="52-aggregation-pipelines">5.2 Aggregation Pipelines<a class="headerlink" href="#52-aggregation-pipelines" title="Permanent link">&para;</a></h3>
<p>Una vez vista la información sobre Agreggation vamos a aprender a usarlo usando pequeños ejemplos. Para ello vamos a tomar como base la siguiente colección <code>orders</code> de pedidos de pizzas. Recuerda asegurarte de tener la collection vacía.</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1"></a><a href="#__codelineno-53-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.orders.dele</span><span class="kc">te</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="p">{}</span><span class="err">)</span>
</span></code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Aggregation Pipelines que se ejecutan con el método <code>db.collection.aggregate()</code> no modifican los documentos de una colección, a menos que la canalización contenga una etapa <code>$merge</code> o <code>$out</code>.</p>
</div>
<div class="language-json highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a><a href="#__codelineno-54-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="err">db.orders.i</span><span class="kc">nsert</span><span class="err">Ma</span><span class="kc">n</span><span class="err">y(</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2"></a><a href="#__codelineno-54-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pepperoni&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3"></a><a href="#__codelineno-54-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-03-13T08:14:30Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4"></a><a href="#__codelineno-54-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pepperoni&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5"></a><a href="#__codelineno-54-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-03-13T09:13:24Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6"></a><a href="#__codelineno-54-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pepperoni&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;large&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7"></a><a href="#__codelineno-54-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-03-17T09:22:12Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8"></a><a href="#__codelineno-54-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cheese&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9"></a><a href="#__codelineno-54-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-03-13T11:21:39.736Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10"></a><a href="#__codelineno-54-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cheese&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11"></a><a href="#__codelineno-54-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2022-01-12T21:23:13.331Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12"></a><a href="#__codelineno-54-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cheese&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;large&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13"></a><a href="#__codelineno-54-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2022-01-12T05:08:13Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14"></a><a href="#__codelineno-54-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vegan&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15"></a><a href="#__codelineno-54-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-01-13T05:08:13Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16"></a><a href="#__codelineno-54-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vegan&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">price</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17"></a><a href="#__codelineno-54-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">     </span><span class="err">qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2021-01-13T05:10:13Z&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18"></a><a href="#__codelineno-54-18"><span class="linenos" data-linenos="18 "></span></a><span class="p">]</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<h4 id="calcular-la-cantidad-total-del-pedido">Calcular la cantidad total del pedido<a class="headerlink" href="#calcular-la-cantidad-total-del-pedido" title="Permanent link">&para;</a></h4>
<p>Este ejemplo contiene dos etapas y devuelve la cantidad total del pedido de pizzas de tamaño <em>"medium"</em> agrupadas por nombre de pizza:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1"></a><a href="#__codelineno-55-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="err">db.orders.aggrega</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2"></a><a href="#__codelineno-55-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3"></a><a href="#__codelineno-55-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">   </span><span class="c1">// Etapa 1: Filtramos los documentos por el tamaño de la pizza</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4"></a><a href="#__codelineno-55-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5"></a><a href="#__codelineno-55-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">      </span><span class="err">$ma</span><span class="kc">t</span><span class="err">ch</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">size</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6"></a><a href="#__codelineno-55-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">   </span><span class="p">},</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7"></a><a href="#__codelineno-55-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8"></a><a href="#__codelineno-55-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">   </span><span class="c1">// Etapa 2: Agrupe los documentos restantes por nombre de pizza y calcule la cantidad total</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9"></a><a href="#__codelineno-55-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10"></a><a href="#__codelineno-55-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">      </span><span class="err">$group</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$name&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">Qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$sum</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$quantity&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11"></a><a href="#__codelineno-55-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12"></a><a href="#__codelineno-55-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13"></a><a href="#__codelineno-55-13"><span class="linenos" data-linenos="13 "></span></a><span class="p">]</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<p>La etapa de <code>$match</code>:</p>
<ul>
<li>Filtra los documentos de pedido de pizza a pizzas de tamaño mediano.</li>
<li>Pasa los documentos restantes a la etapa de <code>$group</code>.</li>
</ul>
<p>La fase de <code>$group</code>:</p>
<ul>
<li>Agrupa los documentos restantes por nombre de pizza.</li>
<li>Utiliza <code>$sum</code> para calcular la cantidad total del pedido para cada <code>$name</code> de pizza. El total se almacena en el campo <code>totalQuantity</code> devuelto por la aggregation pipeline.</li>
</ul>
<p>La salida del ejemplo sería:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1"></a><a href="#__codelineno-56-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">[</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2"></a><a href="#__codelineno-56-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Cheese&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">Qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3"></a><a href="#__codelineno-56-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Vega</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">Qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4"></a><a href="#__codelineno-56-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Peppero</span><span class="kc">n</span><span class="err">i&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">Qua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5"></a><a href="#__codelineno-56-5"><span class="linenos" data-linenos="5 "></span></a><span class="p">]</span>
</span></code></pre></div>
<h4 id="calcular-el-valor-total-del-pedido-y-la-cantidad-promedio-del-pedido">Calcular el valor total del pedido y la cantidad promedio del pedido<a class="headerlink" href="#calcular-el-valor-total-del-pedido-y-la-cantidad-promedio-del-pedido" title="Permanent link">&para;</a></h4>
<p>El siguiente ejemplo calcula el valor total del pedido de pizza y la cantidad promedio del pedido entre dos fechas:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a><a href="#__codelineno-57-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="err">db.orders.aggrega</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2"></a><a href="#__codelineno-57-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3"></a><a href="#__codelineno-57-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">   </span><span class="c1">// Etapa 1: Filtramos los documentos de pedidos de pizza por rango de fecha</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4"></a><a href="#__codelineno-57-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5"></a><a href="#__codelineno-57-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">      </span><span class="err">$ma</span><span class="kc">t</span><span class="err">ch</span><span class="p">:</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6"></a><a href="#__codelineno-57-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7"></a><a href="#__codelineno-57-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">         </span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$g</span><span class="kc">te</span><span class="p">:</span><span class="w"> </span><span class="kc">ne</span><span class="err">w</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2020-01-30&quot;</span><span class="w"> </span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="err">$l</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="kc">ne</span><span class="err">w</span><span class="w"> </span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="w"> </span><span class="s2">&quot;2022-01-30&quot;</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8"></a><a href="#__codelineno-57-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9"></a><a href="#__codelineno-57-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">   </span><span class="p">},</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10"></a><a href="#__codelineno-57-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11"></a><a href="#__codelineno-57-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">   </span><span class="c1">// Etapa 2: Agrupamos los documentos recibidos por $match por fecha y calculamos los resultados</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12"></a><a href="#__codelineno-57-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13"></a><a href="#__codelineno-57-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">      </span><span class="err">$group</span><span class="p">:</span>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14"></a><a href="#__codelineno-57-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-57-15"><a id="__codelineno-57-15" name="__codelineno-57-15"></a><a href="#__codelineno-57-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">         </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$da</span><span class="kc">te</span><span class="err">ToS</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;%Y-%m-%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$date&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-57-16"><a id="__codelineno-57-16" name="__codelineno-57-16"></a><a href="#__codelineno-57-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">         </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$sum</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$mul</span><span class="kc">t</span><span class="err">iply</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;$price&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$quantity&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-57-17"><a id="__codelineno-57-17" name="__codelineno-57-17"></a><a href="#__codelineno-57-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">         </span><span class="err">averageOrderQua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$avg</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$quantity&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-57-18"><a id="__codelineno-57-18" name="__codelineno-57-18"></a><a href="#__codelineno-57-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-57-19"><a id="__codelineno-57-19" name="__codelineno-57-19"></a><a href="#__codelineno-57-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">   </span><span class="p">},</span>
</span><span id="__span-57-20"><a id="__codelineno-57-20" name="__codelineno-57-20"></a><a href="#__codelineno-57-20"><span class="linenos" data-linenos="20 "></span></a>
</span><span id="__span-57-21"><a id="__codelineno-57-21" name="__codelineno-57-21"></a><a href="#__codelineno-57-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">   </span><span class="c1">// Etapa 3: Ordenamos los documentos por por totalOrderValue en orden descendente</span>
</span><span id="__span-57-22"><a id="__codelineno-57-22" name="__codelineno-57-22"></a><a href="#__codelineno-57-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">   </span><span class="p">{</span>
</span><span id="__span-57-23"><a id="__codelineno-57-23" name="__codelineno-57-23"></a><a href="#__codelineno-57-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">      </span><span class="err">$sor</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-57-24"><a id="__codelineno-57-24" name="__codelineno-57-24"></a><a href="#__codelineno-57-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="__span-57-25"><a id="__codelineno-57-25" name="__codelineno-57-25"></a><a href="#__codelineno-57-25"><span class="linenos" data-linenos="25 "></span></a>
</span><span id="__span-57-26"><a id="__codelineno-57-26" name="__codelineno-57-26"></a><a href="#__codelineno-57-26"><span class="linenos" data-linenos="26 "></span></a><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="err">)</span>
</span></code></pre></div>
<p>La etapa de <code>$match</code>:</p>
<ul>
<li>Filtra los documentos de pedido de pizza en un rango de fechas especificado usando <code>$gte</code> y <code>$lt</code>.</li>
<li>Pasa los documentos restantes a la fase de <code>$group</code>.</li>
</ul>
<p>La etapa <code>$group</code>:</p>
<ul>
<li>Agrupa los documentos por fecha usando <code>$dateToString</code>.</li>
<li>Para cada grupo, calcula:</li>
<li>Valor total del pedido usando <code>$sum</code> y <code>$multiply</code>.</li>
<li>Cantidad promedio de pedido usando <code>$avg</code>.</li>
<li>Pasa los documentos agrupados a la etapa <code>$sort</code>.</li>
</ul>
<p>La etapa de <code>$sort</code>:</p>
<ul>
<li>Ordena los documentos por el valor total del pedido para cada grupo en orden descendente (-1).</li>
<li>Devuelve los documentos ordenados.</li>
</ul>
<p>La salida del ejemplo sería:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1"></a><a href="#__codelineno-58-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">[</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2"></a><a href="#__codelineno-58-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">2022-01-12</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="mi">790</span><span class="p">,</span><span class="w"> </span><span class="err">averageOrderQua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3"></a><a href="#__codelineno-58-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">2021-03-13</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="mi">770</span><span class="p">,</span><span class="w"> </span><span class="err">averageOrderQua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4"></a><a href="#__codelineno-58-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">2021-03-17</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="mi">630</span><span class="p">,</span><span class="w"> </span><span class="err">averageOrderQua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5"></a><a href="#__codelineno-58-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">   </span><span class="p">{</span><span class="w"> </span><span class="err">_id</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">2021-01-13</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">OrderValue</span><span class="p">:</span><span class="w"> </span><span class="mi">350</span><span class="p">,</span><span class="w"> </span><span class="err">averageOrderQua</span><span class="kc">nt</span><span class="err">i</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6"></a><a href="#__codelineno-58-6"><span class="linenos" data-linenos="6 "></span></a><span class="p">]</span>
</span></code></pre></div>
<h2 id="6-ejemplo">6. Ejemplo<a class="headerlink" href="#6-ejemplo" title="Permanent link">&para;</a></h2>
<p>Usando la collection de restaurantes cargada anteriormente, vamos a resolver como ejemplo, algunas operaciones:</p>
<ol>
<li>
<p>Comprobamos la carga</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1"></a><a href="#__codelineno-59-1"><span class="linenos" data-linenos="1 "></span></a>show dbs
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2"></a><a href="#__codelineno-59-2"><span class="linenos" data-linenos="2 "></span></a>db.restaurantes.find()
</span></code></pre></div>
</li>
<li>
<p>Crear una consultar para encontrar qué restaurantes no tienen dirección (Todas tienen dirección)</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a><a href="#__codelineno-60-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="err">address</span><span class="p">:{</span><span class="err">$exis</span><span class="kc">ts</span><span class="p">:</span><span class="kc">false</span><span class="p">}}</span><span class="err">)</span>
</span></code></pre></div>
</li>
<li>
<p>Contar el número de restaurantes que si tienen dirección</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1"></a><a href="#__codelineno-61-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="err">address</span><span class="p">:{</span><span class="err">$exis</span><span class="kc">ts</span><span class="p">:</span><span class="kc">true</span><span class="p">}}</span><span class="err">).cou</span><span class="kc">nt</span><span class="err">()</span>
</span></code></pre></div>
</li>
<li>
<p>Crear una consulta para encontrar aquellos restaurantes de cocina italiana que se encuentren en la zona geográfica con código postal 10075</p>
<p><div class="language-json highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1"></a><a href="#__codelineno-62-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="err">$a</span><span class="kc">n</span><span class="err">d</span><span class="p">:[{</span><span class="nt">&quot;cuisine&quot;</span><span class="p">:</span><span class="s2">&quot;Italian&quot;</span><span class="p">},{</span><span class="nt">&quot;address.zipcode&quot;</span><span class="p">:</span><span class="s2">&quot;10075&quot;</span><span class="p">}]}</span><span class="err">)</span>
</span></code></pre></div>
5. Encontrar aquellos restaurantes que tengan grado A, puntuación 11 y fecha 2014-10-01T00:00:00Z</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a><a href="#__codelineno-63-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="err">grades</span><span class="p">:{</span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="s2">&quot;2014-10-01T00:00:00Z&quot;</span><span class="err">)</span><span class="p">,</span><span class="nt">&quot;grade&quot;</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="mi">11</span><span class="p">}}</span><span class="err">)</span>
</span></code></pre></div>
</li>
<li>
<p>Contabiliza cuántos restaurantes tienen una puntuación menor o igual a 5</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1"></a><a href="#__codelineno-64-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="nt">&quot;grades.score&quot;</span><span class="p">:{</span><span class="err">$l</span><span class="kc">te</span><span class="p">:</span><span class="mi">5</span><span class="p">}}</span><span class="err">).cou</span><span class="kc">nt</span><span class="err">()</span>
</span></code></pre></div>
</li>
<li>
<p>Obtener los nombres del segundo y el tercer restaurante de cocina italiana ordenados por nombre</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1"></a><a href="#__codelineno-65-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="nt">&quot;cuisine&quot;</span><span class="p">:</span><span class="s2">&quot;Italian&quot;</span><span class="p">}</span><span class="err">).sor</span><span class="kc">t</span><span class="err">(</span><span class="p">{</span><span class="kc">na</span><span class="err">me</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span><span class="err">).limi</span><span class="kc">t</span><span class="err">(</span><span class="mi">2</span><span class="err">).skip(</span><span class="mi">1</span><span class="err">)</span>
</span></code></pre></div>
</li>
<li>
<p>Añadir una valoración al restaurante 41156888</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a><a href="#__codelineno-66-1"><span class="linenos" data-linenos="1 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="nt">&quot;restaurant_id&quot;</span><span class="p">:</span><span class="s2">&quot;41156888&quot;</span><span class="p">}</span><span class="err">)</span><span class="w"> </span><span class="c1">// Listamos primero para ver las que tiene actualmente</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2"></a><a href="#__codelineno-66-2"><span class="linenos" data-linenos="2 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.upda</span><span class="kc">te</span><span class="err">O</span><span class="kc">ne</span><span class="err">(</span><span class="p">{</span><span class="nt">&quot;restaurant_id&quot;</span><span class="p">:</span><span class="s2">&quot;41156888&quot;</span><span class="p">},{</span><span class="err">$push</span><span class="p">:{</span><span class="err">grades</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="err">ISODa</span><span class="kc">te</span><span class="err">(</span><span class="s2">&quot;2016-01-02T00:00:00.000Z&quot;</span><span class="err">)</span><span class="p">,</span><span class="nt">&quot;grade&quot;</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="mi">14</span><span class="p">}}}</span><span class="err">)</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3"></a><a href="#__codelineno-66-3"><span class="linenos" data-linenos="3 "></span></a><span class="err">db.res</span><span class="kc">taurantes</span><span class="err">.</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">d(</span><span class="p">{</span><span class="nt">&quot;restaurant_id&quot;</span><span class="p">:</span><span class="s2">&quot;41156888&quot;</span><span class="p">}</span><span class="err">)</span><span class="w"> </span><span class="c1">// Comprobamos que se ha añadido correctamente</span>
</span></code></pre></div>
</li>
</ol>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023-2024 Jaime Rabasco - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/jaimerabasco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<jaimerabasco@iesgrancapitan.org>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.indexes", "toc.follow", "navigation.top", "header.autohide", "announce.dismiss", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>