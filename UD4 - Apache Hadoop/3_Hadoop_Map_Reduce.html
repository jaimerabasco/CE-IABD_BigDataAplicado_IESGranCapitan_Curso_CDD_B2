
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD4%20-%20Apache%20Hadoop/3_Hadoop_Map_Reduce.html">
      
      
        <link rel="prev" href="2_Hadoop_HDFS.html">
      
      
        <link rel="next" href="4_Hadoop_Yarn.html">
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Map Reduce - Big Data Aplicado</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Map Reduce - Big Data Aplicado" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD4 - Apache Hadoop/3_Hadoop_Map_Reduce.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD4%20-%20Apache%20Hadoop/3_Hadoop_Map_Reduce.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Map Reduce - Big Data Aplicado" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD4 - Apache Hadoop/3_Hadoop_Map_Reduce.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ud-4-apache-hadoop-mapreduce" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Big Data Aplicado" class="md-header__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Data Aplicado
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Map Reduce
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Big Data Aplicado" class="md-nav__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Big Data Aplicado
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadatos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadatos
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guia_didactica.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía Didáctica
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD1 - Gestión de Soluciones
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            UD1 - Gestión de Soluciones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/1_dis_const_soluc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diseño y Construcción de Soluciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/2_proced_mecan_ingesta_datos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedimientos y Mecanismos de Ingesta de Datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/3_form_datos_almacenamiento.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formato de Datos Adecuado para el Almacenamiento
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD2 - Procesado y Presentación Datos Almacenados
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            UD2 - Procesado y Presentación Datos Almacenados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/mongoDB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/neo4j.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neo4j
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD3 - Introducción a la computación paralela y distribuida
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            UD3 - Introducción a la computación paralela y distribuida
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/comput_paralela_distribuida.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computación Paralela y Distribuida
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD4 - Apache Hadoop
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            UD4 - Apache Hadoop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_Plataforma_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plataforma y Ecosistema Hadoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_Hadoop_HDFS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Map Reduce
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="3_Hadoop_Map_Reduce.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Map Reduce
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      1. Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fases-y-funcionamiento" class="md-nav__link">
    <span class="md-ellipsis">
      2. Fases y Funcionamiento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-webui" class="md-nav__link">
    <span class="md-ellipsis">
      3. WebUI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ejemplos" class="md-nav__link">
    <span class="md-ellipsis">
      4. Ejemplos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Ejemplos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-ejemplo-1" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Ejemplo 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-ejemplo-2" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Ejemplo 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ejercicios" class="md-nav__link">
    <span class="md-ellipsis">
      5. Ejercicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-ejercicio-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Ejercicio 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-ejercicio-2" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Ejercicio 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="4_Hadoop_Yarn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yarn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="5_Cluster_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Hadoop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../creditos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creditos
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      1. Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fases-y-funcionamiento" class="md-nav__link">
    <span class="md-ellipsis">
      2. Fases y Funcionamiento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-webui" class="md-nav__link">
    <span class="md-ellipsis">
      3. WebUI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ejemplos" class="md-nav__link">
    <span class="md-ellipsis">
      4. Ejemplos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Ejemplos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-ejemplo-1" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Ejemplo 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-ejemplo-2" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Ejemplo 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-ejercicios" class="md-nav__link">
    <span class="md-ellipsis">
      5. Ejercicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-ejercicio-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Ejercicio 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-ejercicio-2" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Ejercicio 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ud-4-apache-hadoop-mapreduce">UD 4 - Apache Hadoop - MapReduce<a class="headerlink" href="#ud-4-apache-hadoop-mapreduce" title="Permanent link">&para;</a></h1>
<h2 id="1-introduccion">1. Introducción<a class="headerlink" href="#1-introduccion" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title"><strong>MapReduce</strong></p>
<p>Hadoop MapReduce es un <strong>framework</strong> para escribir fácilmente aplicaciones que procesan <strong>grandes cantidades de datos</strong> en <strong>paralelo</strong> en <strong>grandes clústeres</strong> (miles de nodos) de <strong>hardware commodity</strong> de manera <strong>confiable</strong> y <strong>tolerante a fallos</strong>.</p>
</div>
<p>MapReduce está diseñado para poder procesar grandes cantidades de datos, ya que sigue una filosofía <strong>Divide y Vencerás (DYV)</strong>, que consiste en que para resolver un problema complejo, la mejor forma de hacerlo es dividirlo en fragmentos muy pequeños que pueden ser solucionados de forma independiente, resolverlo por separado e ir construyendo con las soluciones parciales la solución final.</p>
<p>Para el caso del procesamiento de datos de mucho volumen, la aproximación Divide y Vencerás que hace MapReduce consiste en dividir todo el conjunto de datos de entrada en pequeños fragmentos, procesarlos por separado, e ir agrupando los resultados parciales.</p>
<p>Para ello, usa un paradigma de programación funcional en dos fases, la de <strong>mapeo</strong> y la de <strong>reducción</strong>, y define el algoritmo que utiliza Hadoop para paralelizar las tareas. Un algoritmo MapReduce divide los datos, los procesa en paralelo, los reordena, combina y agrega de vuelta los resultados mediante un formato <strong>clave/valor</strong>.</p>
<div class="admonition note inline end">
<p class="admonition-title">Note</p>
<p>Hadoop Aunque MapReduce ha sido utilizado ampliamente por toda la comunidad de desarrolladores o proyectos Big Data, la realidad es que hoy en día cada vez se usa menos, como puede verse en este gráfico de tendencia de búsquedas en Google:</p>
<p><figure style="align: center; width:600px;">
    <img src="images/Figura4.1_MapReduce_Historial_Busqueda_Google.jpg">
    <figcaption>Figura4.1_MapReduce: Historial de Búsquedas en Google. (Fuente: Ministerio de Educación)</figcaption>
</figure></p>
<p>Sin embargo, es importante entender y comprender bien MapReduce por dos motivos:</p>
<ul>
<li>Utiliza un modelo de programación que es común en otras herramientas o frameworks Big Data.</li>
<li>Muchas herramientas que se ejecutan sobre Hadoop, como puede ser el caso de Hive, pese a que ofrecen funcionalidad de alto nivel, como puede ser la capacidad de hacer consultas en formato SQL, por debajo ejecutan MapReduce. Entender MapReduce es fundamental para poder depurar o resolver problemas en la ejecución de trabajos con este tipo de herramientas.</li>
</ul>
</div>
<p>Estos subprocesos asociados a la tarea se ejecutan de manera <strong>distribuida</strong>, en diferentes nodos de procesamiento o esclavos. Para controlar y gestionar su ejecución, existe un proceso <strong>Master</strong> o <strong>Job Tracker</strong>. También es el encargado de aceptar los nuevos trabajos enviados al sistema por los clientes.</p>
<figure style="align: center; width:600px;">
    <img src="images/Figura4.2_MapReduce_WorkFlow_MapReduce.jpg">
    <figcaption>Figura4.2_MapReduce WorkFlow. (Fuente: Apache Hadoop)</figcaption>
</figure>

<p>Este sistema de procesamiento se apoya en tecnologías de almacenamiento de datos distribuidas, en cuyos nodos se ejecutan estas operaciones de tipo map y reduce. El sistema de ficheros distribuido de Hadoop es HDFS (Hadoop Distributed File System), encargado de almacenar los ficheros divididos en bloques de datos. HDFS proporciona la división previa de los datos en bloques que necesita MapReduce para ejecutar. Los resultados del procesamiento se pueden almacenar en el mismo sistema de almacenamiento o bien en una base de datos o sistema externo.</p>
<figure style="align: center; width:600px;">
    <img src="images/Figura4.3_MapReduce_Esquema_fases_MapReduce.jpg">
    <figcaption>Figura4.3_MapReduce_Esquema de fases de MapReduce. (Fuente: AprenderBigData)</figcaption>
</figure>

<h2 id="2-fases-y-funcionamiento">2. Fases y Funcionamiento<a class="headerlink" href="#2-fases-y-funcionamiento" title="Permanent link">&para;</a></h2>
<p>Un trabajo de MapReduce se compone de cinco etapas distintas, ejecutadas en orden:</p>
<ol>
<li>Envío del trabajo, aceptación y distribución en el clúster.</li>
<li>Ejecución de la fase <strong>map</strong>:Se ejecuta en subtareas llamadas <em>mappers</em>. Estos componentes son los responsables de generar pares <em>clave-valor</em> <strong><em>filtrando, agrupando, ordenando o transformando los datos originales</em></strong>. Los pares de datos intermedios, no se almacenan en HDFS.</li>
<li>Ejecución de la fase <strong>shuffle</strong>: Puede no ser necesaria. Es el paso intermedio entre Map y reduce que ayuda a recoger los datos y ordenarlos de manera conveniente para el procesamiento. Con esta fase, se pretende agregar las ocurrencias repetidas en cada uno de los mappers.</li>
<li>Ejecución de la fase <strong>order</strong>. Ordena y/o baraja los datos a partir de la clave.</li>
<li>Ejecución de la fase <strong>reduce</strong>: Gestiona la agregación de los valores producidos por todos los mappers del sistema (o por la fase shuffle) de tipo clave-valor en función de su clave. Por último, cada reducer genera su fichero de salida de forma independiente, generalmente escrito en HDFS.</li>
</ol>
<p>De todas estas fases debes saber que el programador sólo suele programar la fase <strong><em>map</em></strong> y <strong><em>reduce</em></strong>, siendo el resto de fases ejecutadas de forma automática por MapReduce en base a los parámetros de configuración.</p>
<figure style="align: center; width:600px;">
    <img src="images/Figura4.4_MapReduce_FrameworkMapReduce.jpg">
    <figcaption>Figura4.4_MapReduce_Framework MapReduce. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<p>En un trabajo Hadoop MapReduce, se dividen los datos de entrada en fragmentos independientes que son procesados por los mappers en paralelo. A continuación, se ordenan los resultados del map, que son la entrada para los reducers. Generalmente, las entradas y salidas de los trabajos se almacenan en un sistema de ficheros, siendo los nodos de almacenamiento y de cómputo los mismos. También es muy común que la lógica de la aplicación no se pueda descomponer en una única ejecución de MapReduce, por lo que se encadenan varias de estas fases, tratando los resultados de una como entrada para los mappers de la siguiente fase.</p>
<p>Esta característica, permite ejecutar las tareas de cada fragmento en el nodo donde se almacena, reduciendo el tiempo de acceso a los datos y los movimientos entre nodos del clúster.</p>
<h2 id="3-webui">3. WebUI<a class="headerlink" href="#3-webui" title="Permanent link">&para;</a></h2>
<p>Podemos observar los trabajos realizados desde la Interfaz WebUI en el puerto 8088 <code>http://bda-iesgrancapitan:8088</code></p>
<figure style="align: center;">
    <img src="images/Figura4.5_MapReduce_WebUI.jpg">
    <figcaption>Figura4.5_MapReduce_WebUI. (Fuente: Propia)</figcaption>
</figure>

<h2 id="4-ejemplos">4. Ejemplos<a class="headerlink" href="#4-ejemplos" title="Permanent link">&para;</a></h2>
<p>Para explicar el funcionamiento de MapReduce, se van a utilizar los siguientes ejemplos:</p>
<h3 id="41-ejemplo-1">4.1 Ejemplo 1<a class="headerlink" href="#41-ejemplo-1" title="Permanent link">&para;</a></h3>
<p>El siguiente gráfico muestra un ejemplo de una empresa que fabrica juguetes de colores. Cuando un cliente compra un juguete desde la página web, el pedido se almacena como un fichero en Hadoop con los colores de los juguetes adquiridos. Para averiguar cuantas unidades de cada color debe preparar la fábrica, se emplea un algoritmo MapReduce para contar los colores:</p>
<figure style="align: center;">
    <img src="images/Figura4.6_MapReduce_Ejemplo1_Map_y_Reduce.jpg">
    <figcaption>Figura4.6_MapReduce_Ejemplo1_Map y Reduce. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<p>Siguiendo MapReduce:</p>
<ul>
<li>Fase de <em>mapeo</em> <strong>(Map)</strong>: Los documentos se parten en pares de clave/valor. Hasta que no se reduzca, podemos tener muchos duplicados.</li>
<li>Fase de <em>reducción</em> <strong>(Reduce)</strong>: Es en cierta medida similar a un "group by" de SQL. Las ocurrencias similares se agrupan, y dependiendo de la función de reducción, se puede crear un resultado diferente. En nuestro ejemplo queremos contar los colores, y eso es lo que devuelve nuestra función.</li>
</ul>
<p>Es un proceso de procesamiento costoso. Los pasos serían los siguientes:</p>
<figure style="align: center; width:600px;">
    <img src="images/Figura4.7_MapReduce_Ejemplo1_Detallado.jpg">
    <figcaption>Figura4.7_MapReduce_Ejemplo1 Detallado. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<ol>
<li>Lectura desde HDFS de los ficheros de entrada.</li>
<li>Pasar cada línea de forma separada al mapeador, teniendo tantos mapeadores como bloques de datos que tengamos.</li>
<li>El mapeador parsea los colores (claves) de cada fichero y produce un nuevo fichero para cada color con el número de ocurrencias encontradas (valor), es decir, mapea una clave (color) con un valor (número de ocurrencias).</li>
<li>Para facilitar la agregación, se ordenan y/o barajan los datos a partir de la clave.</li>
<li>La fase de reducción suma las ocurrencias de cada color y genera un fichero por clave con el total de cada color.</li>
<li>Las claves se unen en un único fichero de salida que se persiste en HDFS.</li>
</ol>
<h3 id="42-ejemplo-2">4.2 Ejemplo 2<a class="headerlink" href="#42-ejemplo-2" title="Permanent link">&para;</a></h3>
<p>Imagina que tenemos un fichero de muchos terabytes de datos con todas las cotizaciones de todas las empresas de todas las bolsas del mundo desde hace 30 años, con una cotización cada minuto. Cada línea del fichero tiene el siguiente formato:</p>
<p><code>Fecha y hora (día/mes/año hora:minutos:segundos);nombre de la empresa;valor de cotización actual;valor de cotización anterior</code></p>
<p>Por ejemplo, algunas de las líneas del fichero podrían ser las siguientes:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>20/01/2021 11:54:34;SANTANDER;4,54;4,49
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>14/05/1995 09:54;TELEFONICA;11,90;12,01
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a>01/01/1997 08:03:21;SANTANDER;11,24;11,49
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a>19/06/2022 11:54:22;APPLE;111,25;114,89
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="5 "></span></a>23/04/2003 16:32:11;ALPHABET;34,49;36,44;
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="6 "></span></a>21/12/2020 10:10:56;TELEFONICA;14,31;14;29
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos="7 "></span></a>26/02/1995 14:09:40;MICROSOFT;132,29;133,95
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos="8 "></span></a>04/05/1999 11:05:34;WALLMART;34,98;35,05
</span></code></pre></div>
<p>Tomando una media de 35.000 empresas cotizadas en el mundo, es decir, 35.000 cotizaciones por minuto serían 25.200.000 cotizaciones al día, y un total de <strong>275.940.000.000 líneas</strong> en el fichero por los 30 años a 365 días por cada año, que son unos <strong>25 terabytes de datos en un único fichero</strong>.</p>
<p>Nuestro objetivo es averiguar cuántas veces ha tenido cada empresa un incremento en su cotización, es decir, si una cotización es superior a su valor anterior, sumaremos uno, y si la cotización es inferior, no lo sumaremos. Es decir, el resultado sería una lista de la siguiente forma:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>SANTANDER 3888981
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="2 "></span></a>TELEFONICA 3331923
</span></code></pre></div>
<p>Intentar este cálculo leyendo el fichero de forma secuencial y teniendo un contador para cada empresa sería un proceso que llevaría días de procesamiento, así que vamos a utilizar MapReduce para realizar este proceso.</p>
<p>Como se describió anteriormente, el primer paso es crear la aplicación, por ejemplo, utilizando lenguaje Java, y enviar el programa al clúster Hadoop utilizando el API de MapReduce para enviar trabajos.</p>
<p>Una vez arrancada la aplicación, en primer lugar decidirá cómo partir el fichero de entrada en fragmentos para que los datos puedan ser procesados en paralelo. El componente que realiza esta división de los ficheros de entrada se denomina <strong>InputFormat</strong>.</p>
<p>Por cada fragmento del fichero de entrada, se crea una tarea <strong>map</strong> que ejecutará la función <strong>map</strong> desarrollada en diferentes nodos y en paralelo, es decir, cada fragmento será procesado en paralelo por diferentes nodos.</p>
<p>La función <strong>map</strong> toma cada línea, que es separada por el <em>InputFormat</em>, la lee, y emite un resultado parcial, que será <code>[Nombre de la empresa, 1]</code>, en los casos en los que vea que el valor actual es mayor que el valor anterior. Esta función se ejecutará tantas veces como líneas tenga el fragmento de fichero asignado, y en tantos nodos como fragmentos se haya dividido el fichero.</p>
<p>Es decir, para cada nodo, tendremos, por ejemplo, este resultado:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a>SANTANDER, 1
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos="2 "></span></a>WALLMART, 1
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos="3 "></span></a>TELEFONICA, 1
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos="4 "></span></a>APPLE, 1
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos="5 "></span></a>ALPHABET, 1
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos="6 "></span></a>...
</span></code></pre></div>
<p>Y tendremos tantos resultados de éstos como fragmentos del fichero haya, y en tantos nodos/servidores como se haya ejecutado la función.</p>
<p>A continuación se ejecutan las fases de <strong>shuffle</strong> y <strong>sort</strong> de forma automática y transparente para el desarrollador, donde se toman los resultados parciales, se ordenan por una <strong>clave</strong>, que en este caso será el nombre de la empresa, se <strong>combinan</strong> y se <strong>ordenan</strong>, juntando todos los valores de cada empresa, es decir, teniendo la lista de valores con el siguiente formato:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos=" 1 "></span></a>SANTANDER, 1
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos=" 2 "></span></a>SANTANDER, 2
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos=" 3 "></span></a>SANTANDER, 1
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos=" 4 "></span></a>...
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos=" 5 "></span></a>TELEFONICA, 1
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos=" 6 "></span></a>TELEFONICA, 1
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><a href="#__codelineno-3-7"><span class="linenos" data-linenos=" 7 "></span></a>...
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><a href="#__codelineno-3-8"><span class="linenos" data-linenos=" 8 "></span></a>APPLE, 1
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><a href="#__codelineno-3-9"><span class="linenos" data-linenos=" 9 "></span></a>...
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><a href="#__codelineno-3-10"><span class="linenos" data-linenos="10 "></span></a>ALPHABET, 1
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><a href="#__codelineno-3-11"><span class="linenos" data-linenos="11 "></span></a>ALPHABET, 1
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><a href="#__codelineno-3-12"><span class="linenos" data-linenos="12 "></span></a>ALPHABET, 1
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><a href="#__codelineno-3-13"><span class="linenos" data-linenos="13 "></span></a>...
</span></code></pre></div>
<p>Por último, se divide la lista ordenada en diferentes particiones, siendo cada partición un conjunto de datos con la misma clave, y se llaman a la función <strong>reduce</strong> desarrollada por el usuario, que tomará los diferentes valores emitidos por la fase <strong>map</strong>, pero ya ordenados y unidos, e irá haciendo la suma de cada empresa, dando como resultado pares <code>[Nombre de la empresa, número de veces que se ha encontrado una cotización incrementada]</code>.</p>
<p>MapReduce, por último tomará todos los resultados de las funciones reduce y las unirá, formando el resultado final, que será la lista total de empresas con el número de veces en las que la cotización sube.</p>
<p>El ejemplo puede parecer sencillo, pero permite entender cómo funciona MapReduce para dividir un procesamiento en diferentes bloques de ejecución que se ejecutan en paralelo.</p>
<p>En la siguiente imagen puede verse de forma gráfica el ejemplo anterior:</p>
<figure style="align: center;">
    <img src="images/Figura4.8_MapReduce_Ejemplo2_Detallado.jpg">
    <figcaption>Figura4.8_MapReduce_Ejemplo2 Detallado. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<div class="admonition note">
<p class="admonition-title">Sobre los ejemplos</p>
<p>Quizás los ejemplos te parezcan muy sencillos y puedes pensar que MapReduce no resuelve problemas muy complejos. La realidad es que MapReduce permite resolver problemas de procesamiento de datos realmente complejos, pero requiere en primer lugar un estudio de problema y una división en problemas más sencillos que pueden resolverse en paralelo.</p>
<p>Además, cuando tienes que resolver un problema muy complejo, lo habitual es desarrollar un flujo de ejecución en el que se concatenan varios procesos MapReduce, donde el primer proceso hace una parte del trabajo, su resultado lo coge otro proceso MapReduce que realiza otra parte, etc. hasta llegar a tener todo el problema resuelto.</p>
<p>La esencia de MapReduce para resolver un problema es intentar descomponerlo en problemas más sencillos en los que cada problema se resuelve con una primera fase en la que se toman todos los datos de entrada uno a uno, se realiza alguna operación con ellos, y los resultados son combinados y ejecutados por otra fase de ejecución que realiza una operación con la que se devuelve el resultado.</p>
</div>
<h2 id="5-ejercicios">5. Ejercicios<a class="headerlink" href="#5-ejercicios" title="Permanent link">&para;</a></h2>
<p>Vamos a ver 2 ejercicios para poner en práctica lo aprendido en MapReduce</p>
<h3 id="51-ejercicio-1">5.1 Ejercicio 1<a class="headerlink" href="#51-ejercicio-1" title="Permanent link">&para;</a></h3>
<p>En este ejercicio, vamos a crear nuestro primer programa MapReduce. Asegurate de que tienes Apache Hadoop instalado y funcionando. Si no, accede al recurso correspondiente.</p>
<ol>
<li>Creamos un directorio en local donde vamos a desarrollar cada uno de los códigos fuente en Java</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a>mkdir -p $HOME/bda/MapReduce/ejercicios
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos="2 "></span></a>cd $HOME/bda/MapReduce/ejercicios
</span></code></pre></div>
<ol start="2">
<li>Descargamos el fichero fuente para el ejercicio en local. Contiene información relacionada con ventas, el nombre del producto, el precio, el modo de pago, la ciudad, el país del cliente, etc; alojado en este gist de github</li>
</ol>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a>wget https://gist.githubusercontent.com/jaimerabasco/cb528c32b4c4092e6a0763d8b6bc25c0/raw/54b30a89f3b608d0837bd1fc10bc31e64ba4c7c8/Ventas_Enero23.csv
</span></code></pre></div>
<strong><em>El objetivo será descubrir el número de productos vendidos en cada país.</em></strong></p>
<ol start="3">
<li>Generamos las clases necesarias para nuestro objetivo en MapReduce</li>
</ol>
<div class="language-java highlight"><span class="filename">VentasMapper.java</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">package</span><span class="w"> </span><span class="nn">VentasPais</span><span class="p">;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.IntWritable</span><span class="p">;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><a href="#__codelineno-6-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.LongWritable</span><span class="p">;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><a href="#__codelineno-6-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.Text</span><span class="p">;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><a href="#__codelineno-6-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.mapred.*</span><span class="p">;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><a href="#__codelineno-6-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><a href="#__codelineno-6-10"><span class="linenos" data-linenos="10 "></span></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">VentasMapper</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">MapReduceBase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Mapper</span><span class="o">&lt;</span><span class="n">LongWritable</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">IntWritable</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><a href="#__codelineno-6-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IntWritable</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IntWritable</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><a href="#__codelineno-6-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><a href="#__codelineno-6-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">map</span><span class="p">(</span><span class="n">LongWritable</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">OutputCollector</span><span class="o">&lt;</span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">IntWritable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">Reporter</span><span class="w"> </span><span class="n">reporter</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><a href="#__codelineno-6-14"><span class="linenos" data-linenos="14 "></span></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><a href="#__codelineno-6-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">valueString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><a href="#__codelineno-6-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">SingleData_porPais</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valueString</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">);</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><a href="#__codelineno-6-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">        </span><span class="n">output</span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">SingleData_porPais</span><span class="o">[</span><span class="mi">7</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="n">one</span><span class="p">);</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><a href="#__codelineno-6-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><a href="#__codelineno-6-19"><span class="linenos" data-linenos="19 "></span></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-java highlight"><span class="filename">VentasPaisDriver.java</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">package</span><span class="w"> </span><span class="nn">VentasPais</span><span class="p">;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.fs.Path</span><span class="p">;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><a href="#__codelineno-7-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.*</span><span class="p">;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><a href="#__codelineno-7-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.mapred.*</span><span class="p">;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><a href="#__codelineno-7-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><a href="#__codelineno-7-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">VentasPaisDriver</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><a href="#__codelineno-7-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><a href="#__codelineno-7-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">        </span><span class="n">JobClient</span><span class="w"> </span><span class="n">my_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JobClient</span><span class="p">();</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><a href="#__codelineno-7-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">        </span><span class="c1">// Creamos el objeto configuraciób para el trabajo</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><a href="#__codelineno-7-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">        </span><span class="n">JobConf</span><span class="w"> </span><span class="n">job_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JobConf</span><span class="p">(</span><span class="n">VentasPaisDriver</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a><a href="#__codelineno-7-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><a href="#__codelineno-7-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">        </span><span class="c1">// Configuramos un nombre del trabajo</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><a href="#__codelineno-7-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setJobName</span><span class="p">(</span><span class="s">&quot;VentaPorPais&quot;</span><span class="p">);</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a><a href="#__codelineno-7-15"><span class="linenos" data-linenos="15 "></span></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a><a href="#__codelineno-7-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">        </span><span class="c1">// Especificamos el tipo de dato de clave y valor de salida</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a><a href="#__codelineno-7-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setOutputKeyClass</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a><a href="#__codelineno-7-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setOutputValueClass</span><span class="p">(</span><span class="n">IntWritable</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a><a href="#__codelineno-7-19"><span class="linenos" data-linenos="19 "></span></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a><a href="#__codelineno-7-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">        </span><span class="c1">// Especificamos nombres de la clase Mapper y Reducer</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21"></a><a href="#__codelineno-7-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setMapperClass</span><span class="p">(</span><span class="n">VentasPais</span><span class="p">.</span><span class="na">VentasMapper</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22"></a><a href="#__codelineno-7-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setReducerClass</span><span class="p">(</span><span class="n">VentasPais</span><span class="p">.</span><span class="na">VentasPaisReducer</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23"></a><a href="#__codelineno-7-23"><span class="linenos" data-linenos="23 "></span></a>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24"></a><a href="#__codelineno-7-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">        </span><span class="c1">// Especificamos formato del tipo de dato de entrada y salida</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25"></a><a href="#__codelineno-7-25"><span class="linenos" data-linenos="25 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setInputFormat</span><span class="p">(</span><span class="n">TextInputFormat</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26"></a><a href="#__codelineno-7-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">        </span><span class="n">job_conf</span><span class="p">.</span><span class="na">setOutputFormat</span><span class="p">(</span><span class="n">TextOutputFormat</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27"></a><a href="#__codelineno-7-27"><span class="linenos" data-linenos="27 "></span></a>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28"></a><a href="#__codelineno-7-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">        </span><span class="c1">// Cambiamos la entrada y salida de directorios usando entrada como argumentos:</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29"></a><a href="#__codelineno-7-29"><span class="linenos" data-linenos="29 "></span></a><span class="w">        </span><span class="c1">//arg[0] = nombre del directorio de entrada en HDFS,</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30"></a><a href="#__codelineno-7-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">        </span><span class="c1">//arg[1] = nombre del directorio de salida que se va a crear para almacenar el fichero de salida</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31"></a><a href="#__codelineno-7-31"><span class="linenos" data-linenos="31 "></span></a>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32"></a><a href="#__codelineno-7-32"><span class="linenos" data-linenos="32 "></span></a><span class="w">        </span><span class="n">FileInputFormat</span><span class="p">.</span><span class="na">setInputPaths</span><span class="p">(</span><span class="n">job_conf</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">));</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33"></a><a href="#__codelineno-7-33"><span class="linenos" data-linenos="33 "></span></a><span class="w">        </span><span class="n">FileOutputFormat</span><span class="p">.</span><span class="na">setOutputPath</span><span class="p">(</span><span class="n">job_conf</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">));</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34"></a><a href="#__codelineno-7-34"><span class="linenos" data-linenos="34 "></span></a>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35"></a><a href="#__codelineno-7-35"><span class="linenos" data-linenos="35 "></span></a><span class="w">        </span><span class="n">my_client</span><span class="p">.</span><span class="na">setConf</span><span class="p">(</span><span class="n">job_conf</span><span class="p">);</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36"></a><a href="#__codelineno-7-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37"></a><a href="#__codelineno-7-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">            </span><span class="c1">// Ejecuta el job </span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38"></a><a href="#__codelineno-7-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">            </span><span class="n">JobClient</span><span class="p">.</span><span class="na">runJob</span><span class="p">(</span><span class="n">job_conf</span><span class="p">);</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39"></a><a href="#__codelineno-7-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40"></a><a href="#__codelineno-7-40"><span class="linenos" data-linenos="40 "></span></a><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41"></a><a href="#__codelineno-7-41"><span class="linenos" data-linenos="41 "></span></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42"></a><a href="#__codelineno-7-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43"></a><a href="#__codelineno-7-43"><span class="linenos" data-linenos="43 "></span></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-java highlight"><span class="filename">VentasPaisReducer.java</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">package</span><span class="w"> </span><span class="nn">VentasPais</span><span class="p">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.*</span><span class="p">;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos=" 5 "></span></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.IntWritable</span><span class="p">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a><a href="#__codelineno-8-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.io.Text</span><span class="p">;</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><a href="#__codelineno-8-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.hadoop.mapred.*</span><span class="p">;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><a href="#__codelineno-8-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><a href="#__codelineno-8-10"><span class="linenos" data-linenos="10 "></span></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">VentasPaisReducer</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">MapReduceBase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Reducer</span><span class="o">&lt;</span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">IntWritable</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">IntWritable</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a><a href="#__codelineno-8-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a><a href="#__codelineno-8-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="n">Text</span><span class="w"> </span><span class="n">t_key</span><span class="p">,</span><span class="w"> </span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">IntWritable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">OutputCollector</span><span class="o">&lt;</span><span class="n">Text</span><span class="p">,</span><span class="n">IntWritable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">Reporter</span><span class="w"> </span><span class="n">reporter</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><a href="#__codelineno-8-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">        </span><span class="n">Text</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_key</span><span class="p">;</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><a href="#__codelineno-8-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">frequencyPorPais</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><a href="#__codelineno-8-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">values</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a><a href="#__codelineno-8-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">            </span><span class="c1">// reemplazamos el tipo de valor con el tipo real de nuestro valor</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><a href="#__codelineno-8-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">            </span><span class="n">IntWritable</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">IntWritable</span><span class="p">)</span><span class="w"> </span><span class="n">values</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a><a href="#__codelineno-8-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">            </span><span class="n">frequencyPorPais</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="na">get</span><span class="p">();</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a><a href="#__codelineno-8-19"><span class="linenos" data-linenos="19 "></span></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a><a href="#__codelineno-8-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a><a href="#__codelineno-8-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">        </span><span class="n">output</span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IntWritable</span><span class="p">(</span><span class="n">frequencyPorPais</span><span class="p">));</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><a href="#__codelineno-8-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23"></a><a href="#__codelineno-8-23"><span class="linenos" data-linenos="23 "></span></a><span class="p">}</span>
</span></code></pre></div>
<ol start="4">
<li>Copia el fichero del "Ventas_Enero23.csv" a HDFS</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a>hdfs dfs -mkdir -p /bda/mapreduce/ejercicios
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos="2 "></span></a>hdfs dfs -copyFromLocal Ventas_Enero23.csv /bda/mapreduce/ejercicios
</span></code></pre></div>
<ol start="5">
<li>Generamos los .class para crear el paquete jar</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a>javac -cp `hadoop classpath` -d . VentasMapper.java VentasPaisReducer.java VentasPaisDriver.java
</span></code></pre></div>
<p><em>Se genera un directorio con los .class</em> </p>
<ol start="6">
<li>Creamos un archivo llamado <code>Manifest.txt</code> con el siguiente contenido, donde indicamos el nombre de la clase main</li>
</ol>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a>Main-Class: VentasPais.VentasPaisDriver
</span></code></pre></div>
<em>Incluye también un salto de línea al final</em></p>
<ol start="7">
<li>Generamos el .jar</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos="1 "></span></a>jar cfm VentasProductosPorPais.jar Manifest.txt VentasPais/*.class
</span></code></pre></div>
<ol start="8">
<li>Ejecutamos la aplicación creada indicando el input de entrada(<em>Ventas_Enero23.csv</em>) y la salida</li>
</ol>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="1 "></span></a>hadoop jar VentasProductosPorPais.jar /bda/mapreduce/ejercicios/Ventas_Enero23.csv /bda/mapreduce/ejercicios/salida_ventas
</span></code></pre></div>
<em>Puedes usar también el comando <code>yarn jar</code></em></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:24,828<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsConfig:<span class="w"> </span>Loaded<span class="w"> </span>properties<span class="w"> </span>from<span class="w"> </span>hadoop-metrics2.properties
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a><a href="#__codelineno-14-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:24,910<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>Scheduled<span class="w"> </span>Metric<span class="w"> </span>snapshot<span class="w"> </span>period<span class="w"> </span>at<span class="w"> </span><span class="m">10</span><span class="w"> </span>second<span class="o">(</span>s<span class="o">)</span>.
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a><a href="#__codelineno-14-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:24,911<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>JobTracker<span class="w"> </span>metrics<span class="w"> </span>system<span class="w"> </span>started
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a><a href="#__codelineno-14-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:24,975<span class="w"> </span>WARN<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>JobTracker<span class="w"> </span>metrics<span class="w"> </span>system<span class="w"> </span>already<span class="w"> </span>initialized!
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a><a href="#__codelineno-14-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,160<span class="w"> </span>WARN<span class="w"> </span>mapreduce.JobResourceUploader:<span class="w"> </span>Hadoop<span class="w"> </span>command-line<span class="w"> </span>option<span class="w"> </span>parsing<span class="w"> </span>not<span class="w"> </span>performed.<span class="w"> </span>Implement<span class="w"> </span>the<span class="w"> </span>Tool<span class="w"> </span>interface<span class="w"> </span>and<span class="w"> </span>execute<span class="w"> </span>your<span class="w"> </span>application<span class="w"> </span>with<span class="w"> </span>ToolRunner<span class="w"> </span>to<span class="w"> </span>remedy<span class="w"> </span>this.
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a><a href="#__codelineno-14-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,342<span class="w"> </span>INFO<span class="w"> </span>mapred.FileInputFormat:<span class="w"> </span>Total<span class="w"> </span>input<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>process<span class="w"> </span>:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a><a href="#__codelineno-14-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,484<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>splits:1
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a><a href="#__codelineno-14-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,639<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>Submitting<span class="w"> </span>tokens<span class="w"> </span><span class="k">for</span><span class="w"> </span>job:<span class="w"> </span>job_local514940019_0001
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a><a href="#__codelineno-14-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,639<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>Executing<span class="w"> </span>with<span class="w"> </span>tokens:<span class="w"> </span><span class="o">[]</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a><a href="#__codelineno-14-10"><span class="linenos" data-linenos="10 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,910<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>The<span class="w"> </span>url<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span>the<span class="w"> </span>job:<span class="w"> </span>http://localhost:8080/
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a><a href="#__codelineno-14-11"><span class="linenos" data-linenos="11 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,911<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>Running<span class="w"> </span>job:<span class="w"> </span>job_local514940019_0001
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a><a href="#__codelineno-14-12"><span class="linenos" data-linenos="12 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,926<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>OutputCommitter<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>config<span class="w"> </span>null
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><a href="#__codelineno-14-13"><span class="linenos" data-linenos="13 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,927<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>OutputCommitter<span class="w"> </span>is<span class="w"> </span>org.apache.hadoop.mapred.FileOutputCommitter
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a><a href="#__codelineno-14-14"><span class="linenos" data-linenos="14 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,932<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a><a href="#__codelineno-14-15"><span class="linenos" data-linenos="15 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:25,941<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>FileOutputCommitter<span class="w"> </span>skip<span class="w"> </span>cleanup<span class="w"> </span>_temporary<span class="w"> </span>folders<span class="w"> </span>under<span class="w"> </span>output<span class="w"> </span>directory:false,<span class="w"> </span>ignore<span class="w"> </span>cleanup<span class="w"> </span>failures:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a><a href="#__codelineno-14-16"><span class="linenos" data-linenos="16 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,161<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>map<span class="w"> </span>tasks
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a><a href="#__codelineno-14-17"><span class="linenos" data-linenos="17 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,164<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Starting<span class="w"> </span>task:<span class="w"> </span>attempt_local514940019_0001_m_000000_0
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><a href="#__codelineno-14-18"><span class="linenos" data-linenos="18 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,179<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a><a href="#__codelineno-14-19"><span class="linenos" data-linenos="19 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,179<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>FileOutputCommitter<span class="w"> </span>skip<span class="w"> </span>cleanup<span class="w"> </span>_temporary<span class="w"> </span>folders<span class="w"> </span>under<span class="w"> </span>output<span class="w"> </span>directory:false,<span class="w"> </span>ignore<span class="w"> </span>cleanup<span class="w"> </span>failures:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a><a href="#__codelineno-14-20"><span class="linenos" data-linenos="20 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,207<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w">  </span>Using<span class="w"> </span>ResourceCalculatorProcessTree<span class="w"> </span>:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">]</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a><a href="#__codelineno-14-21"><span class="linenos" data-linenos="21 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,230<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Processing<span class="w"> </span>split:<span class="w"> </span>hdfs://bda-iesgrancapitan:9000/bda/mapreduce/ejercicios/Ventas_Enero23.csv:0+123637
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a><a href="#__codelineno-14-22"><span class="linenos" data-linenos="22 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,271<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>numReduceTasks:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a><a href="#__codelineno-14-23"><span class="linenos" data-linenos="23 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,349<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="o">(</span>EQUATOR<span class="o">)</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>kvi<span class="w"> </span><span class="m">26214396</span><span class="o">(</span><span class="m">104857584</span><span class="o">)</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a><a href="#__codelineno-14-24"><span class="linenos" data-linenos="24 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,350<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>mapreduce.task.io.sort.mb:<span class="w"> </span><span class="m">100</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a><a href="#__codelineno-14-25"><span class="linenos" data-linenos="25 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,350<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>soft<span class="w"> </span>limit<span class="w"> </span>at<span class="w"> </span><span class="m">83886080</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a><a href="#__codelineno-14-26"><span class="linenos" data-linenos="26 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,350<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">bufstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="nv">bufvoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">104857600</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27"></a><a href="#__codelineno-14-27"><span class="linenos" data-linenos="27 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,350<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">kvstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26214396</span><span class="p">;</span><span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6553600</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28"></a><a href="#__codelineno-14-28"><span class="linenos" data-linenos="28 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,352<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Map<span class="w"> </span>output<span class="w"> </span>collector<span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>org.apache.hadoop.mapred.MapTask<span class="nv">$MapOutputBuffer</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29"></a><a href="#__codelineno-14-29"><span class="linenos" data-linenos="29 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,464<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30"></a><a href="#__codelineno-14-30"><span class="linenos" data-linenos="30 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,471<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Starting<span class="w"> </span>flush<span class="w"> </span>of<span class="w"> </span>map<span class="w"> </span>output
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31"></a><a href="#__codelineno-14-31"><span class="linenos" data-linenos="31 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,472<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Spilling<span class="w"> </span>map<span class="w"> </span>output
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32"></a><a href="#__codelineno-14-32"><span class="linenos" data-linenos="32 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,472<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">bufstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="nv">bufend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15743</span><span class="p">;</span><span class="w"> </span><span class="nv">bufvoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">104857600</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33"></a><a href="#__codelineno-14-33"><span class="linenos" data-linenos="33 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,472<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">kvstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26214396</span><span class="o">(</span><span class="m">104857584</span><span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">kvend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26210404</span><span class="o">(</span><span class="m">104841616</span><span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3993</span>/6553600
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34"></a><a href="#__codelineno-14-34"><span class="linenos" data-linenos="34 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,489<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Finished<span class="w"> </span>spill<span class="w"> </span><span class="m">0</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35"></a><a href="#__codelineno-14-35"><span class="linenos" data-linenos="35 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,520<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task:attempt_local514940019_0001_m_000000_0<span class="w"> </span>is<span class="w"> </span><span class="k">done</span>.<span class="w"> </span>And<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>process<span class="w"> </span>of<span class="w"> </span>committing
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36"></a><a href="#__codelineno-14-36"><span class="linenos" data-linenos="36 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,524<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>hdfs://bda-iesgrancapitan:9000/bda/mapreduce/ejercicios/Ventas_Enero23.csv:0+123637
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37"></a><a href="#__codelineno-14-37"><span class="linenos" data-linenos="37 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,524<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task<span class="w"> </span><span class="s1">&#39;attempt_local514940019_0001_m_000000_0&#39;</span><span class="w"> </span><span class="k">done</span>.
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38"></a><a href="#__codelineno-14-38"><span class="linenos" data-linenos="38 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,530<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Final<span class="w"> </span>Counters<span class="w"> </span><span class="k">for</span><span class="w"> </span>attempt_local514940019_0001_m_000000_0:<span class="w"> </span>Counters:<span class="w"> </span><span class="m">23</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39"></a><a href="#__codelineno-14-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">    </span>File<span class="w"> </span>System<span class="w"> </span>Counters
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40"></a><a href="#__codelineno-14-40"><span class="linenos" data-linenos="40 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">3122</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41"></a><a href="#__codelineno-14-41"><span class="linenos" data-linenos="41 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">657555</span>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42"></a><a href="#__codelineno-14-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43"></a><a href="#__codelineno-14-43"><span class="linenos" data-linenos="43 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44"></a><a href="#__codelineno-14-44"><span class="linenos" data-linenos="44 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45"></a><a href="#__codelineno-14-45"><span class="linenos" data-linenos="45 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">123637</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46"></a><a href="#__codelineno-14-46"><span class="linenos" data-linenos="46 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47"></a><a href="#__codelineno-14-47"><span class="linenos" data-linenos="47 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48"></a><a href="#__codelineno-14-48"><span class="linenos" data-linenos="48 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49"></a><a href="#__codelineno-14-49"><span class="linenos" data-linenos="49 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50"></a><a href="#__codelineno-14-50"><span class="linenos" data-linenos="50 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nb">read</span><span class="w"> </span>erasure-coded<span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51"></a><a href="#__codelineno-14-51"><span class="linenos" data-linenos="51 "></span></a><span class="w">    </span>Map-Reduce<span class="w"> </span>Framework
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52"></a><a href="#__codelineno-14-52"><span class="linenos" data-linenos="52 "></span></a><span class="w">        </span>Map<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">999</span>
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53"></a><a href="#__codelineno-14-53"><span class="linenos" data-linenos="53 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">999</span>
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54"></a><a href="#__codelineno-14-54"><span class="linenos" data-linenos="54 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">15743</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55"></a><a href="#__codelineno-14-55"><span class="linenos" data-linenos="55 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span>materialized<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">17747</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56"></a><a href="#__codelineno-14-56"><span class="linenos" data-linenos="56 "></span></a><span class="w">        </span>Input<span class="w"> </span>split<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">126</span>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57"></a><a href="#__codelineno-14-57"><span class="linenos" data-linenos="57 "></span></a><span class="w">        </span>Combine<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58"></a><a href="#__codelineno-14-58"><span class="linenos" data-linenos="58 "></span></a><span class="w">        </span>Spilled<span class="w"> </span><span class="nv">Records</span><span class="o">=</span><span class="m">999</span>
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59"></a><a href="#__codelineno-14-59"><span class="linenos" data-linenos="59 "></span></a><span class="w">        </span>Failed<span class="w"> </span><span class="nv">Shuffles</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60"></a><a href="#__codelineno-14-60"><span class="linenos" data-linenos="60 "></span></a><span class="w">        </span>Merged<span class="w"> </span>Map<span class="w"> </span><span class="nv">outputs</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61"></a><a href="#__codelineno-14-61"><span class="linenos" data-linenos="61 "></span></a><span class="w">        </span>GC<span class="w"> </span><span class="nb">time</span><span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span>ms<span class="o">)=</span><span class="m">22</span>
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62"></a><a href="#__codelineno-14-62"><span class="linenos" data-linenos="62 "></span></a><span class="w">        </span>Total<span class="w"> </span>committed<span class="w"> </span>heap<span class="w"> </span>usage<span class="w"> </span><span class="o">(</span>bytes<span class="o">)=</span><span class="m">167841792</span>
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63"></a><a href="#__codelineno-14-63"><span class="linenos" data-linenos="63 "></span></a><span class="w">    </span>File<span class="w"> </span>Input<span class="w"> </span>Format<span class="w"> </span>Counters<span class="w"> </span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64"></a><a href="#__codelineno-14-64"><span class="linenos" data-linenos="64 "></span></a><span class="w">        </span>Bytes<span class="w"> </span><span class="nv">Read</span><span class="o">=</span><span class="m">123637</span>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65"></a><a href="#__codelineno-14-65"><span class="linenos" data-linenos="65 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,530<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Finishing<span class="w"> </span>task:<span class="w"> </span>attempt_local514940019_0001_m_000000_0
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66"></a><a href="#__codelineno-14-66"><span class="linenos" data-linenos="66 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,530<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>map<span class="w"> </span>task<span class="w"> </span>executor<span class="w"> </span>complete.
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67"></a><a href="#__codelineno-14-67"><span class="linenos" data-linenos="67 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,553<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>reduce<span class="w"> </span>tasks
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68"></a><a href="#__codelineno-14-68"><span class="linenos" data-linenos="68 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,553<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Starting<span class="w"> </span>task:<span class="w"> </span>attempt_local514940019_0001_r_000000_0
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69"></a><a href="#__codelineno-14-69"><span class="linenos" data-linenos="69 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:47:26,558<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span></code></pre></div>
<ol start="9">
<li>Vemos el fichero resultante y comprobamos si hemos obtenido los datos que teníamos como objetivo</li>
</ol>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-cat<span class="w"> </span>/bda/mapreduce/ejercicios/salida_ventas/part-00000
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos=" 1 "></span></a>Argentina<span class="w">   </span><span class="m">1</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a><a href="#__codelineno-16-2"><span class="linenos" data-linenos=" 2 "></span></a>Australia<span class="w">   </span><span class="m">38</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><a href="#__codelineno-16-3"><span class="linenos" data-linenos=" 3 "></span></a>Austria<span class="w"> </span><span class="m">7</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><a href="#__codelineno-16-4"><span class="linenos" data-linenos=" 4 "></span></a>Bahrain<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><a href="#__codelineno-16-5"><span class="linenos" data-linenos=" 5 "></span></a>Belgium<span class="w"> </span><span class="m">8</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><a href="#__codelineno-16-6"><span class="linenos" data-linenos=" 6 "></span></a>Bermuda<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><a href="#__codelineno-16-7"><span class="linenos" data-linenos=" 7 "></span></a>Brazil<span class="w">  </span><span class="m">5</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><a href="#__codelineno-16-8"><span class="linenos" data-linenos=" 8 "></span></a>Bulgaria<span class="w">    </span><span class="m">1</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><a href="#__codelineno-16-9"><span class="linenos" data-linenos=" 9 "></span></a>CO<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><a href="#__codelineno-16-10"><span class="linenos" data-linenos="10 "></span></a>Canada<span class="w">  </span><span class="m">76</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><a href="#__codelineno-16-11"><span class="linenos" data-linenos="11 "></span></a>Cayman<span class="w"> </span>Isls<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><a href="#__codelineno-16-12"><span class="linenos" data-linenos="12 "></span></a>China<span class="w">   </span><span class="m">1</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><a href="#__codelineno-16-13"><span class="linenos" data-linenos="13 "></span></a>Costa<span class="w"> </span>Rica<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><a href="#__codelineno-16-14"><span class="linenos" data-linenos="14 "></span></a>Country<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><a href="#__codelineno-16-15"><span class="linenos" data-linenos="15 "></span></a>Czech<span class="w"> </span>Republic<span class="w">  </span><span class="m">3</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><a href="#__codelineno-16-16"><span class="linenos" data-linenos="16 "></span></a>Denmark<span class="w"> </span><span class="m">15</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><a href="#__codelineno-16-17"><span class="linenos" data-linenos="17 "></span></a>Dominican<span class="w"> </span>Republic<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><a href="#__codelineno-16-18"><span class="linenos" data-linenos="18 "></span></a>Finland<span class="w"> </span><span class="m">2</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><a href="#__codelineno-16-19"><span class="linenos" data-linenos="19 "></span></a>France<span class="w">  </span><span class="m">27</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a><a href="#__codelineno-16-20"><span class="linenos" data-linenos="20 "></span></a>Germany<span class="w"> </span><span class="m">25</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><a href="#__codelineno-16-21"><span class="linenos" data-linenos="21 "></span></a>Greece<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><a href="#__codelineno-16-22"><span class="linenos" data-linenos="22 "></span></a>Guatemala<span class="w">   </span><span class="m">1</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a><a href="#__codelineno-16-23"><span class="linenos" data-linenos="23 "></span></a>Hong<span class="w"> </span>Kong<span class="w">   </span><span class="m">1</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a><a href="#__codelineno-16-24"><span class="linenos" data-linenos="24 "></span></a>Hungary<span class="w"> </span><span class="m">3</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><a href="#__codelineno-16-25"><span class="linenos" data-linenos="25 "></span></a>Iceland<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a><a href="#__codelineno-16-26"><span class="linenos" data-linenos="26 "></span></a>India<span class="w">   </span><span class="m">2</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><a href="#__codelineno-16-27"><span class="linenos" data-linenos="27 "></span></a>Ireland<span class="w"> </span><span class="m">49</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a><a href="#__codelineno-16-28"><span class="linenos" data-linenos="28 "></span></a>Israel<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a><a href="#__codelineno-16-29"><span class="linenos" data-linenos="29 "></span></a>Italy<span class="w">   </span><span class="m">15</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a><a href="#__codelineno-16-30"><span class="linenos" data-linenos="30 "></span></a>Japan<span class="w">   </span><span class="m">2</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><a href="#__codelineno-16-31"><span class="linenos" data-linenos="31 "></span></a>Jersey<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32"></a><a href="#__codelineno-16-32"><span class="linenos" data-linenos="32 "></span></a>Kuwait<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33"></a><a href="#__codelineno-16-33"><span class="linenos" data-linenos="33 "></span></a>Latvia<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34"></a><a href="#__codelineno-16-34"><span class="linenos" data-linenos="34 "></span></a>Luxembourg<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35"></a><a href="#__codelineno-16-35"><span class="linenos" data-linenos="35 "></span></a>Malaysia<span class="w">    </span><span class="m">1</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36"></a><a href="#__codelineno-16-36"><span class="linenos" data-linenos="36 "></span></a>Malta<span class="w">   </span><span class="m">2</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37"></a><a href="#__codelineno-16-37"><span class="linenos" data-linenos="37 "></span></a>Mauritius<span class="w">   </span><span class="m">1</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38"></a><a href="#__codelineno-16-38"><span class="linenos" data-linenos="38 "></span></a>Moldova<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39"></a><a href="#__codelineno-16-39"><span class="linenos" data-linenos="39 "></span></a>Monaco<span class="w">  </span><span class="m">2</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40"></a><a href="#__codelineno-16-40"><span class="linenos" data-linenos="40 "></span></a>Netherlands<span class="w"> </span><span class="m">22</span>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41"></a><a href="#__codelineno-16-41"><span class="linenos" data-linenos="41 "></span></a>New<span class="w"> </span>Zealand<span class="w"> </span><span class="m">6</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42"></a><a href="#__codelineno-16-42"><span class="linenos" data-linenos="42 "></span></a>Norway<span class="w">  </span><span class="m">16</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43"></a><a href="#__codelineno-16-43"><span class="linenos" data-linenos="43 "></span></a>Philippines<span class="w"> </span><span class="m">2</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44"></a><a href="#__codelineno-16-44"><span class="linenos" data-linenos="44 "></span></a>Poland<span class="w">  </span><span class="m">2</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45"></a><a href="#__codelineno-16-45"><span class="linenos" data-linenos="45 "></span></a>Romania<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46"></a><a href="#__codelineno-16-46"><span class="linenos" data-linenos="46 "></span></a>Russia<span class="w">  </span><span class="m">1</span>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47"></a><a href="#__codelineno-16-47"><span class="linenos" data-linenos="47 "></span></a>South<span class="w"> </span>Africa<span class="w">    </span><span class="m">5</span>
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48"></a><a href="#__codelineno-16-48"><span class="linenos" data-linenos="48 "></span></a>South<span class="w"> </span>Korea<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49"></a><a href="#__codelineno-16-49"><span class="linenos" data-linenos="49 "></span></a>Spain<span class="w">   </span><span class="m">12</span>
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50"></a><a href="#__codelineno-16-50"><span class="linenos" data-linenos="50 "></span></a>Sweden<span class="w">  </span><span class="m">13</span>
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51"></a><a href="#__codelineno-16-51"><span class="linenos" data-linenos="51 "></span></a>Switzerland<span class="w"> </span><span class="m">36</span>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52"></a><a href="#__codelineno-16-52"><span class="linenos" data-linenos="52 "></span></a>Thailand<span class="w">    </span><span class="m">2</span>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53"></a><a href="#__codelineno-16-53"><span class="linenos" data-linenos="53 "></span></a>The<span class="w"> </span>Bahamas<span class="w"> </span><span class="m">2</span>
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54"></a><a href="#__codelineno-16-54"><span class="linenos" data-linenos="54 "></span></a>Turkey<span class="w">  </span><span class="m">6</span>
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55"></a><a href="#__codelineno-16-55"><span class="linenos" data-linenos="55 "></span></a>Ukraine<span class="w"> </span><span class="m">1</span>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56"></a><a href="#__codelineno-16-56"><span class="linenos" data-linenos="56 "></span></a>United<span class="w"> </span>Arab<span class="w"> </span>Emirates<span class="w">    </span><span class="m">6</span>
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57"></a><a href="#__codelineno-16-57"><span class="linenos" data-linenos="57 "></span></a>United<span class="w"> </span>Kingdom<span class="w">  </span><span class="m">100</span>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58"></a><a href="#__codelineno-16-58"><span class="linenos" data-linenos="58 "></span></a>United<span class="w"> </span>States<span class="w">   </span><span class="m">462</span>
</span></code></pre></div></p>
<h3 id="52-ejercicio-2">5.2 Ejercicio 2<a class="headerlink" href="#52-ejercicio-2" title="Permanent link">&para;</a></h3>
<p>Vamos a realizar un ejercicio de ejemplo de uso de MapReduce. En este caso vamos a usar una de las aplicaciones que ya vienen dentro de MapReduce, que es el contador de palabras</p>
<ol>
<li>Primero descargamos un fichero en local de este gist alojado en github. En este caso vamos a contar las palabras de "<strong>El quijote</strong>".</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos="1 "></span></a>wget<span class="w"> </span>https://gist.githubusercontent.com/jaimerabasco/cb528c32b4c4092e6a0763d8b6bc25c0/raw/54b30a89f3b608d0837bd1fc10bc31e64ba4c7c8/El_Quijote.txt
</span></code></pre></div>
<ol start="2">
<li>Crea en HDFS la carpeta donde vas a alojar el fichero</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a>//<span class="w"> </span>No<span class="w"> </span>es<span class="w"> </span>necesario<span class="w"> </span>si<span class="w"> </span>ya<span class="w"> </span>los<span class="w"> </span>has<span class="w"> </span>creado<span class="w"> </span>en<span class="w"> </span>el<span class="w"> </span>ejercicio<span class="w"> </span>anterior<span class="w"> </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos="2 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/bda/mapreduce
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos="3 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/bda/mapreduce/ejercicios
</span></code></pre></div>
<ol start="3">
<li>Copia el fichero del "El quijote" a HDFS</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-copyFromLocal<span class="w"> </span>El_Quijote.txt<span class="w"> </span>/bda/mapreduce/ejercicios
</span></code></pre></div>
<ol start="4">
<li>Listamos la lista de ejemplos que nos dispone MapReduce</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a>hadoop<span class="w"> </span>jar<span class="w"> </span><span class="nv">$HADOOP_HOME</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.6.jar
</span></code></pre></div>
<ol start="5">
<li>Vemos muchos de ellos. Para este ejercicio nos interesa <strong><em>wordcount</em></strong></li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos=" 1 "></span></a>An example program must be given as the first argument.
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><a href="#__codelineno-21-2"><span class="linenos" data-linenos=" 2 "></span></a>Valid program names are:
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a><a href="#__codelineno-21-3"><span class="linenos" data-linenos=" 3 "></span></a>  aggregatewordcount: An Aggregate based map/reduce program that counts the words in the input files.
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a><a href="#__codelineno-21-4"><span class="linenos" data-linenos=" 4 "></span></a>  aggregatewordhist: An Aggregate based map/reduce program that computes the histogram of the words in the input files.
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a><a href="#__codelineno-21-5"><span class="linenos" data-linenos=" 5 "></span></a>  bbp: A map/reduce program that uses Bailey-Borwein-Plouffe to compute exact digits of Pi.
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6"></a><a href="#__codelineno-21-6"><span class="linenos" data-linenos=" 6 "></span></a>  dbcount: An example job that count the pageview counts from a database.
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7"></a><a href="#__codelineno-21-7"><span class="linenos" data-linenos=" 7 "></span></a>  distbbp: A map/reduce program that uses a BBP-type formula to compute exact bits of Pi.
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8"></a><a href="#__codelineno-21-8"><span class="linenos" data-linenos=" 8 "></span></a>  grep: A map/reduce program that counts the matches of a regex in the input.
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9"></a><a href="#__codelineno-21-9"><span class="linenos" data-linenos=" 9 "></span></a>  join: A job that effects a join over sorted, equally partitioned datasets
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10"></a><a href="#__codelineno-21-10"><span class="linenos" data-linenos="10 "></span></a>  multifilewc: A job that counts words from several files.
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11"></a><a href="#__codelineno-21-11"><span class="linenos" data-linenos="11 "></span></a>  pentomino: A map/reduce tile laying program to find solutions to pentomino problems.
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12"></a><a href="#__codelineno-21-12"><span class="linenos" data-linenos="12 "></span></a>  pi: A map/reduce program that estimates Pi using a quasi-Monte Carlo method.
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13"></a><a href="#__codelineno-21-13"><span class="linenos" data-linenos="13 "></span></a>  randomtextwriter: A map/reduce program that writes 10GB of random textual data per node.
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14"></a><a href="#__codelineno-21-14"><span class="linenos" data-linenos="14 "></span></a>  randomwriter: A map/reduce program that writes 10GB of random data per node.
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15"></a><a href="#__codelineno-21-15"><span class="linenos" data-linenos="15 "></span></a>  secondarysort: An example defining a secondary sort to the reduce.
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16"></a><a href="#__codelineno-21-16"><span class="linenos" data-linenos="16 "></span></a>  sort: A map/reduce program that sorts the data written by the random writer.
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17"></a><a href="#__codelineno-21-17"><span class="linenos" data-linenos="17 "></span></a>  sudoku: A sudoku solver.
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18"></a><a href="#__codelineno-21-18"><span class="linenos" data-linenos="18 "></span></a>  teragen: Generate data for the terasort
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19"></a><a href="#__codelineno-21-19"><span class="linenos" data-linenos="19 "></span></a>  terasort: Run the terasort
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20"></a><a href="#__codelineno-21-20"><span class="linenos" data-linenos="20 "></span></a>  teravalidate: Checking results of terasort
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21"></a><a href="#__codelineno-21-21"><span class="linenos" data-linenos="21 "></span></a>  wordcount: A map/reduce program that counts the words in the input files.
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22"></a><a href="#__codelineno-21-22"><span class="linenos" data-linenos="22 "></span></a>  wordmean: A map/reduce program that counts the average length of the words in the input files.
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23"></a><a href="#__codelineno-21-23"><span class="linenos" data-linenos="23 "></span></a>  wordmedian: A map/reduce program that counts the median length of the words in the input files.
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24"></a><a href="#__codelineno-21-24"><span class="linenos" data-linenos="24 "></span></a>  wordstandarddeviation: A map/reduce program that counts the standard deviation of the length of the words in the input files.
</span></code></pre></div>
<ol start="7">
<li>Vemos los parámetros que necesitamos para wordcount</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos="1 "></span></a>hadoop<span class="w"> </span>jar<span class="w"> </span><span class="nv">$HADOOP_HOME</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.6.jar<span class="w"> </span>wordcount
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos="2 "></span></a>Usage:<span class="w"> </span>wordcount<span class="w"> </span>&lt;<span class="k">in</span>&gt;<span class="w"> </span><span class="o">[</span>&lt;<span class="k">in</span>&gt;...<span class="o">]</span><span class="w"> </span>&lt;out&gt;
</span></code></pre></div>
<ol start="8">
<li>Ejecuta el ejemplo de contar palabras sobre el "El quijote". Hay que indicar el fichero de entrada y de salida</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos="1 "></span></a>hadoop<span class="w"> </span>jar<span class="w"> </span><span class="nv">$HADOOP_HOME</span>/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.6.jar<span class="w"> </span>wordcount<span class="w"> </span>/bda/mapreduce/ejercicios/El_Quijote.txt<span class="w"> </span>/bda/mapreduce/ejercicios/salida_quijote
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos="  1 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:30,696<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsConfig:<span class="w"> </span>Loaded<span class="w"> </span>properties<span class="w"> </span>from<span class="w"> </span>hadoop-metrics2.properties
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><a href="#__codelineno-24-2"><span class="linenos" data-linenos="  2 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:30,801<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>Scheduled<span class="w"> </span>Metric<span class="w"> </span>snapshot<span class="w"> </span>period<span class="w"> </span>at<span class="w"> </span><span class="m">10</span><span class="w"> </span>second<span class="o">(</span>s<span class="o">)</span>.
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a><a href="#__codelineno-24-3"><span class="linenos" data-linenos="  3 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:30,801<span class="w"> </span>INFO<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>JobTracker<span class="w"> </span>metrics<span class="w"> </span>system<span class="w"> </span>started
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a><a href="#__codelineno-24-4"><span class="linenos" data-linenos="  4 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,074<span class="w"> </span>INFO<span class="w"> </span>input.FileInputFormat:<span class="w"> </span>Total<span class="w"> </span>input<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>process<span class="w"> </span>:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><a href="#__codelineno-24-5"><span class="linenos" data-linenos="  5 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,149<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>splits:1
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a><a href="#__codelineno-24-6"><span class="linenos" data-linenos="  6 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,314<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>Submitting<span class="w"> </span>tokens<span class="w"> </span><span class="k">for</span><span class="w"> </span>job:<span class="w"> </span>job_local498821156_0001
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a><a href="#__codelineno-24-7"><span class="linenos" data-linenos="  7 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,315<span class="w"> </span>INFO<span class="w"> </span>mapreduce.JobSubmitter:<span class="w"> </span>Executing<span class="w"> </span>with<span class="w"> </span>tokens:<span class="w"> </span><span class="o">[]</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a><a href="#__codelineno-24-8"><span class="linenos" data-linenos="  8 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,470<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>The<span class="w"> </span>url<span class="w"> </span>to<span class="w"> </span>track<span class="w"> </span>the<span class="w"> </span>job:<span class="w"> </span>http://localhost:8080/
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a><a href="#__codelineno-24-9"><span class="linenos" data-linenos="  9 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,471<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>Running<span class="w"> </span>job:<span class="w"> </span>job_local498821156_0001
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a><a href="#__codelineno-24-10"><span class="linenos" data-linenos=" 10 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,473<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>OutputCommitter<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>config<span class="w"> </span>null
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a><a href="#__codelineno-24-11"><span class="linenos" data-linenos=" 11 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,477<span class="w"> </span>INFO<span class="w"> </span>output.PathOutputCommitterFactory:<span class="w"> </span>No<span class="w"> </span>output<span class="w"> </span>committer<span class="w"> </span>factory<span class="w"> </span>defined,<span class="w"> </span>defaulting<span class="w"> </span>to<span class="w"> </span>FileOutputCommitterFactory
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a><a href="#__codelineno-24-12"><span class="linenos" data-linenos=" 12 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,478<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13"></a><a href="#__codelineno-24-13"><span class="linenos" data-linenos=" 13 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,478<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>FileOutputCommitter<span class="w"> </span>skip<span class="w"> </span>cleanup<span class="w"> </span>_temporary<span class="w"> </span>folders<span class="w"> </span>under<span class="w"> </span>output<span class="w"> </span>directory:false,<span class="w"> </span>ignore<span class="w"> </span>cleanup<span class="w"> </span>failures:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14"></a><a href="#__codelineno-24-14"><span class="linenos" data-linenos=" 14 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,478<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>OutputCommitter<span class="w"> </span>is<span class="w"> </span>org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15"></a><a href="#__codelineno-24-15"><span class="linenos" data-linenos=" 15 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,601<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>map<span class="w"> </span>tasks
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16"></a><a href="#__codelineno-24-16"><span class="linenos" data-linenos=" 16 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,602<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Starting<span class="w"> </span>task:<span class="w"> </span>attempt_local498821156_0001_m_000000_0
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17"></a><a href="#__codelineno-24-17"><span class="linenos" data-linenos=" 17 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,615<span class="w"> </span>INFO<span class="w"> </span>output.PathOutputCommitterFactory:<span class="w"> </span>No<span class="w"> </span>output<span class="w"> </span>committer<span class="w"> </span>factory<span class="w"> </span>defined,<span class="w"> </span>defaulting<span class="w"> </span>to<span class="w"> </span>FileOutputCommitterFactory
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18"></a><a href="#__codelineno-24-18"><span class="linenos" data-linenos=" 18 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,617<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19"></a><a href="#__codelineno-24-19"><span class="linenos" data-linenos=" 19 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,617<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>FileOutputCommitter<span class="w"> </span>skip<span class="w"> </span>cleanup<span class="w"> </span>_temporary<span class="w"> </span>folders<span class="w"> </span>under<span class="w"> </span>output<span class="w"> </span>directory:false,<span class="w"> </span>ignore<span class="w"> </span>cleanup<span class="w"> </span>failures:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20"></a><a href="#__codelineno-24-20"><span class="linenos" data-linenos=" 20 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,651<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w">  </span>Using<span class="w"> </span>ResourceCalculatorProcessTree<span class="w"> </span>:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">]</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21"></a><a href="#__codelineno-24-21"><span class="linenos" data-linenos=" 21 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,657<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Processing<span class="w"> </span>split:<span class="w"> </span>hdfs://bda-iesgrancapitan:9000/bda/mapreduce/ejercicios/El_Quijote.txt:0+2161175
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22"></a><a href="#__codelineno-24-22"><span class="linenos" data-linenos=" 22 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,741<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="o">(</span>EQUATOR<span class="o">)</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>kvi<span class="w"> </span><span class="m">26214396</span><span class="o">(</span><span class="m">104857584</span><span class="o">)</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23"></a><a href="#__codelineno-24-23"><span class="linenos" data-linenos=" 23 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,741<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>mapreduce.task.io.sort.mb:<span class="w"> </span><span class="m">100</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24"></a><a href="#__codelineno-24-24"><span class="linenos" data-linenos=" 24 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,741<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>soft<span class="w"> </span>limit<span class="w"> </span>at<span class="w"> </span><span class="m">83886080</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25"></a><a href="#__codelineno-24-25"><span class="linenos" data-linenos=" 25 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,741<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">bufstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="nv">bufvoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">104857600</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26"></a><a href="#__codelineno-24-26"><span class="linenos" data-linenos=" 26 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,741<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">kvstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26214396</span><span class="p">;</span><span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6553600</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27"></a><a href="#__codelineno-24-27"><span class="linenos" data-linenos=" 27 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:31,745<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Map<span class="w"> </span>output<span class="w"> </span>collector<span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>org.apache.hadoop.mapred.MapTask<span class="nv">$MapOutputBuffer</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28"></a><a href="#__codelineno-24-28"><span class="linenos" data-linenos=" 28 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,166<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29"></a><a href="#__codelineno-24-29"><span class="linenos" data-linenos=" 29 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,182<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Starting<span class="w"> </span>flush<span class="w"> </span>of<span class="w"> </span>map<span class="w"> </span>output
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30"></a><a href="#__codelineno-24-30"><span class="linenos" data-linenos=" 30 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,182<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Spilling<span class="w"> </span>map<span class="w"> </span>output
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31"></a><a href="#__codelineno-24-31"><span class="linenos" data-linenos=" 31 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,183<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">bufstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="nv">bufend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3688770</span><span class="p">;</span><span class="w"> </span><span class="nv">bufvoid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">104857600</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32"></a><a href="#__codelineno-24-32"><span class="linenos" data-linenos=" 32 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,183<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span><span class="nv">kvstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26214396</span><span class="o">(</span><span class="m">104857584</span><span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">kvend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24677300</span><span class="o">(</span><span class="m">98709200</span><span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1537097</span>/6553600
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33"></a><a href="#__codelineno-24-33"><span class="linenos" data-linenos=" 33 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,488<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>Job<span class="w"> </span>job_local498821156_0001<span class="w"> </span>running<span class="w"> </span><span class="k">in</span><span class="w"> </span>uber<span class="w"> </span>mode<span class="w"> </span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34"></a><a href="#__codelineno-24-34"><span class="linenos" data-linenos=" 34 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,488<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w">  </span>map<span class="w"> </span><span class="m">0</span>%<span class="w"> </span>reduce<span class="w"> </span><span class="m">0</span>%
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35"></a><a href="#__codelineno-24-35"><span class="linenos" data-linenos=" 35 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,803<span class="w"> </span>INFO<span class="w"> </span>mapred.MapTask:<span class="w"> </span>Finished<span class="w"> </span>spill<span class="w"> </span><span class="m">0</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36"></a><a href="#__codelineno-24-36"><span class="linenos" data-linenos=" 36 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,823<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task:attempt_local498821156_0001_m_000000_0<span class="w"> </span>is<span class="w"> </span><span class="k">done</span>.<span class="w"> </span>And<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>process<span class="w"> </span>of<span class="w"> </span>committing
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37"></a><a href="#__codelineno-24-37"><span class="linenos" data-linenos=" 37 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,825<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>map
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38"></a><a href="#__codelineno-24-38"><span class="linenos" data-linenos=" 38 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,826<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task<span class="w"> </span><span class="s1">&#39;attempt_local498821156_0001_m_000000_0&#39;</span><span class="w"> </span><span class="k">done</span>.
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39"></a><a href="#__codelineno-24-39"><span class="linenos" data-linenos=" 39 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,830<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Final<span class="w"> </span>Counters<span class="w"> </span><span class="k">for</span><span class="w"> </span>attempt_local498821156_0001_m_000000_0:<span class="w"> </span>Counters:<span class="w"> </span><span class="m">24</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40"></a><a href="#__codelineno-24-40"><span class="linenos" data-linenos=" 40 "></span></a><span class="w">    </span>File<span class="w"> </span>System<span class="w"> </span>Counters
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41"></a><a href="#__codelineno-24-41"><span class="linenos" data-linenos=" 41 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">281548</span>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42"></a><a href="#__codelineno-24-42"><span class="linenos" data-linenos=" 42 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">1526135</span>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43"></a><a href="#__codelineno-24-43"><span class="linenos" data-linenos=" 43 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44"></a><a href="#__codelineno-24-44"><span class="linenos" data-linenos=" 44 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-45"><a id="__codelineno-24-45" name="__codelineno-24-45"></a><a href="#__codelineno-24-45"><span class="linenos" data-linenos=" 45 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-46"><a id="__codelineno-24-46" name="__codelineno-24-46"></a><a href="#__codelineno-24-46"><span class="linenos" data-linenos=" 46 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">2161175</span>
</span><span id="__span-24-47"><a id="__codelineno-24-47" name="__codelineno-24-47"></a><a href="#__codelineno-24-47"><span class="linenos" data-linenos=" 47 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-48"><a id="__codelineno-24-48" name="__codelineno-24-48"></a><a href="#__codelineno-24-48"><span class="linenos" data-linenos=" 48 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-24-49"><a id="__codelineno-24-49" name="__codelineno-24-49"></a><a href="#__codelineno-24-49"><span class="linenos" data-linenos=" 49 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-50"><a id="__codelineno-24-50" name="__codelineno-24-50"></a><a href="#__codelineno-24-50"><span class="linenos" data-linenos=" 50 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-24-51"><a id="__codelineno-24-51" name="__codelineno-24-51"></a><a href="#__codelineno-24-51"><span class="linenos" data-linenos=" 51 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nb">read</span><span class="w"> </span>erasure-coded<span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-52"><a id="__codelineno-24-52" name="__codelineno-24-52"></a><a href="#__codelineno-24-52"><span class="linenos" data-linenos=" 52 "></span></a><span class="w">    </span>Map-Reduce<span class="w"> </span>Framework
</span><span id="__span-24-53"><a id="__codelineno-24-53" name="__codelineno-24-53"></a><a href="#__codelineno-24-53"><span class="linenos" data-linenos=" 53 "></span></a><span class="w">        </span>Map<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">37863</span>
</span><span id="__span-24-54"><a id="__codelineno-24-54" name="__codelineno-24-54"></a><a href="#__codelineno-24-54"><span class="linenos" data-linenos=" 54 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">384275</span>
</span><span id="__span-24-55"><a id="__codelineno-24-55" name="__codelineno-24-55"></a><a href="#__codelineno-24-55"><span class="linenos" data-linenos=" 55 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">3688770</span>
</span><span id="__span-24-56"><a id="__codelineno-24-56" name="__codelineno-24-56"></a><a href="#__codelineno-24-56"><span class="linenos" data-linenos=" 56 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span>materialized<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">605631</span>
</span><span id="__span-24-57"><a id="__codelineno-24-57" name="__codelineno-24-57"></a><a href="#__codelineno-24-57"><span class="linenos" data-linenos=" 57 "></span></a><span class="w">        </span>Input<span class="w"> </span>split<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">135</span>
</span><span id="__span-24-58"><a id="__codelineno-24-58" name="__codelineno-24-58"></a><a href="#__codelineno-24-58"><span class="linenos" data-linenos=" 58 "></span></a><span class="w">        </span>Combine<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">384275</span>
</span><span id="__span-24-59"><a id="__codelineno-24-59" name="__codelineno-24-59"></a><a href="#__codelineno-24-59"><span class="linenos" data-linenos=" 59 "></span></a><span class="w">        </span>Combine<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-60"><a id="__codelineno-24-60" name="__codelineno-24-60"></a><a href="#__codelineno-24-60"><span class="linenos" data-linenos=" 60 "></span></a><span class="w">        </span>Spilled<span class="w"> </span><span class="nv">Records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-61"><a id="__codelineno-24-61" name="__codelineno-24-61"></a><a href="#__codelineno-24-61"><span class="linenos" data-linenos=" 61 "></span></a><span class="w">        </span>Failed<span class="w"> </span><span class="nv">Shuffles</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-62"><a id="__codelineno-24-62" name="__codelineno-24-62"></a><a href="#__codelineno-24-62"><span class="linenos" data-linenos=" 62 "></span></a><span class="w">        </span>Merged<span class="w"> </span>Map<span class="w"> </span><span class="nv">outputs</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-63"><a id="__codelineno-24-63" name="__codelineno-24-63"></a><a href="#__codelineno-24-63"><span class="linenos" data-linenos=" 63 "></span></a><span class="w">        </span>GC<span class="w"> </span><span class="nb">time</span><span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span>ms<span class="o">)=</span><span class="m">31</span>
</span><span id="__span-24-64"><a id="__codelineno-24-64" name="__codelineno-24-64"></a><a href="#__codelineno-24-64"><span class="linenos" data-linenos=" 64 "></span></a><span class="w">        </span>Total<span class="w"> </span>committed<span class="w"> </span>heap<span class="w"> </span>usage<span class="w"> </span><span class="o">(</span>bytes<span class="o">)=</span><span class="m">167841792</span>
</span><span id="__span-24-65"><a id="__codelineno-24-65" name="__codelineno-24-65"></a><a href="#__codelineno-24-65"><span class="linenos" data-linenos=" 65 "></span></a><span class="w">    </span>File<span class="w"> </span>Input<span class="w"> </span>Format<span class="w"> </span>Counters<span class="w"> </span>
</span><span id="__span-24-66"><a id="__codelineno-24-66" name="__codelineno-24-66"></a><a href="#__codelineno-24-66"><span class="linenos" data-linenos=" 66 "></span></a><span class="w">        </span>Bytes<span class="w"> </span><span class="nv">Read</span><span class="o">=</span><span class="m">2161175</span>
</span><span id="__span-24-67"><a id="__codelineno-24-67" name="__codelineno-24-67"></a><a href="#__codelineno-24-67"><span class="linenos" data-linenos=" 67 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,831<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Finishing<span class="w"> </span>task:<span class="w"> </span>attempt_local498821156_0001_m_000000_0
</span><span id="__span-24-68"><a id="__codelineno-24-68" name="__codelineno-24-68"></a><a href="#__codelineno-24-68"><span class="linenos" data-linenos=" 68 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,832<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>map<span class="w"> </span>task<span class="w"> </span>executor<span class="w"> </span>complete.
</span><span id="__span-24-69"><a id="__codelineno-24-69" name="__codelineno-24-69"></a><a href="#__codelineno-24-69"><span class="linenos" data-linenos=" 69 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,856<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>reduce<span class="w"> </span>tasks
</span><span id="__span-24-70"><a id="__codelineno-24-70" name="__codelineno-24-70"></a><a href="#__codelineno-24-70"><span class="linenos" data-linenos=" 70 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,857<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Starting<span class="w"> </span>task:<span class="w"> </span>attempt_local498821156_0001_r_000000_0
</span><span id="__span-24-71"><a id="__codelineno-24-71" name="__codelineno-24-71"></a><a href="#__codelineno-24-71"><span class="linenos" data-linenos=" 71 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,861<span class="w"> </span>INFO<span class="w"> </span>output.PathOutputCommitterFactory:<span class="w"> </span>No<span class="w"> </span>output<span class="w"> </span>committer<span class="w"> </span>factory<span class="w"> </span>defined,<span class="w"> </span>defaulting<span class="w"> </span>to<span class="w"> </span>FileOutputCommitterFactory
</span><span id="__span-24-72"><a id="__codelineno-24-72" name="__codelineno-24-72"></a><a href="#__codelineno-24-72"><span class="linenos" data-linenos=" 72 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,861<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>File<span class="w"> </span>Output<span class="w"> </span>Committer<span class="w"> </span>Algorithm<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">2</span>
</span><span id="__span-24-73"><a id="__codelineno-24-73" name="__codelineno-24-73"></a><a href="#__codelineno-24-73"><span class="linenos" data-linenos=" 73 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,861<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>FileOutputCommitter<span class="w"> </span>skip<span class="w"> </span>cleanup<span class="w"> </span>_temporary<span class="w"> </span>folders<span class="w"> </span>under<span class="w"> </span>output<span class="w"> </span>directory:false,<span class="w"> </span>ignore<span class="w"> </span>cleanup<span class="w"> </span>failures:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-24-74"><a id="__codelineno-24-74" name="__codelineno-24-74"></a><a href="#__codelineno-24-74"><span class="linenos" data-linenos=" 74 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,861<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w">  </span>Using<span class="w"> </span>ResourceCalculatorProcessTree<span class="w"> </span>:<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="o">]</span>
</span><span id="__span-24-75"><a id="__codelineno-24-75" name="__codelineno-24-75"></a><a href="#__codelineno-24-75"><span class="linenos" data-linenos=" 75 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,867<span class="w"> </span>INFO<span class="w"> </span>mapred.ReduceTask:<span class="w"> </span>Using<span class="w"> </span>ShuffleConsumerPlugin:<span class="w"> </span>org.apache.hadoop.mapreduce.task.reduce.Shuffle@4de8aeff
</span><span id="__span-24-76"><a id="__codelineno-24-76" name="__codelineno-24-76"></a><a href="#__codelineno-24-76"><span class="linenos" data-linenos=" 76 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,872<span class="w"> </span>WARN<span class="w"> </span>impl.MetricsSystemImpl:<span class="w"> </span>JobTracker<span class="w"> </span>metrics<span class="w"> </span>system<span class="w"> </span>already<span class="w"> </span>initialized!
</span><span id="__span-24-77"><a id="__codelineno-24-77" name="__codelineno-24-77"></a><a href="#__codelineno-24-77"><span class="linenos" data-linenos=" 77 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,917<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>MergerManager:<span class="w"> </span><span class="nv">memoryLimit</span><span class="o">=</span><span class="m">693954112</span>,<span class="w"> </span><span class="nv">maxSingleShuffleLimit</span><span class="o">=</span><span class="m">173488528</span>,<span class="w"> </span><span class="nv">mergeThreshold</span><span class="o">=</span><span class="m">458009728</span>,<span class="w"> </span><span class="nv">ioSortFactor</span><span class="o">=</span><span class="m">10</span>,<span class="w"> </span><span class="nv">memToMemMergeOutputsThreshold</span><span class="o">=</span><span class="m">10</span>
</span><span id="__span-24-78"><a id="__codelineno-24-78" name="__codelineno-24-78"></a><a href="#__codelineno-24-78"><span class="linenos" data-linenos=" 78 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,939<span class="w"> </span>INFO<span class="w"> </span>reduce.EventFetcher:<span class="w"> </span>attempt_local498821156_0001_r_000000_0<span class="w"> </span>Thread<span class="w"> </span>started:<span class="w"> </span>EventFetcher<span class="w"> </span><span class="k">for</span><span class="w"> </span>fetching<span class="w"> </span>Map<span class="w"> </span>Completion<span class="w"> </span>Events
</span><span id="__span-24-79"><a id="__codelineno-24-79" name="__codelineno-24-79"></a><a href="#__codelineno-24-79"><span class="linenos" data-linenos=" 79 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,972<span class="w"> </span>INFO<span class="w"> </span>reduce.LocalFetcher:<span class="w"> </span>localfetcher#1<span class="w"> </span>about<span class="w"> </span>to<span class="w"> </span>shuffle<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>map<span class="w"> </span>attempt_local498821156_0001_m_000000_0<span class="w"> </span>decomp:<span class="w"> </span><span class="m">605627</span><span class="w"> </span>len:<span class="w"> </span><span class="m">605631</span><span class="w"> </span>to<span class="w"> </span>MEMORY
</span><span id="__span-24-80"><a id="__codelineno-24-80" name="__codelineno-24-80"></a><a href="#__codelineno-24-80"><span class="linenos" data-linenos=" 80 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,974<span class="w"> </span>INFO<span class="w"> </span>reduce.InMemoryMapOutput:<span class="w"> </span>Read<span class="w"> </span><span class="m">605627</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>map-output<span class="w"> </span><span class="k">for</span><span class="w"> </span>attempt_local498821156_0001_m_000000_0
</span><span id="__span-24-81"><a id="__codelineno-24-81" name="__codelineno-24-81"></a><a href="#__codelineno-24-81"><span class="linenos" data-linenos=" 81 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,975<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>closeInMemoryFile<span class="w"> </span>-&gt;<span class="w"> </span>map-output<span class="w"> </span>of<span class="w"> </span>size:<span class="w"> </span><span class="m">605627</span>,<span class="w"> </span>inMemoryMapOutputs.size<span class="o">()</span><span class="w"> </span>-&gt;<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>commitMemory<span class="w"> </span>-&gt;<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>usedMemory<span class="w"> </span>-&gt;605627
</span><span id="__span-24-82"><a id="__codelineno-24-82" name="__codelineno-24-82"></a><a href="#__codelineno-24-82"><span class="linenos" data-linenos=" 82 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,976<span class="w"> </span>INFO<span class="w"> </span>reduce.EventFetcher:<span class="w"> </span>EventFetcher<span class="w"> </span>is<span class="w"> </span>interrupted..<span class="w"> </span>Returning
</span><span id="__span-24-83"><a id="__codelineno-24-83" name="__codelineno-24-83"></a><a href="#__codelineno-24-83"><span class="linenos" data-linenos=" 83 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,976<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span><span class="m">1</span><span class="w"> </span>/<span class="w"> </span><span class="m">1</span><span class="w"> </span>copied.
</span><span id="__span-24-84"><a id="__codelineno-24-84" name="__codelineno-24-84"></a><a href="#__codelineno-24-84"><span class="linenos" data-linenos=" 84 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,976<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>finalMerge<span class="w"> </span>called<span class="w"> </span>with<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="k">in</span>-memory<span class="w"> </span>map-outputs<span class="w"> </span>and<span class="w"> </span><span class="m">0</span><span class="w"> </span>on-disk<span class="w"> </span>map-outputs
</span><span id="__span-24-85"><a id="__codelineno-24-85" name="__codelineno-24-85"></a><a href="#__codelineno-24-85"><span class="linenos" data-linenos=" 85 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,982<span class="w"> </span>INFO<span class="w"> </span>mapred.Merger:<span class="w"> </span>Merging<span class="w"> </span><span class="m">1</span><span class="w"> </span>sorted<span class="w"> </span>segments
</span><span id="__span-24-86"><a id="__codelineno-24-86" name="__codelineno-24-86"></a><a href="#__codelineno-24-86"><span class="linenos" data-linenos=" 86 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:32,982<span class="w"> </span>INFO<span class="w"> </span>mapred.Merger:<span class="w"> </span>Down<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>last<span class="w"> </span>merge-pass,<span class="w"> </span>with<span class="w"> </span><span class="m">1</span><span class="w"> </span>segments<span class="w"> </span>left<span class="w"> </span>of<span class="w"> </span>total<span class="w"> </span>size:<span class="w"> </span><span class="m">605620</span><span class="w"> </span>bytes
</span><span id="__span-24-87"><a id="__codelineno-24-87" name="__codelineno-24-87"></a><a href="#__codelineno-24-87"><span class="linenos" data-linenos=" 87 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,049<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>Merged<span class="w"> </span><span class="m">1</span><span class="w"> </span>segments,<span class="w"> </span><span class="m">605627</span><span class="w"> </span>bytes<span class="w"> </span>to<span class="w"> </span>disk<span class="w"> </span>to<span class="w"> </span>satisfy<span class="w"> </span>reduce<span class="w"> </span>memory<span class="w"> </span>limit
</span><span id="__span-24-88"><a id="__codelineno-24-88" name="__codelineno-24-88"></a><a href="#__codelineno-24-88"><span class="linenos" data-linenos=" 88 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,049<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>Merging<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span><span class="m">605631</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>disk
</span><span id="__span-24-89"><a id="__codelineno-24-89" name="__codelineno-24-89"></a><a href="#__codelineno-24-89"><span class="linenos" data-linenos=" 89 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,050<span class="w"> </span>INFO<span class="w"> </span>reduce.MergeManagerImpl:<span class="w"> </span>Merging<span class="w"> </span><span class="m">0</span><span class="w"> </span>segments,<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>memory<span class="w"> </span>into<span class="w"> </span>reduce
</span><span id="__span-24-90"><a id="__codelineno-24-90" name="__codelineno-24-90"></a><a href="#__codelineno-24-90"><span class="linenos" data-linenos=" 90 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,050<span class="w"> </span>INFO<span class="w"> </span>mapred.Merger:<span class="w"> </span>Merging<span class="w"> </span><span class="m">1</span><span class="w"> </span>sorted<span class="w"> </span>segments
</span><span id="__span-24-91"><a id="__codelineno-24-91" name="__codelineno-24-91"></a><a href="#__codelineno-24-91"><span class="linenos" data-linenos=" 91 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,050<span class="w"> </span>INFO<span class="w"> </span>mapred.Merger:<span class="w"> </span>Down<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>last<span class="w"> </span>merge-pass,<span class="w"> </span>with<span class="w"> </span><span class="m">1</span><span class="w"> </span>segments<span class="w"> </span>left<span class="w"> </span>of<span class="w"> </span>total<span class="w"> </span>size:<span class="w"> </span><span class="m">605620</span><span class="w"> </span>bytes
</span><span id="__span-24-92"><a id="__codelineno-24-92" name="__codelineno-24-92"></a><a href="#__codelineno-24-92"><span class="linenos" data-linenos=" 92 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,051<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span><span class="m">1</span><span class="w"> </span>/<span class="w"> </span><span class="m">1</span><span class="w"> </span>copied.
</span><span id="__span-24-93"><a id="__codelineno-24-93" name="__codelineno-24-93"></a><a href="#__codelineno-24-93"><span class="linenos" data-linenos=" 93 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,164<span class="w"> </span>INFO<span class="w"> </span>Configuration.deprecation:<span class="w"> </span>mapred.skip.on<span class="w"> </span>is<span class="w"> </span>deprecated.<span class="w"> </span>Instead,<span class="w"> </span>use<span class="w"> </span>mapreduce.job.skiprecords
</span><span id="__span-24-94"><a id="__codelineno-24-94" name="__codelineno-24-94"></a><a href="#__codelineno-24-94"><span class="linenos" data-linenos=" 94 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,463<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task:attempt_local498821156_0001_r_000000_0<span class="w"> </span>is<span class="w"> </span><span class="k">done</span>.<span class="w"> </span>And<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>process<span class="w"> </span>of<span class="w"> </span>committing
</span><span id="__span-24-95"><a id="__codelineno-24-95" name="__codelineno-24-95"></a><a href="#__codelineno-24-95"><span class="linenos" data-linenos=" 95 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,465<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span><span class="m">1</span><span class="w"> </span>/<span class="w"> </span><span class="m">1</span><span class="w"> </span>copied.
</span><span id="__span-24-96"><a id="__codelineno-24-96" name="__codelineno-24-96"></a><a href="#__codelineno-24-96"><span class="linenos" data-linenos=" 96 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,465<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task<span class="w"> </span>attempt_local498821156_0001_r_000000_0<span class="w"> </span>is<span class="w"> </span>allowed<span class="w"> </span>to<span class="w"> </span>commit<span class="w"> </span>now
</span><span id="__span-24-97"><a id="__codelineno-24-97" name="__codelineno-24-97"></a><a href="#__codelineno-24-97"><span class="linenos" data-linenos=" 97 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,490<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w">  </span>map<span class="w"> </span><span class="m">100</span>%<span class="w"> </span>reduce<span class="w"> </span><span class="m">0</span>%
</span><span id="__span-24-98"><a id="__codelineno-24-98" name="__codelineno-24-98"></a><a href="#__codelineno-24-98"><span class="linenos" data-linenos=" 98 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,526<span class="w"> </span>INFO<span class="w"> </span>output.FileOutputCommitter:<span class="w"> </span>Saved<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>task<span class="w"> </span><span class="s1">&#39;attempt_local498821156_0001_r_000000_0&#39;</span><span class="w"> </span>to<span class="w"> </span>hdfs://bda-iesgrancapitan:9000/bda/mapreduce/ejercicios/salida_quijote
</span><span id="__span-24-99"><a id="__codelineno-24-99" name="__codelineno-24-99"></a><a href="#__codelineno-24-99"><span class="linenos" data-linenos=" 99 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,526<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>reduce<span class="w"> </span>&gt;<span class="w"> </span>reduce
</span><span id="__span-24-100"><a id="__codelineno-24-100" name="__codelineno-24-100"></a><a href="#__codelineno-24-100"><span class="linenos" data-linenos="100 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,526<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Task<span class="w"> </span><span class="s1">&#39;attempt_local498821156_0001_r_000000_0&#39;</span><span class="w"> </span><span class="k">done</span>.
</span><span id="__span-24-101"><a id="__codelineno-24-101" name="__codelineno-24-101"></a><a href="#__codelineno-24-101"><span class="linenos" data-linenos="101 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,527<span class="w"> </span>INFO<span class="w"> </span>mapred.Task:<span class="w"> </span>Final<span class="w"> </span>Counters<span class="w"> </span><span class="k">for</span><span class="w"> </span>attempt_local498821156_0001_r_000000_0:<span class="w"> </span>Counters:<span class="w"> </span><span class="m">30</span>
</span><span id="__span-24-102"><a id="__codelineno-24-102" name="__codelineno-24-102"></a><a href="#__codelineno-24-102"><span class="linenos" data-linenos="102 "></span></a><span class="w">    </span>File<span class="w"> </span>System<span class="w"> </span>Counters
</span><span id="__span-24-103"><a id="__codelineno-24-103" name="__codelineno-24-103"></a><a href="#__codelineno-24-103"><span class="linenos" data-linenos="103 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">1492842</span>
</span><span id="__span-24-104"><a id="__codelineno-24-104" name="__codelineno-24-104"></a><a href="#__codelineno-24-104"><span class="linenos" data-linenos="104 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">2131766</span>
</span><span id="__span-24-105"><a id="__codelineno-24-105" name="__codelineno-24-105"></a><a href="#__codelineno-24-105"><span class="linenos" data-linenos="105 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-106"><a id="__codelineno-24-106" name="__codelineno-24-106"></a><a href="#__codelineno-24-106"><span class="linenos" data-linenos="106 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-107"><a id="__codelineno-24-107" name="__codelineno-24-107"></a><a href="#__codelineno-24-107"><span class="linenos" data-linenos="107 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-108"><a id="__codelineno-24-108" name="__codelineno-24-108"></a><a href="#__codelineno-24-108"><span class="linenos" data-linenos="108 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">2161175</span>
</span><span id="__span-24-109"><a id="__codelineno-24-109" name="__codelineno-24-109"></a><a href="#__codelineno-24-109"><span class="linenos" data-linenos="109 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">448985</span>
</span><span id="__span-24-110"><a id="__codelineno-24-110" name="__codelineno-24-110"></a><a href="#__codelineno-24-110"><span class="linenos" data-linenos="110 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">10</span>
</span><span id="__span-24-111"><a id="__codelineno-24-111" name="__codelineno-24-111"></a><a href="#__codelineno-24-111"><span class="linenos" data-linenos="111 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-112"><a id="__codelineno-24-112" name="__codelineno-24-112"></a><a href="#__codelineno-24-112"><span class="linenos" data-linenos="112 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-24-113"><a id="__codelineno-24-113" name="__codelineno-24-113"></a><a href="#__codelineno-24-113"><span class="linenos" data-linenos="113 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nb">read</span><span class="w"> </span>erasure-coded<span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-114"><a id="__codelineno-24-114" name="__codelineno-24-114"></a><a href="#__codelineno-24-114"><span class="linenos" data-linenos="114 "></span></a><span class="w">    </span>Map-Reduce<span class="w"> </span>Framework
</span><span id="__span-24-115"><a id="__codelineno-24-115" name="__codelineno-24-115"></a><a href="#__codelineno-24-115"><span class="linenos" data-linenos="115 "></span></a><span class="w">        </span>Combine<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-116"><a id="__codelineno-24-116" name="__codelineno-24-116"></a><a href="#__codelineno-24-116"><span class="linenos" data-linenos="116 "></span></a><span class="w">        </span>Combine<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-117"><a id="__codelineno-24-117" name="__codelineno-24-117"></a><a href="#__codelineno-24-117"><span class="linenos" data-linenos="117 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>input<span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-118"><a id="__codelineno-24-118" name="__codelineno-24-118"></a><a href="#__codelineno-24-118"><span class="linenos" data-linenos="118 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>shuffle<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">605631</span>
</span><span id="__span-24-119"><a id="__codelineno-24-119" name="__codelineno-24-119"></a><a href="#__codelineno-24-119"><span class="linenos" data-linenos="119 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-120"><a id="__codelineno-24-120" name="__codelineno-24-120"></a><a href="#__codelineno-24-120"><span class="linenos" data-linenos="120 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-121"><a id="__codelineno-24-121" name="__codelineno-24-121"></a><a href="#__codelineno-24-121"><span class="linenos" data-linenos="121 "></span></a><span class="w">        </span>Spilled<span class="w"> </span><span class="nv">Records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-122"><a id="__codelineno-24-122" name="__codelineno-24-122"></a><a href="#__codelineno-24-122"><span class="linenos" data-linenos="122 "></span></a><span class="w">        </span>Shuffled<span class="w"> </span><span class="nv">Maps</span><span class="w"> </span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-24-123"><a id="__codelineno-24-123" name="__codelineno-24-123"></a><a href="#__codelineno-24-123"><span class="linenos" data-linenos="123 "></span></a><span class="w">        </span>Failed<span class="w"> </span><span class="nv">Shuffles</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-124"><a id="__codelineno-24-124" name="__codelineno-24-124"></a><a href="#__codelineno-24-124"><span class="linenos" data-linenos="124 "></span></a><span class="w">        </span>Merged<span class="w"> </span>Map<span class="w"> </span><span class="nv">outputs</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-24-125"><a id="__codelineno-24-125" name="__codelineno-24-125"></a><a href="#__codelineno-24-125"><span class="linenos" data-linenos="125 "></span></a><span class="w">        </span>GC<span class="w"> </span><span class="nb">time</span><span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span>ms<span class="o">)=</span><span class="m">5</span>
</span><span id="__span-24-126"><a id="__codelineno-24-126" name="__codelineno-24-126"></a><a href="#__codelineno-24-126"><span class="linenos" data-linenos="126 "></span></a><span class="w">        </span>Total<span class="w"> </span>committed<span class="w"> </span>heap<span class="w"> </span>usage<span class="w"> </span><span class="o">(</span>bytes<span class="o">)=</span><span class="m">167841792</span>
</span><span id="__span-24-127"><a id="__codelineno-24-127" name="__codelineno-24-127"></a><a href="#__codelineno-24-127"><span class="linenos" data-linenos="127 "></span></a><span class="w">    </span>Shuffle<span class="w"> </span>Errors
</span><span id="__span-24-128"><a id="__codelineno-24-128" name="__codelineno-24-128"></a><a href="#__codelineno-24-128"><span class="linenos" data-linenos="128 "></span></a><span class="w">        </span><span class="nv">BAD_ID</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-129"><a id="__codelineno-24-129" name="__codelineno-24-129"></a><a href="#__codelineno-24-129"><span class="linenos" data-linenos="129 "></span></a><span class="w">        </span><span class="nv">CONNECTION</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-130"><a id="__codelineno-24-130" name="__codelineno-24-130"></a><a href="#__codelineno-24-130"><span class="linenos" data-linenos="130 "></span></a><span class="w">        </span><span class="nv">IO_ERROR</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-131"><a id="__codelineno-24-131" name="__codelineno-24-131"></a><a href="#__codelineno-24-131"><span class="linenos" data-linenos="131 "></span></a><span class="w">        </span><span class="nv">WRONG_LENGTH</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-132"><a id="__codelineno-24-132" name="__codelineno-24-132"></a><a href="#__codelineno-24-132"><span class="linenos" data-linenos="132 "></span></a><span class="w">        </span><span class="nv">WRONG_MAP</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-133"><a id="__codelineno-24-133" name="__codelineno-24-133"></a><a href="#__codelineno-24-133"><span class="linenos" data-linenos="133 "></span></a><span class="w">        </span><span class="nv">WRONG_REDUCE</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-134"><a id="__codelineno-24-134" name="__codelineno-24-134"></a><a href="#__codelineno-24-134"><span class="linenos" data-linenos="134 "></span></a><span class="w">    </span>File<span class="w"> </span>Output<span class="w"> </span>Format<span class="w"> </span>Counters<span class="w"> </span>
</span><span id="__span-24-135"><a id="__codelineno-24-135" name="__codelineno-24-135"></a><a href="#__codelineno-24-135"><span class="linenos" data-linenos="135 "></span></a><span class="w">        </span>Bytes<span class="w"> </span><span class="nv">Written</span><span class="o">=</span><span class="m">448985</span>
</span><span id="__span-24-136"><a id="__codelineno-24-136" name="__codelineno-24-136"></a><a href="#__codelineno-24-136"><span class="linenos" data-linenos="136 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,528<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>Finishing<span class="w"> </span>task:<span class="w"> </span>attempt_local498821156_0001_r_000000_0
</span><span id="__span-24-137"><a id="__codelineno-24-137" name="__codelineno-24-137"></a><a href="#__codelineno-24-137"><span class="linenos" data-linenos="137 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:33,528<span class="w"> </span>INFO<span class="w"> </span>mapred.LocalJobRunner:<span class="w"> </span>reduce<span class="w"> </span>task<span class="w"> </span>executor<span class="w"> </span>complete.
</span><span id="__span-24-138"><a id="__codelineno-24-138" name="__codelineno-24-138"></a><a href="#__codelineno-24-138"><span class="linenos" data-linenos="138 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:34,491<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w">  </span>map<span class="w"> </span><span class="m">100</span>%<span class="w"> </span>reduce<span class="w"> </span><span class="m">100</span>%
</span><span id="__span-24-139"><a id="__codelineno-24-139" name="__codelineno-24-139"></a><a href="#__codelineno-24-139"><span class="linenos" data-linenos="139 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:34,493<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>Job<span class="w"> </span>job_local498821156_0001<span class="w"> </span>completed<span class="w"> </span>successfully
</span><span id="__span-24-140"><a id="__codelineno-24-140" name="__codelineno-24-140"></a><a href="#__codelineno-24-140"><span class="linenos" data-linenos="140 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">18</span>:59:34,528<span class="w"> </span>INFO<span class="w"> </span>mapreduce.Job:<span class="w"> </span>Counters:<span class="w"> </span><span class="m">36</span>
</span><span id="__span-24-141"><a id="__codelineno-24-141" name="__codelineno-24-141"></a><a href="#__codelineno-24-141"><span class="linenos" data-linenos="141 "></span></a><span class="w">    </span>File<span class="w"> </span>System<span class="w"> </span>Counters
</span><span id="__span-24-142"><a id="__codelineno-24-142" name="__codelineno-24-142"></a><a href="#__codelineno-24-142"><span class="linenos" data-linenos="142 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">1774390</span>
</span><span id="__span-24-143"><a id="__codelineno-24-143" name="__codelineno-24-143"></a><a href="#__codelineno-24-143"><span class="linenos" data-linenos="143 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">3657901</span>
</span><span id="__span-24-144"><a id="__codelineno-24-144" name="__codelineno-24-144"></a><a href="#__codelineno-24-144"><span class="linenos" data-linenos="144 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-145"><a id="__codelineno-24-145" name="__codelineno-24-145"></a><a href="#__codelineno-24-145"><span class="linenos" data-linenos="145 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-146"><a id="__codelineno-24-146" name="__codelineno-24-146"></a><a href="#__codelineno-24-146"><span class="linenos" data-linenos="146 "></span></a><span class="w">        </span>FILE:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-147"><a id="__codelineno-24-147" name="__codelineno-24-147"></a><a href="#__codelineno-24-147"><span class="linenos" data-linenos="147 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">read</span><span class="o">=</span><span class="m">4322350</span>
</span><span id="__span-24-148"><a id="__codelineno-24-148" name="__codelineno-24-148"></a><a href="#__codelineno-24-148"><span class="linenos" data-linenos="148 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nv">written</span><span class="o">=</span><span class="m">448985</span>
</span><span id="__span-24-149"><a id="__codelineno-24-149" name="__codelineno-24-149"></a><a href="#__codelineno-24-149"><span class="linenos" data-linenos="149 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">15</span>
</span><span id="__span-24-150"><a id="__codelineno-24-150" name="__codelineno-24-150"></a><a href="#__codelineno-24-150"><span class="linenos" data-linenos="150 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>large<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-151"><a id="__codelineno-24-151" name="__codelineno-24-151"></a><a href="#__codelineno-24-151"><span class="linenos" data-linenos="151 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>write<span class="w"> </span><span class="nv">operations</span><span class="o">=</span><span class="m">4</span>
</span><span id="__span-24-152"><a id="__codelineno-24-152" name="__codelineno-24-152"></a><a href="#__codelineno-24-152"><span class="linenos" data-linenos="152 "></span></a><span class="w">        </span>HDFS:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>bytes<span class="w"> </span><span class="nb">read</span><span class="w"> </span>erasure-coded<span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-153"><a id="__codelineno-24-153" name="__codelineno-24-153"></a><a href="#__codelineno-24-153"><span class="linenos" data-linenos="153 "></span></a><span class="w">    </span>Map-Reduce<span class="w"> </span>Framework
</span><span id="__span-24-154"><a id="__codelineno-24-154" name="__codelineno-24-154"></a><a href="#__codelineno-24-154"><span class="linenos" data-linenos="154 "></span></a><span class="w">        </span>Map<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">37863</span>
</span><span id="__span-24-155"><a id="__codelineno-24-155" name="__codelineno-24-155"></a><a href="#__codelineno-24-155"><span class="linenos" data-linenos="155 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">384275</span>
</span><span id="__span-24-156"><a id="__codelineno-24-156" name="__codelineno-24-156"></a><a href="#__codelineno-24-156"><span class="linenos" data-linenos="156 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">3688770</span>
</span><span id="__span-24-157"><a id="__codelineno-24-157" name="__codelineno-24-157"></a><a href="#__codelineno-24-157"><span class="linenos" data-linenos="157 "></span></a><span class="w">        </span>Map<span class="w"> </span>output<span class="w"> </span>materialized<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">605631</span>
</span><span id="__span-24-158"><a id="__codelineno-24-158" name="__codelineno-24-158"></a><a href="#__codelineno-24-158"><span class="linenos" data-linenos="158 "></span></a><span class="w">        </span>Input<span class="w"> </span>split<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">135</span>
</span><span id="__span-24-159"><a id="__codelineno-24-159" name="__codelineno-24-159"></a><a href="#__codelineno-24-159"><span class="linenos" data-linenos="159 "></span></a><span class="w">        </span>Combine<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">384275</span>
</span><span id="__span-24-160"><a id="__codelineno-24-160" name="__codelineno-24-160"></a><a href="#__codelineno-24-160"><span class="linenos" data-linenos="160 "></span></a><span class="w">        </span>Combine<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-161"><a id="__codelineno-24-161" name="__codelineno-24-161"></a><a href="#__codelineno-24-161"><span class="linenos" data-linenos="161 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>input<span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-162"><a id="__codelineno-24-162" name="__codelineno-24-162"></a><a href="#__codelineno-24-162"><span class="linenos" data-linenos="162 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>shuffle<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">605631</span>
</span><span id="__span-24-163"><a id="__codelineno-24-163" name="__codelineno-24-163"></a><a href="#__codelineno-24-163"><span class="linenos" data-linenos="163 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>input<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-164"><a id="__codelineno-24-164" name="__codelineno-24-164"></a><a href="#__codelineno-24-164"><span class="linenos" data-linenos="164 "></span></a><span class="w">        </span>Reduce<span class="w"> </span>output<span class="w"> </span><span class="nv">records</span><span class="o">=</span><span class="m">40067</span>
</span><span id="__span-24-165"><a id="__codelineno-24-165" name="__codelineno-24-165"></a><a href="#__codelineno-24-165"><span class="linenos" data-linenos="165 "></span></a><span class="w">        </span>Spilled<span class="w"> </span><span class="nv">Records</span><span class="o">=</span><span class="m">80134</span>
</span><span id="__span-24-166"><a id="__codelineno-24-166" name="__codelineno-24-166"></a><a href="#__codelineno-24-166"><span class="linenos" data-linenos="166 "></span></a><span class="w">        </span>Shuffled<span class="w"> </span><span class="nv">Maps</span><span class="w"> </span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-24-167"><a id="__codelineno-24-167" name="__codelineno-24-167"></a><a href="#__codelineno-24-167"><span class="linenos" data-linenos="167 "></span></a><span class="w">        </span>Failed<span class="w"> </span><span class="nv">Shuffles</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-168"><a id="__codelineno-24-168" name="__codelineno-24-168"></a><a href="#__codelineno-24-168"><span class="linenos" data-linenos="168 "></span></a><span class="w">        </span>Merged<span class="w"> </span>Map<span class="w"> </span><span class="nv">outputs</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-24-169"><a id="__codelineno-24-169" name="__codelineno-24-169"></a><a href="#__codelineno-24-169"><span class="linenos" data-linenos="169 "></span></a><span class="w">        </span>GC<span class="w"> </span><span class="nb">time</span><span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span>ms<span class="o">)=</span><span class="m">36</span>
</span><span id="__span-24-170"><a id="__codelineno-24-170" name="__codelineno-24-170"></a><a href="#__codelineno-24-170"><span class="linenos" data-linenos="170 "></span></a><span class="w">        </span>Total<span class="w"> </span>committed<span class="w"> </span>heap<span class="w"> </span>usage<span class="w"> </span><span class="o">(</span>bytes<span class="o">)=</span><span class="m">335683584</span>
</span><span id="__span-24-171"><a id="__codelineno-24-171" name="__codelineno-24-171"></a><a href="#__codelineno-24-171"><span class="linenos" data-linenos="171 "></span></a><span class="w">    </span>Shuffle<span class="w"> </span>Errors
</span><span id="__span-24-172"><a id="__codelineno-24-172" name="__codelineno-24-172"></a><a href="#__codelineno-24-172"><span class="linenos" data-linenos="172 "></span></a><span class="w">        </span><span class="nv">BAD_ID</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-173"><a id="__codelineno-24-173" name="__codelineno-24-173"></a><a href="#__codelineno-24-173"><span class="linenos" data-linenos="173 "></span></a><span class="w">        </span><span class="nv">CONNECTION</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-174"><a id="__codelineno-24-174" name="__codelineno-24-174"></a><a href="#__codelineno-24-174"><span class="linenos" data-linenos="174 "></span></a><span class="w">        </span><span class="nv">IO_ERROR</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-175"><a id="__codelineno-24-175" name="__codelineno-24-175"></a><a href="#__codelineno-24-175"><span class="linenos" data-linenos="175 "></span></a><span class="w">        </span><span class="nv">WRONG_LENGTH</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-176"><a id="__codelineno-24-176" name="__codelineno-24-176"></a><a href="#__codelineno-24-176"><span class="linenos" data-linenos="176 "></span></a><span class="w">        </span><span class="nv">WRONG_MAP</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-177"><a id="__codelineno-24-177" name="__codelineno-24-177"></a><a href="#__codelineno-24-177"><span class="linenos" data-linenos="177 "></span></a><span class="w">        </span><span class="nv">WRONG_REDUCE</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-24-178"><a id="__codelineno-24-178" name="__codelineno-24-178"></a><a href="#__codelineno-24-178"><span class="linenos" data-linenos="178 "></span></a><span class="w">    </span>File<span class="w"> </span>Input<span class="w"> </span>Format<span class="w"> </span>Counters<span class="w"> </span>
</span><span id="__span-24-179"><a id="__codelineno-24-179" name="__codelineno-24-179"></a><a href="#__codelineno-24-179"><span class="linenos" data-linenos="179 "></span></a><span class="w">        </span>Bytes<span class="w"> </span><span class="nv">Read</span><span class="o">=</span><span class="m">2161175</span>
</span><span id="__span-24-180"><a id="__codelineno-24-180" name="__codelineno-24-180"></a><a href="#__codelineno-24-180"><span class="linenos" data-linenos="180 "></span></a><span class="w">    </span>File<span class="w"> </span>Output<span class="w"> </span>Format<span class="w"> </span>Counters<span class="w"> </span>
</span><span id="__span-24-181"><a id="__codelineno-24-181" name="__codelineno-24-181"></a><a href="#__codelineno-24-181"><span class="linenos" data-linenos="181 "></span></a><span class="w">        </span>Bytes<span class="w"> </span><span class="nv">Written</span><span class="o">=</span><span class="m">448985</span>
</span></code></pre></div>
<ol start="9">
<li>Leemos el fichero de salida. Aquí están listados todas las palabras de El Quijote y cuantas veces aparece cada palabra</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos="1 "></span></a>hdfs dfs -cat /bda/mapreduce/ejercicios/salida_quijote/part-r-00000
</span></code></pre></div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023-2024 Jaime Rabasco - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/jaimerabasco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<jaimerabasco@iesgrancapitan.org>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.indexes", "toc.follow", "navigation.top", "header.autohide", "announce.dismiss", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>