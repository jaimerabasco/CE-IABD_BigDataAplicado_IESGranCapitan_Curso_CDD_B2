
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD4%20-%20Apache%20Hadoop/2_Hadoop_HDFS.html">
      
      
        <link rel="prev" href="1_Plataforma_Hadoop.html">
      
      
        <link rel="next" href="3_Hadoop_Map_Reduce.html">
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>HDFS - Big Data Aplicado</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="HDFS - Big Data Aplicado" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD4 - Apache Hadoop/2_Hadoop_HDFS.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/UD4%20-%20Apache%20Hadoop/2_Hadoop_HDFS.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="HDFS - Big Data Aplicado" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://jaimerabasco.github.io/CE-IABD_BigDataAplicado_IESGranCapitan/assets/images/social/UD4 - Apache Hadoop/2_Hadoop_HDFS.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ud-4-apache-hadoop-hdfs" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Big Data Aplicado" class="md-header__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Data Aplicado
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HDFS
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Big Data Aplicado" class="md-nav__button md-logo" aria-label="Big Data Aplicado" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Big Data Aplicado
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadatos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadatos
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guia_didactica.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía Didáctica
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD1 - Gestión de Soluciones
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            UD1 - Gestión de Soluciones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/1_dis_const_soluc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diseño y Construcción de Soluciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/2_proced_mecan_ingesta_datos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedimientos y Mecanismos de Ingesta de Datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD1%20-%20Gesti%C3%B3n%20de%20soluciones/3_form_datos_almacenamiento.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formato de Datos Adecuado para el Almacenamiento
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD2 - Procesado y Presentación Datos Almacenados
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            UD2 - Procesado y Presentación Datos Almacenados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/mongoDB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD2%20-%20Procesado%20y%20Presentaci%C3%B3n%20Datos%20Almacenados/neo4j.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neo4j
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD3 - Introducción a la computación paralela y distribuida
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            UD3 - Introducción a la computación paralela y distribuida
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UD3%20-%20Introducci%C3%B3n%20a%20la%20computaci%C3%B3n%20paralela%20y%20distribuida/comput_paralela_distribuida.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computación Paralela y Distribuida
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    UD4 - Apache Hadoop
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            UD4 - Apache Hadoop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_Plataforma_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plataforma y Ecosistema Hadoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="2_Hadoop_HDFS.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-caracteristicas-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      1. Características HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-bloques" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bloques
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-arquitectura-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      3. Arquitectura HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-funcionamiento-lectura-y-escritura" class="md-nav__link">
    <span class="md-ellipsis">
      4. Funcionamiento (Lectura y Escritura)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-factor-de-replica" class="md-nav__link">
    <span class="md-ellipsis">
      5. Factor de replica
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-manejo-y-uso-de-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      6. Manejo y uso de HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-instalando-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7. Instalando HDFS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Instalando HDFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-instalacion" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-configuracion-pseudo-distributed-operation" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Configuración (Pseudo-Distributed Operation)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-ejecucion" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Ejecución
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-usando-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Usando HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-administracion" class="md-nav__link">
    <span class="md-ellipsis">
      7.5 Administración
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-snapshots" class="md-nav__link">
    <span class="md-ellipsis">
      7.6 Snapshots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-navegacion-webui-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.7 Navegación WebUI HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78-permisos-webui-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.8 Permisos WebUI HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79-acceso-a-hdfs-a-traves-de-python" class="md-nav__link">
    <span class="md-ellipsis">
      7.9 Acceso a HDFS a través de Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="3_Hadoop_Map_Reduce.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Map Reduce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="4_Hadoop_Yarn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yarn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="5_Cluster_Hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Hadoop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../creditos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creditos
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-caracteristicas-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      1. Características HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-bloques" class="md-nav__link">
    <span class="md-ellipsis">
      2. Bloques
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-arquitectura-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      3. Arquitectura HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-funcionamiento-lectura-y-escritura" class="md-nav__link">
    <span class="md-ellipsis">
      4. Funcionamiento (Lectura y Escritura)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-factor-de-replica" class="md-nav__link">
    <span class="md-ellipsis">
      5. Factor de replica
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-manejo-y-uso-de-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      6. Manejo y uso de HDFS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-instalando-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7. Instalando HDFS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Instalando HDFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-instalacion" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-configuracion-pseudo-distributed-operation" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Configuración (Pseudo-Distributed Operation)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-ejecucion" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Ejecución
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-usando-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Usando HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-administracion" class="md-nav__link">
    <span class="md-ellipsis">
      7.5 Administración
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-snapshots" class="md-nav__link">
    <span class="md-ellipsis">
      7.6 Snapshots
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-navegacion-webui-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.7 Navegación WebUI HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78-permisos-webui-hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      7.8 Permisos WebUI HDFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79-acceso-a-hdfs-a-traves-de-python" class="md-nav__link">
    <span class="md-ellipsis">
      7.9 Acceso a HDFS a través de Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ud-4-apache-hadoop-hdfs">UD 4 - Apache Hadoop - HDFS<a class="headerlink" href="#ud-4-apache-hadoop-hdfs" title="Permanent link">&para;</a></h1>
<p><strong>Hadoop Distributed File System (HDFS)</strong> Es el componente principal del ecosistema Hadoop. Hace posible almacenar conjuntos de datos masivos con tipos de datos estructurados, semi-estructurados y no estructurados como imágenes, vídeo, datos de sensores, etc.</p>
<p>Es un sistema de almacenamiento distribuido y tolerante a fallos que puede almacenar gran cantidad de datos, escalar de forma incremental y sobrevivir a fallos de hardware sin perder datos. Se basa en el <a href="https://static.googleusercontent.com/media/research.google.com/es//archive/gfs-sosp2003.pdf">paper</a> que publicó Google detallando su Google File System en 2003.</p>
<p>Está optimizado para obtener un alto rendimiento y trabajar con máxima eficiencia cuando se leen <em>archivos grandes</em>. Para obtener este rendimiento, utiliza tamaños de bloque inusualmente grandes y optimización de localización de los datos para reducir la E/S de red.</p>
<p>Con el fin de ofrecer una visión de los recursos como una sola unidad crea una capa de abstracción como un sistema de ficheros único. <strong>Está basado en la idea de que mover el procesamiento es mucho más rápido, fácil y eficiente que mover grandes cantidades de datos, que pueden producir altas latencias y congestión en la red</strong>.</p>
<h2 id="1-caracteristicas-hdfs">1. Características HDFS<a class="headerlink" href="#1-caracteristicas-hdfs" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Es un sistema de ficheros distribuido</strong>, es decir, se ejecuta sobre diferentes nodos que trabajan en conjunto ofreciendo a los usuarios y aplicaciones que utilizan el sistema, un interfaz como si sólo hubiera un único servidor por detrás.</li>
<li>Está diseñado para ejecutarse sobre <strong>hardware commodity</strong>, es decir, no requiere unos servidores específicos o costosos. Esto conlleva la necesidad de poder sobreponerse a los fallos que pudieran tener los servidores o algunas partes de los servidores.</li>
<li>Está optimizado para almacenar <strong>ficheros de gran tamaño</strong> y para hacer operaciones de lectura o escritura masivas. Su objetivo es cubrir los casos de uso de analítica masiva, no los casos de uso que dan soporte a las operaciones de las empresas.</li>
<li>Tiene capacidad para <strong>escalar horizontalmente</strong> hasta volúmenes de Petabytes y miles de nodos, y está diseñado para poder dar soporte a <strong>múltiples clientes</strong> con acceso concurrente. La escalabilidad se consigue añadiendo más servidores</li>
<li>No establece <strong>ninguna restricción sobre los tipos de datos</strong> que se almacenan en el sistema, ya que éstos pueden ser estructurados, semiestructurados o no disponer de ninguna estructura, como el caso de imágenes o vídeos.</li>
<li>HDFS tiene una orientación <strong>"write-once, read many"</strong>, que significa "se escribe una vez, se lee muchas veces", es decir, asume que un archivo una vez escrito en HDFS <strong>no se modificará</strong>, aunque se puede acceder a él muchas veces. Así pues, los datos, una vez escritos en HDFS son <em>immutables</em>. Cada fichero de HDFS solo permite añadir contenido (append-only). Una vez se ha creado y escrito en él, solo podemos añadir contenido o eliminarlo. Es decir, a priori, no podemos modificar los datos.</li>
</ul>
<p><em>Recuerda las características con esta imagen</em></p>
<figure style="align: center; width:600px;">
    <img src="images/Figura4.1_HDFS_Características_HDFS.png">
    <figcaption>Figura 1 HDFS: Características HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<h2 id="2-bloques">2. Bloques<a class="headerlink" href="#2-bloques" title="Permanent link">&para;</a></h2>
<p>Un bloque es la cantidad mínima de datos que puede ser leída o escrita. En HDFS, los ficheros se dividen en bloques, como en la mayoría de sistemas de ficheros. Sin embargo, el <strong>tamaño de un bloque en HDFS es</strong> muy grande, <strong>de 128 megabytes por defecto</strong>. En el sistema operativo de un PC (Windows, Linux, etc.), el tamaño suele ser de 512 bytes o 4 kilobytes, es decir, unas 50.000 veces más pequeño que en HDFS.</p>
<p><em>El bloque es la unidad mínima de lectura</em>, lo que significa que aunque tengamos un fichero que ocupa 1 kilobyte, tendremos que leer o escribir 128 megabytes cada vez que queramos operar con el fichero. Para ficheros grandes, por ejemplo, de 500 gigabytes, la ventaja que aporta es que hay que buscar y leer o escribir muchos menos bloques. Esta característica explica por qué Hadoop está diseñado para ficheros grandes y lecturas masivas, y por qué tiene un mal rendimiento para operaciones pequeñas.</p>
<p>Por lo tanto, cuando queremos escribir un fichero en HDFS, lo primero que se hace es dividir el fichero en bloques. A continuación, los bloques son almacenados en diferentes nodos, no siendo necesario que los bloques de un mismo fichero estén en un mismo nodo. Además, un aspecto importante es que cada bloque se replica (se copia) en más de un nodo, lo que se conoce como el <strong>factor de replica</strong>. <em>El factor de replica por defecto en HDFS es 3</em>, lo que significa que cada bloque tiene 3 copias almacenadas en 3 nodos diferentes. <strong>La replicación es el mecanismo con el que se consigue, entre otras cosas, la tolerancia a fallos</strong>.</p>
<p>Al tener varias réplicas de cada bloque en diferentes nodos, en caso de que un nodo se caiga, o que un disco de un nodo se corrompa, HDFS dispondrá de otras copias, por lo que no se perderán los datos. </p>
<figure style="align: center;width:600px;">
    <img src="images/Figura4.2_HDFS_Bloques_HDFS.png">
    <figcaption>Figura 2 HDFS: Bloques HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<p>En el ejemplo anterior, si se cayera el nodo 3, HDFS dispondría de otras dos copias por cada bloque que almacena del fichero.</p>
<figure style="align: center;width:800px;">
    <img src="images/Figura4.3_HDFS_Factor_Replicación_HDFS.png">
    <figcaption>Figura 3 HDFS: Factor Replicación HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<p>El factor de replica puede configurarse a nivel de fichero o directorio, es decir, podemos elegir un factor de replica diferente para los ficheros o directorios que consideremos. Cuanto mayor sea el factor de replica, más difícil será que perdamos los datos e incluso mejorará el rendimiento en las lecturas, porque para leer un bloque, HDFS podrá utilizar cualquier nodo. Sin embargo, un factor de replica alto hace que las escrituras tengan peor rendimiento, al tener que hacer muchas copias en cada escritura, y además, consumirá más espacio real en disco.</p>
<h2 id="3-arquitectura-hdfs">3. Arquitectura HDFS<a class="headerlink" href="#3-arquitectura-hdfs" title="Permanent link">&para;</a></h2>
<p>La arquitectura de HDFS consta de distintos servicios y tipos de nodo, aunque fundamentalmente son tres tipos:</p>
<ul>
<li><strong>NameNode</strong>(NN): Nodo de Nombres.</li>
<li><strong>Secondary NameNode</strong>(SNN): Nodo de Nombres Secundario.</li>
<li><strong>DataNode</strong>(DN): Nodos de Datos</li>
</ul>
<p><strong>NameNode</strong></p>
<p>El nodo Namenode actúa de maestro, manteniendo la metainformación de todo el sistema de ficheros, esto es:</p>
<ul>
<li>Almacena el espacio de nombres HDFS</li>
<li>La estructura de directorios, subdirectorios y los ficheros</li>
<li>La información de los ficheros: tamaño, fecha de modificación, propietario, permisos, etc.</li>
<li>El factor de replica de cada fichero.</li>
<li>Los bloques que componen cada fichero.</li>
<li>La ubicación de los distintos bloques (en qué nodo se encuentran).</li>
</ul>
<div class="admonition note inline end">
<p class="admonition-title">Note</p>
<p><em>La información es almacenada tanto en disco, para garantizar la durabilidad en caso de una caída del servidor, como en memoria, para poder acceder a la información lo más rápido posible y optimizar el rendimiento.</em></p>
</div>
<p>NameNode se compone principalmente de dos ficheros:</p>
<ul>
<li><strong>FsImage:</strong> Contiene la estructura de directorio completa (espacio de nombres) de HDFS con detalles sobre la ubicación de los datos en los bloques de datos y qué bloques están almacenados en qué nodo. NameNode utiliza este archivo cuando se inicia.</li>
<li><strong>EditLog:</strong> Es un <em>registro de transacciones</em> que registra los cambios en el sistema de archivos HDFS o cualquier acción realizada en el clúster HDFS, como la adición de un nuevo bloque, la replicación, la eliminación, etc. En resumen, registra los cambios desde que se creó la última FsImage</li>
</ul>
<p>Cuando se inicia un NameNode, lee el estado HDFS de un archivo de imagen, fsimage, y luego aplica las ediciones del archivo de registro de ediciones. Seguidamente escribe un nuevo estado HDFS en el fsImage y comienza la operación normal con un archivo de edición vacío.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Por ejemplo, la creación de un nuevo archivo en HDFS hace que NameNode inserte un registro en EditLog para indicarlo. De manera similar, cambiar el factor de replica de un archivo hace que se inserte un nuevo registro en EditLog. El NameNode utiliza un archivo en su sistema de archivos del sistema operativo anfitrión local para almacenar el EditLog. Todo el espacio de nombres del sistema de archivos, incluida la asignación de bloques a archivos y las propiedades del sistema de archivos, se almacena en un archivo denominado FsImage. La FsImage también se almacena como un archivo en el sistema de archivos local de NameNode.</p>
</div>
<p>Además de gestionar la <strong>metainformación</strong>, <strong>coordina</strong> todas las <strong>lecturas</strong> y <strong>escrituras</strong>, y controla el funcionamiento de los Datanodes, es decir, detecta si hay algún fallo en algún nodo y toma las acciones necesarias en caso de que alguno esté caído o con fallos.</p>
<p>Es importante que el Namenode sea robusto y no tenga caídas. Por este motivo, se utiliza hardware más resiliente que en el caso de los Datanodes.</p>
<p><strong>Secondary NameNode</strong></p>
<p>Para mejorar la <strong>tolerancia a fallos</strong>, suele existir un nodo secundario del maestro, denominado <strong>Secondary Namenode</strong>.</p>
<p>El NameNode es el único punto de fallo en HDFS ya que, si el Namenode falla, se pierde todo el sistema de archivos HDFS. Para reducir este riesgo esto, Hadoop implementó el Secondary Namenode en la versión 3.</p>
<p>Secondary Namenode no es un <strong>nodo de respaldo</strong>. Su principal función es almacenar una copia de los ficheros <strong><em>fsimage</em></strong> y <strong><em>editlog</em></strong>. Comprueba los metadatos del sistema de archivos almacenados en NameNode. Esto es lo que se llama <em>checkpointing</em>. El proceso que sigue el NameNode secundario para fusionar periódicamente los archivos fsimage y edits log es el siguiente:</p>
<ol>
<li>El NameNode secundario obtiene los últimos archivos fsImage y editLog del NameNode primario.</li>
<li>El NameNode secundario aplica cada transacción del archivo editLog a fsImage para crear un nuevo archivo FsImage fusionado.</li>
<li>El archivo fsImage fusionado se transfiere de nuevo al NameNode primario.</li>
</ol>
<figure style="align: center;">
    <img src="images/Figura4.4_HDFS_Relacion_NameNode_DataNode.png">
    <figcaption>Figura 4 HDFS: Relación entre NameNode y DataNode. (Fuente: Telefónica Tech)</figcaption>
</figure>

<p><strong>DataNode</strong></p>
<p>Los <strong>Datanodes</strong> son los servicios que se encuentran en los <strong>nodos worker</strong>, y su labor principal es almacenar o leer los bloques que componen los ficheros que están almacenados en HDFS, con las siguientes particularidades:</p>
<ul>
<li>Habrá más de uno en cada clúster. Por cada Namenode podemos tener miles de Datanodes.</li>
<li>Almacena y lee bloques de datos. El Datanode sólo conoce los bloques que contiene, pero no sabe a qué fichero pertenecen o dónde se encuentran el resto de bloques del fichero. Toda esta información sólo está en el Namenode. Por eso es crítico para HDFS.</li>
<li>Envían al Namenode la lista de los bloques que almacenan, para que el Namenode pueda tener una lista actualizada de los bloques y su ubicación.</li>
<li>Almacenan un checksum por cada bloque para detectar si el bloque
está corrupto y garantizar su integridad.</li>
<li>Envía un latido (<em>heartbeat</em>) al Namenode, que es un mensaje corto indicando que está levantado</li>
</ul>
<p><strong>Resumen</strong></p>
<figure style="align: center;">
    <img src="images/Figura4.5_HDFS_Resumen_Nodos_HDFS.jpg">
    <figcaption>Figura 5 HDFS: Resumen Nodos HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<h2 id="4-funcionamiento-lectura-y-escritura">4. Funcionamiento (Lectura y Escritura)<a class="headerlink" href="#4-funcionamiento-lectura-y-escritura" title="Permanent link">&para;</a></h2>
<p>Los datos que se escriben en HDFS son <strong><em>immutables</em></strong>, es decir, no pueden ser modificados.</p>
<p>Esto significa que HDFS sólo permite añadir contenido a los ficheros, así que por ejemplo, si en un fichero de 256 megabytes se pretende modificar un carácter, HDFS creará un nuevo bloque con el cambio y lo escribirá por completo, borrando el bloque anterior. </p>
<p>Esto, junto con la característica del tamaño de bloque de <strong>128 megabytes</strong>, que es la <strong>unidad mínima de lectura</strong>, hace que el rendimiento de HDFS para operaciones sencillas sobre registros aleatorios sea muy pobre. Recuerda que HDFS está pensado para <em>ficheros grandes y lecturas masivas</em>. </p>
<p>HDFS proporciona dos tipos de operaciones básicas con los ficheros: <strong>leer y escribir un fichero</strong></p>
<p><strong>Lectura</strong></p>
<p>En el caso de las lecturas, un <strong><em>esquema simplificado</em></strong> de esta operación sería:</p>
<figure style="align: center;">
    <img src="images/Figura4.6_HDFS_Lectura_HDFS.jpg">
    <figcaption>Figura 6 HDFS: Lectura HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<ol>
<li>El cliente que desea leer un fichero de HDFS, mediante una librería instalada en su equipo, realiza una llamada al Namenode para conocer qué bloques forman un fichero (llamemos X al fichero), así como los Datanodes que contienen cada uno de los bloques.</li>
<li>El Namenode retorna dicha información, y ordena para cada bloque los Datanodes que contienen dicho bloque en función de la distancia al cliente (un algoritmo evalúa la distancia entre el cliente y cada Datanode). El objetivo de esta lista ordenada es intentar reducir el tiempo de acceso a cada Datanode desde el cliente.</li>
<li>Con la información recibida del Namenode, el cliente se comunica directamente con el Datanode 1 para solicitarle el primer bloque.</li>
<li>El cliente se comunica con el Datanode 2 para obtener el bloque 2.</li>
<li>El cliente se comunica con el Datanode 1 para obtener el bloque 3. </li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Es preciso indicar que durante la operación, la única responsabilidad del Namenode es devolver al cliente la lista de bloques y la ubicación de los mismos, pero no interviene en las lecturas. Es decir, para realizar las lecturas de cada bloque, <strong>el cliente se comunica directamente con los Datanodes, sin que los datos pasen por el Namenode</strong>. Esto hace que el Namenode no sea cuello de botella del proceso, y pueda atender múltiples peticiones en paralelo, ya que no le supone mucho esfuerzo de computación atender las diferentes solicitudes de los clientes.</p>
</div>
<p><strong>Escritura</strong></p>
<p>En el caso de las escrituras, un esquema simplificado de esta operación sería:</p>
<figure style="align: center;">
    <img src="images/Figura4.7_HDFS_Escritura_HDFS.jpg">
    <figcaption>Figura 7 HDFS: Escritura HDFS. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<ol>
<li>El cliente, que desea escribir un fichero, invoca a un servicio del Namenode para solicitar la creación del fichero, indicándole en la llamada el nombre y la ruta en la que desea guardarlo.</li>
<li>El Namenode realiza una serie de verificaciones, como los permisos del usuario/cliente en el directorio, si el fichero ya existe, etc. En caso de que todas las verificaciones sean correctas, devuelve un OK, en caso contrario un KO.</li>
<li>El cliente comienza a generar los bloques en los que se dividirá el fichero utilizando una librería de HDFS.</li>
<li>Para cada bloque que desea escribir el cliente, se invoca al Namenode para obtener el Datanode en el que escribir el bloque.</li>
<li>El Namenode devuelve la lista de Datanodes en los que escribir el bloque, y el cliente escribe dicho bloque en el primer Datanode obtenido, realizando una comunicación directamente con dicho Datanode.</li>
<li>Una vez escrito el bloque en el primer Datanode, éste es responsable de comunicarse con el siguiente Datanode en la cadena para que escriba una copia del bloque. Una vez todos los Datanodes han escrito la réplica, se devuelve un "Ok" al cliente para que escriba el siguiente bloque.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Al igual que en el caso de la lectura, es importante señalar que el Namenode no recibe en ningún momento los datos del fichero, sino que se limita a resolver las cuestiones relacionadas con la ubicación de cada bloque. De esta manera, liberando al Namenode de la operativa de escritura, permite optimizar el funcionamiento y que el Namenode no se convierta en el cuello de botella de HDFS en las escrituras de fichero.</p>
</div>
<h2 id="5-factor-de-replica">5. Factor de replica<a class="headerlink" href="#5-factor-de-replica" title="Permanent link">&para;</a></h2>
<p>Como sabemos, la replicación es un concepto muy importante en HDFS, ya que nos permite tener una mayor tolerancia a fallos, pero tiene otras implicaciones en cuanto al rendimiento como acabamos de ver.</p>
<p>Sin embargo, tiene una implicación directa en la capacidad de almacenamiento. Veámoslo.</p>
<p>En un clúster, la capacidad de almacenamiento total viene dado por la suma de la capacidad de todos los discos que hay en los Datanodes. Por ejemplo, en un clúster de 20 nodos, con 12 discos de 3 terabytes por nodo, tendremos una capacidad de 36 terabytes por nodo, y 720 terabytes en total.</p>
<p>Ahora bien, si todos los ficheros de HDFS van a tener un factor de
replicación 3 significará que cada fichero ocupará el triple, al haber 3 copias para cada datos. Esto hace que la capacidad total del clúster baje hasta 240 terabytes.</p>
<p>Además, cuando calculamos la capacidad real de un clúster, hay que dejar otro espacio para que las aplicaciones o los usuarios puedan guardar datos parciales de sus operaciones, logs, etc. Normalmente se reserva un 30 o 40% para este propósito, así que nuestro clúster de 20 nodos y 36 terabytes por nodo, tendrá una capacidad real de unos 150 terabytes. Sigue siendo una capacidad alta, <em>pero está lejos de los 720 terabytes iniciales</em>.</p>
<p>Con esto, podemos afirmar por lo tanto que:</p>
<ol>
<li>
<p>Un factor de replica alto:
  * Mejora la tolerancia a fallos.
  * Mejora la velocidad de lectura porque se pueden utilizar más Datanodes para recuperar un bloque.
  * Reduce la velocidad de las escrituras porque cada bloque hay que almacenarlo en más Datanodes.
  * Reduce la capacidad total de almacenamiento de un clúster.</p>
</li>
<li>
<p>Un factor de replica bajo:
  * Incrementa el riesgo de perder algún dato si se corrompen los Datanodes que almacenan un bloque.
  * Reduce la velocidad de lectura porque hay que leer cada bloque de uno o pocos Datanodes que lo contienen, y a lo mejor esos Datanodes están ocupados con otras operaciones.
  * Incrementa la velocidad de escritura, al tener que escribir cada bloque en pocos Datanodes.
  * Incrementa (o mejor dicho, reduce menos) la capacidad total de almacenamiento del clúster.</p>
</li>
</ol>
<p>Con estos puntos enumerados, normalmente se aplican estas reglas para calcular el <strong>factor de replica óptimo</strong>:</p>
<ul>
<li>Para datos temporales, que se van a escribir y quizás no se lean nunca, y que no son críticos, el factor de replica suele ser bajo (1 ó 2).</li>
<li>Para datos críticos, que es importante que no se puedan perder, y que suelen ser accedidos muchas veces, como por ejemplo una tabla maestra, el factor de replica suele ser alto (incluso teniendo una copia por cada Datanode si es accedida muchas veces y no ocupa mucho).</li>
<li>Para el resto de ficheros, se suele dejar el factor de replica por defecto.</li>
</ul>
<h2 id="6-manejo-y-uso-de-hdfs">6. Manejo y uso de HDFS<a class="headerlink" href="#6-manejo-y-uso-de-hdfs" title="Permanent link">&para;</a></h2>
<div class="admonition example inline end">
<p class="admonition-title">Example</p>
<p>Para una primera aproximación y para empezar a familiarizarnos con Apache Hadoop y HDFS usaremos la siguiente <a href="https://bit.ly/3k3bmWx">imagen de Cloudera</a> <em>(Necesitas pertenecer a IES Gran Capitán)</em></p>
</div>
<p>HDFS soporta operaciones similares a los sistemas Unix:</p>
<ul>
<li>Lectura, escritura o borrado de ficheros.</li>
<li>Creación, listado o borrado de directorios.</li>
<li>Usuarios, grupos y permisos.</li>
</ul>
<p>En cuanto a los interfaces con los que poder usar el sistema de ficheros, ofrece diferentes interfaces, siendo los principales los mencionados a continuación:</p>
<ul>
<li><strong>Cliente de línea de comandos</strong>: HDFS dispone de un amplio número de comandos que pueden ser ejecutados en consola. </li>
<li><strong>Java API</strong>: HDFS está escrito en Java de forma nativa y ofrece un API que puede ser utilizado por aplicaciones con el mismo lenguaje.</li>
<li><strong>RestFul API(WebHDFS)</strong>: para poder utilizar HDFS desde otros lenguajes, HDFS ofrece su funcionalidad mediante un servicio HTTP mediante el protocolo WebHDFS. Este interfaz, sin embargo, ofrece un rendimiento inferior al API de Java al utilizar HTTP como capa de transporte, por lo que no debería utilizarse para operaciones masivas o con alto volumen de datos.</li>
<li><strong>NFS interface (HDFS NFS Gateway)</strong>: es posible montar HDFS en el sistema de archivos de un cliente local utilizando la puerta de enlace NFSv3 de Hadoop.</li>
<li><strong>Librería C</strong>: HDFS ofrece una librería escrita en C, llamada libhdfs, que tiene un buen rendimiento, pero que no suele ofrecer toda la funcionalidad del API Java.</li>
</ul>
<p><strong>Cliente de línea de comandos</strong></p>
<p>Una vez dentro del sistema, el comando <em>hadoop fs</em> nos proporcionará todas las funcionalidades sobre HDFS. Si se introduce sólo el comando, nos ofrecerá la lista de opciones o comandos disponibles. Algunos de los comandos más utilizados son los siguientes:</p>
<div class="admonition info inline end">
<p class="admonition-title">Info</p>
<p><figure style="align: center;">
    <img src="images/Figura4.8_HDFS_DFS.png" width="200px">
    <figcaption>Figura 8 HDFS: HDFS DFS</figcaption>
</figure></p>
<p><code>hadoop fs</code> es soportado por cualquier sistema de archivos genérico que puede apuntar a cualquier sistema de archivos como local, HDFS, FTP, S3, etc. En cambio <code>hdfs dfs</code> es exclusivo de HDFS y es el usado en las versiones actuales. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>En la distribución de cloudera, el sistema de archivos local por defecto está localizado en /home/cloudera y la localización por defecto de HDFS es /user/cloudera</p>
</div>
<p>En el caso concreto de interactuar con el sistema de ficheros de Hadoop se utiliza el comando dfs, el cual requiere de otro argumento (empezando con un guion) el cual será uno de los comandos Linux para interactuar con el shell. Podéis consultar la lista de comandos en la <a href="https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/FileSystemShell.html">documentación oficial</a>.</p>
<ul>
<li>
<p><strong>Listar contenidos de un directorio</strong>: Para ver los contenidos del directorio HDFS el comando es el siguiente:</p>
<p><code>hdfs dfs -ls /user/cloudera</code></p>
</li>
<li>
<p><strong>Crear un directorio</strong>: Para crear un nuevo directorio dentro del sistema de ficheros HDFS.</p>
<p><code>hdfs dfs -mkdir /user/cloudera/prueba</code></p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Atención a los permisos necesarios para crear directorios en diferentes puntos del sistema de archivos</p>
</div>
<ul>
<li>
<p><strong>Copiar un fichero</strong> del sistema de archivos local al sistema de archivos HDFS. Se podrá verificar esa copia mediante el comando     <em>hdfs dfs -ls</em> o mediante la operación cat que se menciona a continuación.</p>
<p><code>hdfs dfs -copyFromLocal /home/cloudera/fichero /user/cloudera</code></p>
<p><em>Por defecto, el destino de cualquier operación HJDFS es /user/cloudera, de manera que es opcional especificar esa parte de la ruta salvo que sea diferente a la de por defecto.</em></p>
</li>
<li>
<p><strong>Visualización del contenido de un archivo</strong>: Para ver el contenido de un archivo ubicado en el sistema de archivo HDFS la operación será la siguiente:</p>
<p><code>hdfs dfs -cat /user/cloudera/prueba/fichero</code></p>
</li>
<li>
<p><strong>Extraer un fichero</strong> del sistema de archivos HDFS: Con el fin de copiar a nuestros sistema de archivos local un archivo del sistema de archivos de HDFS se utilizará alguno de los siguientes comandos.
    <code>hdfs dfs -copyToLocal /user/cloudera/prueba/fichero</code>
    <code>hdfs dfs -get /user/cloudera/prueba/fichero</code></p>
</li>
<li>
<p><strong>Mover ficheros</strong> dentro de HDFS: Para mover ficheros almacenados en HDFS a otros directorios de HDFS se podría utilizar el siguiente comando:</p>
<p><code>hdfs dfs -mv /user/cloudera/prueba/fichero /user/cloudera/</code></p>
<p>Se permiten múltiples orígenes de ficheros, lo que obliga a que el destino sea un directorio. El movimiento de ficheros entre diferentes sistemas de archivos no está permitido.</p>
</li>
<li>
<p><strong>Copiar ficheros</strong> dentro de HDFS: Copia un fichero entre diferentes localizaciones dentro de HDFS. También, como mv permite copiar desde diferentes orígenes, pero siempre con un directorio de destino final.</p>
<p><code>hdfs dfs -cp -f /user/cloudera/prueba/fichero /user/cloudera/</code></p>
<p><em>la opción -f permitirá sobreescribir el destino si éste existe previamente.</em></p>
</li>
<li>
<p><strong>Put</strong>: Permite copiar uno o varios orígenes desde el sistema de archivos local al sistema de archivos distribuido.</p>
<p><code>hdfs dfs -put /user/cloudera/prueba/fichero /user/cloudera/</code></p>
<p>También permite leer desde la entrada estándar (stdin) y escribe en el sistema de archivos destino.</p>
<p><code>hdfs dfs -put - /user/cloudera/entrada</code></p>
</li>
<li>
<p><strong>Añadir contenido al final del fichero</strong>: A veces es necesario hacer operaciones de concatenación de ficheros, etc., para ello existe la operación <em>appendToFile</em> que permite hacer esta operación.
    <code>hdfs dfs -appendToFile fichero_tail /user/cloudera/fichero</code></p>
</li>
<li>
<p><strong>Mezcla de ficheros</strong>: se utiliza para combinar varios archivos (o directorios) del sistema de archivos distribuido y luego ponerlo en un solo archivo de salida en nuestro sistema de archivos local. Dispone de una opción -nl con el fin de añadir una nueva línea al final de cada fichero.</p>
<p><code>hdfs dfs -getmerge -nl file1.txt file2.txt /home/cloudera/output.txt</code></p>
</li>
<li>
<p><strong>Borrado de ficheros</strong>: La operación rm permitirá borrar los ficheros especificados como argumentos. Con la opción -R se borrarán el directorio y los subdirectorios de forma recursiva.</p>
<p><code>hdfs dfs -rm -r /user/cloudera/prueba</code></p>
</li>
<li>
<p><strong>Cambio de permisos a los ficheros</strong>: De la misma forma que en Linux la operación chmod permitirá realizar cambios en los permisos de uso de los ficheros. Con la opción -R hace que el cambio se propague recursivamente a través de la estructura de directorios.</p>
<p><code>hdfs dfs -chmod -R 777 /user/cloudera/prueba</code></p>
</li>
<li>
<p><strong>Comprobar uso de disco</strong>: Servirá para comprobar cuando espacio de disco se está usando en HDFS. Si estamos interesados únicamente en el uso de disco de nuestro directorio de usuario el comando será:</p>
<p><code>hdfs dfs -du</code></p>
<p>Si por el contrario queremos conocer cuando espacio de disco está disponible en todo el cluster, el comando será:</p>
<p><code>hdfs dfs -df</code></p>
</li>
<li>
<p><strong>Contar número de directorios</strong>: El siguiente comando permite  obtener la información del número de directorios , ficheros y tamaño de los mismos.</p>
<p><code>hdfs dfs -count /user/cloudera</code></p>
</li>
<li>
<p><strong>Crea un fichero vacío</strong>:</p>
<p><code>hdfs dfs -touchz /user/cloudera/emptyfile</code></p>
</li>
<li>
<p><strong>setrep</strong>: Modifica el factor de replica de un fichero o un directorio. Ya sabes que el factor de replica por defecto es 3. Con este comando se puede modificar para un fichero o directorio concreto.</p>
<p><code>hdfs dfs -setrep 6 /user/cloudera/changerepfile</code></p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Recuerda</p>
<p>Recuerda diferencia entre trabajar con HDFS o trabajar con el disco local de la máquina en la que tienes abierto un terminal, que suele ser el nodo frontera. Este esquema te permitirá ver la diferencia:</p>
<p><figure style="align: center;">
    <img src="images/Figura4.9_HDFS_Comandos_HDFS.jpg">
    <figcaption>Figura 9 HDFS: Comandos HDFS</figcaption>
</figure></p>
<p>Cuando accedemos por terminal a una máquina, que suele ser la máquina frontera, y navegamos por su sistema de ficheros, lo estaremos haciendo sobre el disco o los discos que tiene esa máquina. Cuando ejecutamos el comando <code>hdfs dfs</code> , éste se ejecutará sobre el sistema de ficheros de HDFS, que es diferente al de la máquina en la que estamos.</p>
<p>Cuando queremos subir un fichero a HDFS, lo habitual es copiarlo primero en la máquina frontera, y posteriormente subirlo a Hadoop con el comando put.</p>
</div>
<h2 id="7-instalando-hdfs">7. Instalando HDFS<a class="headerlink" href="#7-instalando-hdfs" title="Permanent link">&para;</a></h2>
<div class="admonition note inline end">
<p class="admonition-title">Note</p>
<p>Recordamos de nuevo la instalación de Hadoop vista en el punto anterior</p>
</div>
<h3 id="71-instalacion">7.1 Instalación<a class="headerlink" href="#71-instalacion" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Java™</strong> debe ser instalado. Las versiones de Java recomendadas se encuentran descritas en <a href="https://cwiki.apache.org/confluence/display/HADOOP/Hadoop+Java+Versions">HadoopJavaVersions</a>.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openjdk-8-jdk
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>/usr/bin/java<span class="w"> </span>-version
</span></code></pre></div>
<ol start="2">
<li><strong>ssh</strong> debe estar instalado y sshd debe estar ejecutándose para usar las secuencias de comandos de Hadoop que administran los demonios ssh remotos de Hadoop, ya que vamos a usar las secuencias de comandos de inicio y detección opcionales.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>ssh
</span></code></pre></div>
<ol start="3">
<li>
<p>Abre una terminal</p>
</li>
<li>
<p>Para obtener la distribución de Apache Hadoop, descarga la versión estable más reciente desde <a href="https://www.apache.org/dyn/closer.cgi/hadoop/common/">Apache Download Mirrors</a></p>
</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a>wget<span class="w"> </span>https://dlcdn.apache.org/hadoop/common/hadoop-3.3.6/hadoop-3.3.6.tar.gz
</span></code></pre></div>
<ol start="5">
<li>Una vez descargado, desempaquetamos el archivo descargado con el comando tar y entra dentro de la carpeta:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>tar<span class="w"> </span>-xzf<span class="w"> </span>hadoop-3.3.6.tar.gz<span class="w"> </span>-C<span class="w"> </span>/opt
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos="2 "></span></a><span class="nb">cd</span><span class="w"> </span>/opt/hadoop-3.3.6
</span></code></pre></div>
<ol start="6">
<li>Edita el siguiente archivo <code>etc/hadoop/hadoop-env.sh</code> para definir la variable de entorno de Java y añádela.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># Technically, the only required environment variable is JAVA_HOME.</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos="2 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/lib/jvm/java-8-openjdk-amd64/
</span></code></pre></div>
<ol start="7">
<li>Para poder usar los comandos de HDFS en cualquier lugar del sistema, sin tener que hacerlo desde el directorio de Hadoop (por ejemplo <code>/opt/hadoop-3.3.6/bin</code>), creamos las variables de entorno y añadimos al PATH. Para ello abrimos el archivo <code>~/.bashrc</code> y añadimos al final el siguiente código y ejecuta el comando <code>source ~/.bashrc</code></li>
</ol>
<div class="language-bash highlight"><span class="filename">~/.bashrc</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_HOME</span><span class="o">=</span>/opt/hadoop-3.3.6
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos="2 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_INSTALL</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a><a href="#__codelineno-5-3"><span class="linenos" data-linenos="3 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_MAPRED_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><a href="#__codelineno-5-4"><span class="linenos" data-linenos="4 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_COMMON_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a><a href="#__codelineno-5-5"><span class="linenos" data-linenos="5 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_HDFS_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a><a href="#__codelineno-5-6"><span class="linenos" data-linenos="6 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_YARN_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><a href="#__codelineno-5-7"><span class="linenos" data-linenos="7 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_COMMON_LIB_NATIVE_DIR</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>/lib/native
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><a href="#__codelineno-5-8"><span class="linenos" data-linenos="8 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$HADOOP_HOME</span>/sbin:<span class="nv">$HADOOP_HOME</span>/bin
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><a href="#__codelineno-5-9"><span class="linenos" data-linenos="9 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_OPTS</span><span class="o">=</span><span class="s2">&quot;-Djava.library.path=</span><span class="nv">$HADOOP_HOME</span><span class="s2">/lib/native&quot;</span>
</span></code></pre></div>
<ol start="8">
<li>Ejecuta el siguiente comando. Si no da error, podemos continuar</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a>hadoop<span class="w"> </span>version
</span></code></pre></div>
<p>Nos debe salir la versión de hadoop</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a>Hadoop<span class="w"> </span><span class="m">3</span>.3.6
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos="2 "></span></a>Source<span class="w"> </span>code<span class="w"> </span>repository<span class="w"> </span>https://github.com/apache/hadoop.git<span class="w"> </span>-r<span class="w"> </span>1be78238728da9266a4f88195058f08fd012bf9c
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos="3 "></span></a>Compiled<span class="w"> </span>by<span class="w"> </span>ubuntu<span class="w"> </span>on<span class="w"> </span><span class="m">2023</span>-06-18T08:22Z
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><a href="#__codelineno-7-4"><span class="linenos" data-linenos="4 "></span></a>Compiled<span class="w"> </span>on<span class="w"> </span>platform<span class="w"> </span>linux-x86_64
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><a href="#__codelineno-7-5"><span class="linenos" data-linenos="5 "></span></a>Compiled<span class="w"> </span>with<span class="w"> </span>protoc<span class="w"> </span><span class="m">3</span>.7.1
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><a href="#__codelineno-7-6"><span class="linenos" data-linenos="6 "></span></a>From<span class="w"> </span><span class="nb">source</span><span class="w"> </span>with<span class="w"> </span>checksum<span class="w"> </span>5652179ad55f76cb287d9c633bb53bbd
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><a href="#__codelineno-7-7"><span class="linenos" data-linenos="7 "></span></a>This<span class="w"> </span><span class="nb">command</span><span class="w"> </span>was<span class="w"> </span>run<span class="w"> </span>using<span class="w"> </span>/opt/hadoop-3.3.6/share/hadoop/common/hadoop-common-3.3.6.jar
</span></code></pre></div>
<h3 id="72-configuracion-pseudo-distributed-operation">7.2 Configuración (Pseudo-Distributed Operation)<a class="headerlink" href="#72-configuracion-pseudo-distributed-operation" title="Permanent link">&para;</a></h3>
<p>Hadoop se puede ejecutar en un solo nodo en un modo pseudo-distributed donde cada demonio de Hadoop se ejecuta en un proceso Java separado.</p>
<p>Los archivos que vamos a revisar a continuación se encuentran dentro de la carpeta <code>$HADOOP_HOME/etc/hadoop</code>.</p>
<ol>
<li>El archivo que contiene la configuración general del clúster es el archivo <code>core-site.xml</code>. En él se configura cual será el sistema de ficheros, que normalmente será hdfs, indicando el dominio del nodo que será el maestro de datos (namenode) de la arquitectura. Podéis sustituir el nombre del dominio <code>bda-iesgrancapitan</code> por el que queráis</li>
</ol>
<div class="language-xml highlight"><span class="filename">core-site.xml</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">&lt;configuration&gt;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">    </span><span class="nt">&lt;property&gt;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>fs.defaultFS<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">        </span><span class="nt">&lt;value&gt;</span>hdfs://bda-iesgrancapitan:9000<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">    </span><span class="nt">&lt;/property&gt;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos="6 "></span></a><span class="nt">&lt;/configuration&gt;</span>
</span></code></pre></div>
<ol start="2">
<li>El siguiente paso es configurar el archivo <code>hdfs-site.xml</code> donde se indica tanto el factor de replica como la ruta donde se almacenan tanto los metadatos (namenode) como los datos en sí (datanode):</li>
</ol>
<div class="language-xml highlight"><span class="filename">hdfs-site.xml</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">&lt;configuration&gt;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">    </span><span class="nt">&lt;property&gt;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><a href="#__codelineno-9-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>dfs.replication<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><a href="#__codelineno-9-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">        </span><span class="nt">&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><a href="#__codelineno-9-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">    </span><span class="nt">&lt;/property&gt;</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><a href="#__codelineno-9-6"><span class="linenos" data-linenos="6 "></span></a><span class="nt">&lt;/configuration&gt;</span>
</span></code></pre></div>
<ol start="3">
<li><strong>Opcional:</strong> Si quieres especificar la ruta donde se almacenan los metadatos(namenode) y los datos(datanode) donde el propio hadoop los configura por defecto puedes hacerlo cambiando dichos parámetros correspondientes. Todos lo parámetros por defecto susceptibles de cambio se encuentran en este <a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">recurso</a></li>
</ol>
<div class="admonition note inline end">
<p class="admonition-title">Note</p>
<p>Si tuviésemos un clúster, en el nodo maestro sólo configuraríamos la ruta del namenode y en cada uno de los nodos esclavos, únicamente la ruta del datanode.</p>
</div>
<div class="language-xml highlight"><span class="filename">hdfs-site.xml</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="nt">&lt;configuration&gt;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">    </span><span class="nt">&lt;property&gt;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>dfs.replication<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><a href="#__codelineno-10-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">        </span><span class="nt">&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><a href="#__codelineno-10-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span><span class="nt">&lt;/property&gt;</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><a href="#__codelineno-10-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><a href="#__codelineno-10-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">    </span><span class="nt">&lt;property&gt;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><a href="#__codelineno-10-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>dfs.namenode.name.dir<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><a href="#__codelineno-10-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">        </span><span class="nt">&lt;value&gt;</span>/opt/hadoop/hadoop_data/hdfs/namenode<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><a href="#__codelineno-10-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span><span class="nt">&lt;/property&gt;</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a><a href="#__codelineno-10-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a><a href="#__codelineno-10-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="nt">&lt;property&gt;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a><a href="#__codelineno-10-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">        </span><span class="nt">&lt;name&gt;</span>dfs.datanode.data.dir<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a><a href="#__codelineno-10-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">        </span><span class="nt">&lt;value&gt;</span>/opt/hadoop/hadoop_data/hdfs/datanode<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a><a href="#__codelineno-10-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="nt">&lt;/property&gt;</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a><a href="#__codelineno-10-16"><span class="linenos" data-linenos="16 "></span></a><span class="nt">&lt;/configuration&gt;</span>
</span></code></pre></div>
<ol start="4">
<li>Crea los directorios de <code>hadoop-data</code> configurados anteriormente en <code>hdfs-site.xml</code> para cuando ejecutemos <strong>hadoop</strong> y configura los permisos oportunos.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/opt/hadoop
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a><a href="#__codelineno-11-2"><span class="linenos" data-linenos="2 "></span></a>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>hadoop:hadoop<span class="w"> </span>/opt/hadoop
</span></code></pre></div>
<ol start="5">
<li>Comprobamos que podemos entrar por ssh al localhost sin un passphrase:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos="1 "></span></a>ssh<span class="w"> </span>localhost
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos="2 "></span></a><span class="nb">exit</span><span class="w"> </span>//Si<span class="w"> </span>hemos<span class="w"> </span>podido<span class="w"> </span>acceder
</span></code></pre></div>
<ol start="6">
<li>Si no puedes entrar por ssh al localhost sin un passphrase, ejecuta los siguientes comandos:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="1 "></span></a>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-P<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/id_rsa
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a><a href="#__codelineno-13-2"><span class="linenos" data-linenos="2 "></span></a>cat<span class="w"> </span>~/.ssh/id_rsa.pub<span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.ssh/authorized_keys
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><a href="#__codelineno-13-3"><span class="linenos" data-linenos="3 "></span></a>chmod<span class="w"> </span><span class="m">0600</span><span class="w"> </span>~/.ssh/authorized_keys
</span></code></pre></div>
<ol start="7">
<li>Añade a <code>/etc/hosts</code>el nombre de tu dominio indicado en <code>core-site.xml</code> para que no te de error de resolución de nombres. En mi caso añado la siguiente linea y reinicia el servicio:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos="1 "></span></a><span class="m">127</span>.0.0.1<span class="w">   </span>bda-iesgrancapitan
</span></code></pre></div>
<h3 id="73-ejecucion">7.3 Ejecución<a class="headerlink" href="#73-ejecucion" title="Permanent link">&para;</a></h3>
<ol>
<li>Ejecuta el siguiente comando</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>namenode<span class="w"> </span>-format
</span></code></pre></div>
<ol start="2">
<li>Debería darte una salida como la siguiente</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos=" 1 "></span></a>WARNING:<span class="w"> </span>/opt/hadoop-3.3.6/logs<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist.<span class="w"> </span>Creating.
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a><a href="#__codelineno-16-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:42,564<span class="w"> </span>INFO<span class="w"> </span>namenode.NameNode:<span class="w"> </span>STARTUP_MSG:<span class="w"> </span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><a href="#__codelineno-16-3"><span class="linenos" data-linenos=" 3 "></span></a>/************************************************************
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><a href="#__codelineno-16-4"><span class="linenos" data-linenos=" 4 "></span></a>STARTUP_MSG:<span class="w"> </span>Starting<span class="w"> </span>NameNode
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><a href="#__codelineno-16-5"><span class="linenos" data-linenos=" 5 "></span></a>STARTUP_MSG:<span class="w">   </span><span class="nv">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hadoop-VirtualBox/127.0.1.1
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><a href="#__codelineno-16-6"><span class="linenos" data-linenos=" 6 "></span></a>STARTUP_MSG:<span class="w">   </span><span class="nv">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>-format<span class="o">]</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="hll"><a href="#__codelineno-16-7"><span class="linenos" data-linenos=" 7 "></span></a>STARTUP_MSG:<span class="w">   </span><span class="nv">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.3.6
</span></span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><a href="#__codelineno-16-8"><span class="linenos" data-linenos=" 8 "></span></a>......
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><a href="#__codelineno-16-9"><span class="linenos" data-linenos=" 9 "></span></a>......
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><a href="#__codelineno-16-10"><span class="linenos" data-linenos="10 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:44,678<span class="w"> </span>INFO<span class="w"> </span>namenode.FSImage:<span class="w"> </span>Allocated<span class="w"> </span>new<span class="w"> </span>BlockPoolId:<span class="w"> </span>BP-693156123-127.0.1.1-1701082304668
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="hll"><a href="#__codelineno-16-11"><span class="linenos" data-linenos="11 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,014<span class="w"> </span>INFO<span class="w"> </span>common.Storage:<span class="w"> </span>Storage<span class="w"> </span>directory<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>successfully<span class="w"> </span>formatted.
</span></span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><a href="#__codelineno-16-12"><span class="linenos" data-linenos="12 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,164<span class="w"> </span>INFO<span class="w"> </span>namenode.FSImageFormatProtobuf:<span class="w"> </span>Saving<span class="w"> </span>image<span class="w"> </span>file<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/fsimage.ckpt_0000000000000000000<span class="w"> </span>using<span class="w"> </span>no<span class="w"> </span>compression
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><a href="#__codelineno-16-13"><span class="linenos" data-linenos="13 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,253<span class="w"> </span>INFO<span class="w"> </span>namenode.FSImageFormatProtobuf:<span class="w"> </span>Image<span class="w"> </span>file<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/fsimage.ckpt_0000000000000000000<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">401</span><span class="w"> </span>bytes<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>seconds<span class="w"> </span>.
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><a href="#__codelineno-16-14"><span class="linenos" data-linenos="14 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,386<span class="w"> </span>INFO<span class="w"> </span>namenode.NNStorageRetentionManager:<span class="w"> </span>Going<span class="w"> </span>to<span class="w"> </span>retain<span class="w"> </span><span class="m">1</span><span class="w"> </span>images<span class="w"> </span>with<span class="w"> </span>txid<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><a href="#__codelineno-16-15"><span class="linenos" data-linenos="15 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,430<span class="w"> </span>INFO<span class="w"> </span>namenode.FSNamesystem:<span class="w"> </span>Stopping<span class="w"> </span>services<span class="w"> </span>started<span class="w"> </span><span class="k">for</span><span class="w"> </span>active<span class="w"> </span>state
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><a href="#__codelineno-16-16"><span class="linenos" data-linenos="16 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,431<span class="w"> </span>INFO<span class="w"> </span>namenode.FSNamesystem:<span class="w"> </span>Stopping<span class="w"> </span>services<span class="w"> </span>started<span class="w"> </span><span class="k">for</span><span class="w"> </span>standby<span class="w"> </span>state
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><a href="#__codelineno-16-17"><span class="linenos" data-linenos="17 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,452<span class="w"> </span>INFO<span class="w"> </span>namenode.FSImage:<span class="w"> </span>FSImageSaver<span class="w"> </span>clean<span class="w"> </span>checkpoint:<span class="w"> </span><span class="nv">txid</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>when<span class="w"> </span>meet<span class="w"> </span>shutdown.
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><a href="#__codelineno-16-18"><span class="linenos" data-linenos="18 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:51:45,452<span class="w"> </span>INFO<span class="w"> </span>namenode.NameNode:<span class="w"> </span>SHUTDOWN_MSG
</span></code></pre></div>
<ol start="3">
<li>Iniciando el demonio Namenode y Datanode</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos="1 "></span></a>start-dfs.sh
</span></code></pre></div>
<ol start="4">
<li>Debería darte una salida como la siguiente</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a>hadoop@hadoop-VirtualBox:/opt/hadoop-3.3.6$<span class="w"> </span>start-dfs.sh<span class="w"> </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos="2 "></span></a>Starting<span class="w"> </span>namenodes<span class="w"> </span>on<span class="w"> </span><span class="o">[</span>bda-iesgrancapitan<span class="o">]</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos="3 "></span></a>Starting<span class="w"> </span>datanodes
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a><a href="#__codelineno-18-4"><span class="linenos" data-linenos="4 "></span></a>Starting<span class="w"> </span>secondary<span class="w"> </span>namenodes<span class="w"> </span><span class="o">[</span>hadoop-VirtualBox<span class="o">]</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a><a href="#__codelineno-18-5"><span class="linenos" data-linenos="5 "></span></a>hadoop@hadoop-VirtualBox:/opt/hadoop-3.3.6$<span class="w"> </span>jps
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a><a href="#__codelineno-18-6"><span class="linenos" data-linenos="6 "></span></a><span class="m">16401</span><span class="w"> </span>Jps
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a><a href="#__codelineno-18-7"><span class="linenos" data-linenos="7 "></span></a><span class="m">15970</span><span class="w"> </span>NameNode
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a><a href="#__codelineno-18-8"><span class="linenos" data-linenos="8 "></span></a><span class="m">16085</span><span class="w"> </span>DataNode
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a><a href="#__codelineno-18-9"><span class="linenos" data-linenos="9 "></span></a><span class="m">16283</span><span class="w"> </span>SecondaryNameNode
</span></code></pre></div>
<ol start="5">
<li>Accede desde el navegador a <code>http://bda-iesgrancapitan:9870/</code> para acceder al interfaz web de HDFS</li>
</ol>
<figure style="align: center;">
    <img src="images/Figura4.1_InstalandoHDFS_InterfazWeb.jpg">
    <figcaption>Figura 1 Instalando HDFS: Interfaz Web. (Fuente: Propia)</figcaption>
</figure>

<h3 id="74-usando-hdfs">7.4 Usando HDFS<a class="headerlink" href="#74-usando-hdfs" title="Permanent link">&para;</a></h3>
<p>Vamos a investigar cuál es el funcionamiento interno de HDFS estudiado en teoría.</p>
<p>Para ello vamos a añadir a HDFS un <a href="https://files.grouplens.org/datasets/tag-genome-2021/">fichero de gran volumen</a>. Accede al enlace y descarga el archivo <a href="https://files.grouplens.org/datasets/tag-genome-2021/genome_2021.zip">genome_2021.zip</a></p>
<ol>
<li>Descargamos el archivo en el sistema de archivos local</li>
</ol>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos="1 "></span></a>wget<span class="w"> </span>https://files.grouplens.org/datasets/tag-genome-2021/genome_2021.zip
</span></code></pre></div>
2. Vamos a observar la salida de logs en cada uno de los siguientes pasos, que nos va a servir para afianzar como como funciona HDFS. Observamos el log del namenode. En mi caso:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a>tail<span class="w"> </span>-f<span class="w"> </span><span class="nv">$HADOOP_HOME</span>/logs/hadoop-hadoop-namenode-hadoop-VirtualBox.log
</span></code></pre></div>
<ol start="3">
<li>Lo añadimos a HDFS</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-copyFromLocal<span class="w"> </span>genome_2021.zip<span class="w"> </span>/
</span></code></pre></div>
<p>La salida del log nos indica la división en bloques y la adición de la transacción en el EditLog ()</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="hll"><a href="#__codelineno-22-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:58:19,590<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FileJournalManager:<span class="w"> </span>Finalizing<span class="w"> </span>edits<span class="w"> </span>file<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/edits_inprogress_0000000000000000001<span class="w"> </span>-&gt;<span class="w"> </span>/opt/hadoop/had
</span></span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos=" 2 "></span></a>oop_data/hdfs/namenode/current/edits_0000000000000000001-0000000000000000002
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a><a href="#__codelineno-22-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:58:19,608<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Starting<span class="w"> </span>log<span class="w"> </span>segment<span class="w"> </span>at<span class="w"> </span><span class="m">3</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a><a href="#__codelineno-22-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:58:20,224<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.TransferFsImage:<span class="w"> </span>Sending<span class="w"> </span>fileName:<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/fsimage_0000000000000000000,<span class="w"> </span>fileSize:<span class="w"> </span><span class="m">401</span>.<span class="w"> </span>Sent<span class="w"> </span>total:<span class="w"> </span><span class="m">401</span><span class="w"> </span>by
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a><a href="#__codelineno-22-5"><span class="linenos" data-linenos=" 5 "></span></a>tes.<span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>last<span class="w"> </span>segment<span class="w"> </span>intended<span class="w"> </span>to<span class="w"> </span>send:<span class="w"> </span>-1<span class="w"> </span>bytes.
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="hll"><a href="#__codelineno-22-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:58:20,496<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.TransferFsImage:<span class="w"> </span>Sending<span class="w"> </span>fileName:<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/edits_0000000000000000001-0000000000000000002,<span class="w"> </span>fileSize:<span class="w"> </span><span class="m">42</span>.<span class="w"> </span>S
</span></span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7"></a><a href="#__codelineno-22-7"><span class="linenos" data-linenos=" 7 "></span></a>ent<span class="w"> </span>total:<span class="w"> </span><span class="m">42</span><span class="w"> </span>bytes.<span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>last<span class="w"> </span>segment<span class="w"> </span>intended<span class="w"> </span>to<span class="w"> </span>send:<span class="w"> </span>-1<span class="w"> </span>bytes.
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8"></a><a href="#__codelineno-22-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">11</span>:58:21,070<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.ImageServlet:<span class="w"> </span>Rejecting<span class="w"> </span>a<span class="w"> </span>fsimage<span class="w"> </span>due<span class="w"> </span>to<span class="w"> </span>small<span class="w"> </span><span class="nb">time</span><span class="w"> </span>delta<span class="w"> </span>and<span class="w"> </span>txnid<span class="w"> </span>delta.<span class="w"> </span>Time<span class="w"> </span>since<span class="w"> </span>previous<span class="w"> </span>checkpoint<span class="w"> </span>is<span class="w"> </span><span class="m">395</span><span class="w"> </span>expecting<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span><span class="m">2700</span><span class="w"> </span>txnid<span class="w"> </span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9"></a><a href="#__codelineno-22-9"><span class="linenos" data-linenos=" 9 "></span></a>delta<span class="w"> </span>since<span class="w"> </span>previous<span class="w"> </span>checkpoint<span class="w"> </span>is<span class="w"> </span><span class="m">2</span><span class="w"> </span>expecting<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span><span class="m">1000000</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10"></a><a href="#__codelineno-22-10"><span class="linenos" data-linenos="10 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:37:53,007<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions:<span class="w"> </span><span class="m">2</span><span class="w"> </span>Total<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>transactions<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">83</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions<span class="w"> </span>batched<span class="w"> </span><span class="k">in</span><span class="w"> </span>Syncs:<span class="w"> </span><span class="m">0</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>syncs:<span class="w"> </span><span class="m">2</span><span class="w"> </span>SyncTime
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11"></a><a href="#__codelineno-22-11"><span class="linenos" data-linenos="11 "></span></a>s<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">217</span><span class="w"> </span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12"></a><a href="#__codelineno-22-12"><span class="linenos" data-linenos="12 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:37:53,265<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741825_1001,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13"></a><a href="#__codelineno-22-13"><span class="linenos" data-linenos="13 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:37:55,015<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741826_1002,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14"></a><a href="#__codelineno-22-14"><span class="linenos" data-linenos="14 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:37:58,097<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741827_1003,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15"></a><a href="#__codelineno-22-15"><span class="linenos" data-linenos="15 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:00,850<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741828_1004,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16"></a><a href="#__codelineno-22-16"><span class="linenos" data-linenos="16 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:03,102<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741829_1005,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17"></a><a href="#__codelineno-22-17"><span class="linenos" data-linenos="17 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:07,189<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741830_1006,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18"></a><a href="#__codelineno-22-18"><span class="linenos" data-linenos="18 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:09,171<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741831_1007,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19"></a><a href="#__codelineno-22-19"><span class="linenos" data-linenos="19 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:13,229<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741832_1008,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20"></a><a href="#__codelineno-22-20"><span class="linenos" data-linenos="20 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:16,796<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741833_1009,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21"></a><a href="#__codelineno-22-21"><span class="linenos" data-linenos="21 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:18,812<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741834_1010,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22"></a><a href="#__codelineno-22-22"><span class="linenos" data-linenos="22 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:22,466<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741835_1011,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23"></a><a href="#__codelineno-22-23"><span class="linenos" data-linenos="23 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:26,859<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741836_1012,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24"></a><a href="#__codelineno-22-24"><span class="linenos" data-linenos="24 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:28,264<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741837_1013,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25"></a><a href="#__codelineno-22-25"><span class="linenos" data-linenos="25 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:31,502<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741838_1014,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26"></a><a href="#__codelineno-22-26"><span class="linenos" data-linenos="26 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:33,935<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>BLOCK*<span class="w"> </span>allocate<span class="w"> </span>blk_1073741839_1015,<span class="w"> </span><span class="nv">replicas</span><span class="o">=</span><span class="m">127</span>.0.0.1:9866<span class="w"> </span><span class="k">for</span><span class="w"> </span>/genome_2021.zip._COPYING_
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27"></a><a href="#__codelineno-22-27"><span class="linenos" data-linenos="27 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:38:36,202<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.StateChange:<span class="w"> </span>DIR*<span class="w"> </span>completeFile:<span class="w"> </span>/genome_2021.zip._COPYING_<span class="w"> </span>is<span class="w"> </span>closed<span class="w"> </span>by<span class="w"> </span>DFSClient_NONMAPREDUCE_-294249091_1
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28"></a><a href="#__codelineno-22-28"><span class="linenos" data-linenos="28 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:43:41,454<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.http.HttpServer2:<span class="w"> </span>Process<span class="w"> </span>Thread<span class="w"> </span>Dump:<span class="w"> </span>jsp<span class="w"> </span>requested
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29"></a><a href="#__codelineno-22-29"><span class="linenos" data-linenos="29 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,096<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSNamesystem:<span class="w"> </span>Roll<span class="w"> </span>Edit<span class="w"> </span>Log<span class="w"> </span>from<span class="w"> </span><span class="m">127</span>.0.0.1
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30"></a><span class="hll"><a href="#__codelineno-22-30"><span class="linenos" data-linenos="30 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,096<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Rolling<span class="w"> </span>edit<span class="w"> </span>logs
</span></span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31"></a><a href="#__codelineno-22-31"><span class="linenos" data-linenos="31 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,096<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Ending<span class="w"> </span>log<span class="w"> </span>segment<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">51</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32"></a><a href="#__codelineno-22-32"><span class="linenos" data-linenos="32 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,096<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions:<span class="w"> </span><span class="m">50</span><span class="w"> </span>Total<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>transactions<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">83</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions<span class="w"> </span>batched<span class="w"> </span><span class="k">in</span><span class="w"> </span>Syncs:<span class="w"> </span><span class="m">27</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>syncs:<span class="w"> </span><span class="m">23</span><span class="w"> </span>SyncTimes<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">18260</span><span class="w"> </span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33"></a><a href="#__codelineno-22-33"><span class="linenos" data-linenos="33 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,164<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions:<span class="w"> </span><span class="m">50</span><span class="w"> </span>Total<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>transactions<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">83</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>transactions<span class="w"> </span>batched<span class="w"> </span><span class="k">in</span><span class="w"> </span>Syncs:<span class="w"> </span><span class="m">27</span><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>syncs:<span class="w"> </span><span class="m">24</span><span class="w"> </span>SyncTimes<span class="o">(</span>ms<span class="o">)</span>:<span class="w"> </span><span class="m">18327</span><span class="w"> </span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34"></a><a href="#__codelineno-22-34"><span class="linenos" data-linenos="34 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,164<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FileJournalManager:<span class="w"> </span>Finalizing<span class="w"> </span>edits<span class="w"> </span>file<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/edits_inprogress_0000000000000000003<span class="w"> </span>-&gt;<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/edits_0000000000000000003-0000000000000000052
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35"></a><a href="#__codelineno-22-35"><span class="linenos" data-linenos="35 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,178<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.FSEditLog:<span class="w"> </span>Starting<span class="w"> </span>log<span class="w"> </span>segment<span class="w"> </span>at<span class="w"> </span><span class="m">53</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36"></a><span class="hll"><a href="#__codelineno-22-36"><span class="linenos" data-linenos="36 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,546<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.TransferFsImage:<span class="w"> </span>Sending<span class="w"> </span>fileName:<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/fsimage_0000000000000000000,<span class="w"> </span>fileSize:<span class="w"> </span><span class="m">401</span>.<span class="w"> </span>Sent<span class="w"> </span>total:<span class="w"> </span><span class="m">401</span><span class="w"> </span>bytes.<span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>last<span class="w"> </span>segment<span class="w"> </span>intended<span class="w"> </span>to<span class="w"> </span>send:<span class="w"> </span>-1<span class="w"> </span>bytes.
</span></span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37"></a><a href="#__codelineno-22-37"><span class="linenos" data-linenos="37 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:22,796<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.TransferFsImage:<span class="w"> </span>Sending<span class="w"> </span>fileName:<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/edits_0000000000000000003-0000000000000000052,<span class="w"> </span>fileSize:<span class="w"> </span><span class="m">2741</span>.<span class="w"> </span>Sent<span class="w"> </span>total:<span class="w"> </span><span class="m">2741</span><span class="w"> </span>bytes.<span class="w"> </span>Size<span class="w"> </span>of<span class="w"> </span>last<span class="w"> </span>segment<span class="w"> </span>intended<span class="w"> </span>to<span class="w"> </span>send:<span class="w"> </span>-1<span class="w"> </span>bytes.
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38"></a><a href="#__codelineno-22-38"><span class="linenos" data-linenos="38 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:23,463<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.common.Util:<span class="w"> </span>Combined<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>file<span class="w"> </span>download<span class="w"> </span>and<span class="w"> </span>fsync<span class="w"> </span>to<span class="w"> </span>all<span class="w"> </span>disks<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>,11s.<span class="w"> </span>The<span class="w"> </span>file<span class="w"> </span>download<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>,00s<span class="w"> </span>at<span class="w"> </span><span class="m">0</span>,00<span class="w"> </span>KB/s.<span class="w"> </span>Synchronous<span class="w"> </span><span class="o">(</span>fsync<span class="o">)</span><span class="w"> </span>write<span class="w"> </span>to<span class="w"> </span>disk<span class="w"> </span>of<span class="w"> </span>/opt/hadoop/hadoop_data/hdfs/namenode/current/fsimage.ckpt_0000000000000000052<span class="w"> </span>took<span class="w"> </span><span class="m">0</span>,11s.
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39"></a><a href="#__codelineno-22-39"><span class="linenos" data-linenos="39 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:23,466<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.TransferFsImage:<span class="w"> </span>Downloaded<span class="w"> </span>file<span class="w"> </span>fsimage.ckpt_0000000000000000052<span class="w"> </span>size<span class="w"> </span><span class="m">740</span><span class="w"> </span>bytes.
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40"></a><a href="#__codelineno-22-40"><span class="linenos" data-linenos="40 "></span></a><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">12</span>:58:23,580<span class="w"> </span>INFO<span class="w"> </span>org.apache.hadoop.hdfs.server.namenode.NNStorageRetentionManager:<span class="w"> </span>Going<span class="w"> </span>to<span class="w"> </span>retain<span class="w"> </span><span class="m">2</span><span class="w"> </span>images<span class="w"> </span>with<span class="w"> </span>txid<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span></code></pre></div>
<figure style="align: center;">
    <img src="images/Figura4.2_InstalandoHDFS_SecondaryNamenode_to_Namenode.jpg">
    <figcaption>Figura 2 Instalando HDFS: SecondaryNamenode y Namenode. (Fuente: Ministerio de Educación)</figcaption>
</figure>

<ol start="4">
<li>Como puedes observar en el log, se generan un conjunto de ficheros en la carpeta <code>current</code>, que contienen un conjunto de ficheros cuyos prefijos son:</li>
</ol>
<ul>
<li><em>edits_000NNN</em>: histórico de cambios que se van produciendo.</li>
<li><em>edits_inprogress_NNN</em>: cambios actuales en memoria que no se han persistido.</li>
<li><em>fsimagen_000NNN</em>: snapshot en el tiempo del sistema de ficheros.</li>
</ul>
<ol start="5">
<li>Si accedes a la carpeta HDFS <code>/opt/hadoop/hadoop_data/hdfs/namenode/current</code> desde nuestro sistema de archivos, puedes observarlos también</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos=" 1 "></span></a>hadoop@hadoop-VirtualBox:/opt/hadoop/hadoop_data/hdfs/namenode/current$<span class="w"> </span>ls
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><a href="#__codelineno-23-2"><span class="linenos" data-linenos=" 2 "></span></a>edits_0000000000000000001-0000000000000000002
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><a href="#__codelineno-23-3"><span class="linenos" data-linenos=" 3 "></span></a>edits_0000000000000000003-0000000000000000052
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a><a href="#__codelineno-23-4"><span class="linenos" data-linenos=" 4 "></span></a>edits_inprogress_0000000000000000053
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><a href="#__codelineno-23-5"><span class="linenos" data-linenos=" 5 "></span></a>fsimage_0000000000000000000
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><a href="#__codelineno-23-6"><span class="linenos" data-linenos=" 6 "></span></a>fsimage_0000000000000000000.md5
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a><a href="#__codelineno-23-7"><span class="linenos" data-linenos=" 7 "></span></a>fsimage_0000000000000000052
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a><a href="#__codelineno-23-8"><span class="linenos" data-linenos=" 8 "></span></a>fsimage_0000000000000000052.md5
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a><a href="#__codelineno-23-9"><span class="linenos" data-linenos=" 9 "></span></a>seen_txid
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a><a href="#__codelineno-23-10"><span class="linenos" data-linenos="10 "></span></a>VERSION
</span></code></pre></div>
<ol start="6">
<li>Por otro lado, si accedemos a la carpeta HDFS <code>/opt/hadoop/hadoop_data/hdfs/datanode</code> desde nuestro sistema de archivos, y entramos dentro de su subdirectorio creado después de la transacción, también podemos observar la generación de los diferentes bloques</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos=" 1 "></span></a>hadoop@hadoop-VirtualBox:/opt/hadoop/hadoop_data/hdfs/datanode/current/BP-693156123-127.0.1.1-1701082304668/current/finalized/subdir0/subdir0$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><a href="#__codelineno-24-2"><span class="linenos" data-linenos=" 2 "></span></a>total<span class="w"> </span><span class="m">1897632</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a><a href="#__codelineno-24-3"><span class="linenos" data-linenos=" 3 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:37<span class="w"> </span>blk_1073741825
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a><a href="#__codelineno-24-4"><span class="linenos" data-linenos=" 4 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:37<span class="w"> </span>blk_1073741825_1001.meta
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><a href="#__codelineno-24-5"><span class="linenos" data-linenos=" 5 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:37<span class="w"> </span>blk_1073741826
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a><a href="#__codelineno-24-6"><span class="linenos" data-linenos=" 6 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:37<span class="w"> </span>blk_1073741826_1002.meta
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a><a href="#__codelineno-24-7"><span class="linenos" data-linenos=" 7 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741827
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a><a href="#__codelineno-24-8"><span class="linenos" data-linenos=" 8 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741827_1003.meta
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a><a href="#__codelineno-24-9"><span class="linenos" data-linenos=" 9 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741828
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a><a href="#__codelineno-24-10"><span class="linenos" data-linenos="10 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741828_1004.meta
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a><a href="#__codelineno-24-11"><span class="linenos" data-linenos="11 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741829
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a><a href="#__codelineno-24-12"><span class="linenos" data-linenos="12 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741829_1005.meta
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13"></a><a href="#__codelineno-24-13"><span class="linenos" data-linenos="13 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741830
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14"></a><a href="#__codelineno-24-14"><span class="linenos" data-linenos="14 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741830_1006.meta
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15"></a><a href="#__codelineno-24-15"><span class="linenos" data-linenos="15 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741831
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16"></a><a href="#__codelineno-24-16"><span class="linenos" data-linenos="16 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741831_1007.meta
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17"></a><a href="#__codelineno-24-17"><span class="linenos" data-linenos="17 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741832
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18"></a><a href="#__codelineno-24-18"><span class="linenos" data-linenos="18 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741832_1008.meta
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19"></a><a href="#__codelineno-24-19"><span class="linenos" data-linenos="19 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741833
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20"></a><a href="#__codelineno-24-20"><span class="linenos" data-linenos="20 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741833_1009.meta
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21"></a><a href="#__codelineno-24-21"><span class="linenos" data-linenos="21 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741834
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22"></a><a href="#__codelineno-24-22"><span class="linenos" data-linenos="22 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741834_1010.meta
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23"></a><a href="#__codelineno-24-23"><span class="linenos" data-linenos="23 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741835
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24"></a><a href="#__codelineno-24-24"><span class="linenos" data-linenos="24 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741835_1011.meta
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25"></a><a href="#__codelineno-24-25"><span class="linenos" data-linenos="25 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741836
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26"></a><a href="#__codelineno-24-26"><span class="linenos" data-linenos="26 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741836_1012.meta
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27"></a><a href="#__codelineno-24-27"><span class="linenos" data-linenos="27 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741837
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28"></a><a href="#__codelineno-24-28"><span class="linenos" data-linenos="28 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741837_1013.meta
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29"></a><a href="#__codelineno-24-29"><span class="linenos" data-linenos="29 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w"> </span><span class="m">134217728</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741838
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30"></a><a href="#__codelineno-24-30"><span class="linenos" data-linenos="30 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">   </span><span class="m">1048583</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741838_1014.meta
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31"></a><a href="#__codelineno-24-31"><span class="linenos" data-linenos="31 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">  </span><span class="m">48980391</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741839
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32"></a><a href="#__codelineno-24-32"><span class="linenos" data-linenos="32 "></span></a>-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>hadoop<span class="w">    </span><span class="m">382667</span><span class="w"> </span>nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">12</span>:38<span class="w"> </span>blk_1073741839_1015.meta
</span></code></pre></div>
<ol start="7">
<li>Comprobamos toda esta información y mucha más adicional a través de la interfaz web de HDFS <code>http://bda-iesgrancapitan:9870/</code> (que es mayor que la que vimos con Cloudera, cuya versión de Hadoop es inferior)</li>
</ol>
<h3 id="75-administracion">7.5 Administración<a class="headerlink" href="#75-administracion" title="Permanent link">&para;</a></h3>
<p>HDFS también permite administración desde linea de comandos. El más usado es la opción <code>hdfs dfsadmin</code></p>
<p>Puedes ver todas las opciones en la <a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#dfsadmin">documentación oficial</a>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos=" 1 "></span></a>hadoop@hadoop-VirtualBox:~$<span class="w"> </span>hdfs<span class="w"> </span>dfsadmin
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a><a href="#__codelineno-25-2"><span class="linenos" data-linenos=" 2 "></span></a>Usage:<span class="w"> </span>hdfs<span class="w"> </span>dfsadmin
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a><a href="#__codelineno-25-3"><span class="linenos" data-linenos=" 3 "></span></a>Note:<span class="w"> </span>Administrative<span class="w"> </span>commands<span class="w"> </span>can<span class="w"> </span>only<span class="w"> </span>be<span class="w"> </span>run<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>HDFS<span class="w"> </span>superuser.
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a><a href="#__codelineno-25-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span><span class="o">[</span>-report<span class="w"> </span><span class="o">[</span>-live<span class="o">]</span><span class="w"> </span><span class="o">[</span>-dead<span class="o">]</span><span class="w"> </span><span class="o">[</span>-decommissioning<span class="o">]</span><span class="w"> </span><span class="o">[</span>-enteringmaintenance<span class="o">]</span><span class="w"> </span><span class="o">[</span>-inmaintenance<span class="o">]</span><span class="w"> </span><span class="o">[</span>-slownodes<span class="o">]]</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a><a href="#__codelineno-25-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span><span class="o">[</span>-safemode<span class="w"> </span>&lt;enter<span class="w"> </span><span class="p">|</span><span class="w"> </span>leave<span class="w"> </span><span class="p">|</span><span class="w"> </span>get<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">wait</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>forceExit&gt;<span class="o">]</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a><a href="#__codelineno-25-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">    </span><span class="o">[</span>-saveNamespace<span class="w"> </span><span class="o">[</span>-beforeShutdown<span class="o">]]</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a><a href="#__codelineno-25-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">    </span><span class="o">[</span>-rollEdits<span class="o">]</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a><a href="#__codelineno-25-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">    </span><span class="o">[</span>-restoreFailedStorage<span class="w"> </span>true<span class="p">|</span>false<span class="p">|</span>check<span class="o">]</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><a href="#__codelineno-25-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="o">[</span>-refreshNodes<span class="o">]</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10"></a><a href="#__codelineno-25-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span><span class="o">[</span>-setQuota<span class="w"> </span>&lt;quota&gt;<span class="w"> </span>&lt;dirname&gt;...&lt;dirname&gt;<span class="o">]</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11"></a><a href="#__codelineno-25-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="o">[</span>-clrQuota<span class="w"> </span>&lt;dirname&gt;...&lt;dirname&gt;<span class="o">]</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12"></a><a href="#__codelineno-25-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="o">[</span>-setSpaceQuota<span class="w"> </span>&lt;quota&gt;<span class="w"> </span><span class="o">[</span>-storageType<span class="w"> </span>&lt;storagetype&gt;<span class="o">]</span><span class="w"> </span>&lt;dirname&gt;...&lt;dirname&gt;<span class="o">]</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13"></a><a href="#__codelineno-25-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span><span class="o">[</span>-clrSpaceQuota<span class="w"> </span><span class="o">[</span>-storageType<span class="w"> </span>&lt;storagetype&gt;<span class="o">]</span><span class="w"> </span>&lt;dirname&gt;...&lt;dirname&gt;<span class="o">]</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14"></a><a href="#__codelineno-25-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">    </span><span class="o">[</span>-finalizeUpgrade<span class="o">]</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15"></a><a href="#__codelineno-25-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="o">[</span>-rollingUpgrade<span class="w"> </span><span class="o">[</span>&lt;query<span class="p">|</span>prepare<span class="p">|</span>finalize&gt;<span class="o">]]</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16"></a><a href="#__codelineno-25-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">    </span><span class="o">[</span>-upgrade<span class="w"> </span>&lt;query<span class="w"> </span><span class="p">|</span><span class="w"> </span>finalize&gt;<span class="o">]</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17"></a><a href="#__codelineno-25-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">    </span><span class="o">[</span>-refreshServiceAcl<span class="o">]</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18"></a><a href="#__codelineno-25-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span><span class="o">[</span>-refreshUserToGroupsMappings<span class="o">]</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19"></a><a href="#__codelineno-25-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">    </span><span class="o">[</span>-refreshSuperUserGroupsConfiguration<span class="o">]</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20"></a><a href="#__codelineno-25-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">    </span><span class="o">[</span>-refreshCallQueue<span class="o">]</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21"></a><a href="#__codelineno-25-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">    </span><span class="o">[</span>-refresh<span class="w"> </span>&lt;host:ipc_port&gt;<span class="w"> </span>&lt;key&gt;<span class="w"> </span><span class="o">[</span>arg1..argn<span class="o">]</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22"></a><a href="#__codelineno-25-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">    </span><span class="o">[</span>-reconfig<span class="w"> </span>&lt;namenode<span class="p">|</span>datanode&gt;<span class="w"> </span>&lt;host:ipc_port<span class="p">|</span>livenodes&gt;<span class="w"> </span>&lt;start<span class="p">|</span>status<span class="p">|</span>properties&gt;<span class="o">]</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23"></a><a href="#__codelineno-25-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">    </span><span class="o">[</span>-printTopology<span class="o">]</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24"></a><a href="#__codelineno-25-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">    </span><span class="o">[</span>-refreshNamenodes<span class="w"> </span>datanode_host:ipc_port<span class="o">]</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25"></a><a href="#__codelineno-25-25"><span class="linenos" data-linenos="25 "></span></a><span class="w">    </span><span class="o">[</span>-getVolumeReport<span class="w"> </span>datanode_host:ipc_port<span class="o">]</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26"></a><a href="#__codelineno-25-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">    </span><span class="o">[</span>-deleteBlockPool<span class="w"> </span>datanode_host:ipc_port<span class="w"> </span>blockpoolId<span class="w"> </span><span class="o">[</span>force<span class="o">]]</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27"></a><a href="#__codelineno-25-27"><span class="linenos" data-linenos="27 "></span></a><span class="w">    </span><span class="o">[</span>-setBalancerBandwidth<span class="w"> </span>&lt;bandwidth<span class="w"> </span><span class="k">in</span><span class="w"> </span>bytes<span class="w"> </span>per<span class="w"> </span>second&gt;<span class="o">]</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28"></a><a href="#__codelineno-25-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">    </span><span class="o">[</span>-getBalancerBandwidth<span class="w"> </span>&lt;datanode_host:ipc_port&gt;<span class="o">]</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29"></a><a href="#__codelineno-25-29"><span class="linenos" data-linenos="29 "></span></a><span class="w">    </span><span class="o">[</span>-fetchImage<span class="w"> </span>&lt;<span class="nb">local</span><span class="w"> </span>directory&gt;<span class="o">]</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30"></a><a href="#__codelineno-25-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">    </span><span class="o">[</span>-allowSnapshot<span class="w"> </span>&lt;snapshotDir&gt;<span class="o">]</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31"></a><a href="#__codelineno-25-31"><span class="linenos" data-linenos="31 "></span></a><span class="w">    </span><span class="o">[</span>-disallowSnapshot<span class="w"> </span>&lt;snapshotDir&gt;<span class="o">]</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32"></a><a href="#__codelineno-25-32"><span class="linenos" data-linenos="32 "></span></a><span class="w">    </span><span class="o">[</span>-shutdownDatanode<span class="w"> </span>&lt;datanode_host:ipc_port&gt;<span class="w"> </span><span class="o">[</span>upgrade<span class="o">]]</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33"></a><a href="#__codelineno-25-33"><span class="linenos" data-linenos="33 "></span></a><span class="w">    </span><span class="o">[</span>-evictWriters<span class="w"> </span>&lt;datanode_host:ipc_port&gt;<span class="o">]</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34"></a><a href="#__codelineno-25-34"><span class="linenos" data-linenos="34 "></span></a><span class="w">    </span><span class="o">[</span>-getDatanodeInfo<span class="w"> </span>&lt;datanode_host:ipc_port&gt;<span class="o">]</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35"></a><a href="#__codelineno-25-35"><span class="linenos" data-linenos="35 "></span></a><span class="w">    </span><span class="o">[</span>-metasave<span class="w"> </span>filename<span class="o">]</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36"></a><a href="#__codelineno-25-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">    </span><span class="o">[</span>-triggerBlockReport<span class="w"> </span><span class="o">[</span>-incremental<span class="o">]</span><span class="w"> </span>&lt;datanode_host:ipc_port&gt;<span class="w"> </span><span class="o">[</span>-namenode<span class="w"> </span>&lt;namenode_host:ipc_port&gt;<span class="o">]]</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37"></a><a href="#__codelineno-25-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">    </span><span class="o">[</span>-listOpenFiles<span class="w"> </span><span class="o">[</span>-blockingDecommission<span class="o">]</span><span class="w"> </span><span class="o">[</span>-path<span class="w"> </span>&lt;path&gt;<span class="o">]]</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38"></a><a href="#__codelineno-25-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">    </span><span class="o">[</span>-help<span class="w"> </span><span class="o">[</span>cmd<span class="o">]]</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39"></a><a href="#__codelineno-25-39"><span class="linenos" data-linenos="39 "></span></a>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40"></a><a href="#__codelineno-25-40"><span class="linenos" data-linenos="40 "></span></a>Generic<span class="w"> </span>options<span class="w"> </span>supported<span class="w"> </span>are:
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41"></a><a href="#__codelineno-25-41"><span class="linenos" data-linenos="41 "></span></a>-conf<span class="w"> </span>&lt;configuration<span class="w"> </span>file&gt;<span class="w">        </span>specify<span class="w"> </span>an<span class="w"> </span>application<span class="w"> </span>configuration<span class="w"> </span>file
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42"></a><a href="#__codelineno-25-42"><span class="linenos" data-linenos="42 "></span></a>-D<span class="w"> </span>&lt;<span class="nv">property</span><span class="o">=</span>value&gt;<span class="w">               </span>define<span class="w"> </span>a<span class="w"> </span>value<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>given<span class="w"> </span>property
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43"></a><a href="#__codelineno-25-43"><span class="linenos" data-linenos="43 "></span></a>-fs<span class="w"> </span>&lt;file:///<span class="p">|</span>hdfs://namenode:port&gt;<span class="w"> </span>specify<span class="w"> </span>default<span class="w"> </span>filesystem<span class="w"> </span>URL<span class="w"> </span>to<span class="w"> </span>use,<span class="w"> </span>overrides<span class="w"> </span><span class="s1">&#39;fs.defaultFS&#39;</span><span class="w"> </span>property<span class="w"> </span>from<span class="w"> </span>configurations.
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44"></a><a href="#__codelineno-25-44"><span class="linenos" data-linenos="44 "></span></a>-jt<span class="w"> </span>&lt;local<span class="p">|</span>resourcemanager:port&gt;<span class="w">  </span>specify<span class="w"> </span>a<span class="w"> </span>ResourceManager
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45"></a><a href="#__codelineno-25-45"><span class="linenos" data-linenos="45 "></span></a>-files<span class="w"> </span>&lt;file1,...&gt;<span class="w">                </span>specify<span class="w"> </span>a<span class="w"> </span>comma-separated<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>copied<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>map<span class="w"> </span>reduce<span class="w"> </span>cluster
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46"></a><a href="#__codelineno-25-46"><span class="linenos" data-linenos="46 "></span></a>-libjars<span class="w"> </span>&lt;jar1,...&gt;<span class="w">               </span>specify<span class="w"> </span>a<span class="w"> </span>comma-separated<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>jar<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>included<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>classpath
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47"></a><a href="#__codelineno-25-47"><span class="linenos" data-linenos="47 "></span></a>-archives<span class="w"> </span>&lt;archive1,...&gt;<span class="w">          </span>specify<span class="w"> </span>a<span class="w"> </span>comma-separated<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>archives<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>unarchived<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>compute<span class="w"> </span>machines
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48"></a><a href="#__codelineno-25-48"><span class="linenos" data-linenos="48 "></span></a>
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49"></a><a href="#__codelineno-25-49"><span class="linenos" data-linenos="49 "></span></a>The<span class="w"> </span>general<span class="w"> </span><span class="nb">command</span><span class="w"> </span>line<span class="w"> </span>syntax<span class="w"> </span>is:
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50"></a><a href="#__codelineno-25-50"><span class="linenos" data-linenos="50 "></span></a><span class="nb">command</span><span class="w"> </span><span class="o">[</span>genericOptions<span class="o">]</span><span class="w"> </span><span class="o">[</span>commandOptions<span class="o">]</span>
</span></code></pre></div>
<p>Vamos a probar algunas de ellas:</p>
<ul>
<li><code>hdfs dfsadmin -report</code>: Realiza un resumen del sistema HDFS, donde podemos comprobar el estado de los diferentes nodos. Es similar al que aparece en el interfaz web.</li>
<li><code>hdfs dfsadmin -listOpenFiles</code>: Comprueba si hay algún fichero abierto.</li>
<li><code>hdfs dfsadmin -printTopology</code>: Muestra la topología, identificando los nodos que tenemos y al rack al que pertenece cada nodo.</li>
<li><code>hdfs dfsadmin -safemode enter</code>: Pone el sistema en modo seguro, el cual evita la modificación de los recursos del sistema de archivos.</li>
<li><code>hdfs dfsadmin -safemode leave</code>: Sale del modo seguro.</li>
</ul>
<p>Otro ejemplo:</p>
<ul>
<li><code>hdfs fsck</code>: Comprueba el estado del sistema de ficheros. Si queremos comprobar el estado de un determinado directorio, lo indicamos mediante un segundo parámetro: <code>hdfs fsck /</code></li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos=" 1 "></span></a>hadoop@hadoop-VirtualBox:~$<span class="w"> </span>hdfs<span class="w"> </span>fsck<span class="w"> </span>/
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><a href="#__codelineno-26-2"><span class="linenos" data-linenos=" 2 "></span></a>onnecting<span class="w"> </span>to<span class="w"> </span>namenode<span class="w"> </span>via<span class="w"> </span>http://bda-iesgrancapitan:9870/fsck?ugi<span class="o">=</span>hadoop<span class="p">&amp;</span><span class="nv">path</span><span class="o">=</span>%2F
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a><a href="#__codelineno-26-3"><span class="linenos" data-linenos=" 3 "></span></a>FSCK<span class="w"> </span>started<span class="w"> </span>by<span class="w"> </span>hadoop<span class="w"> </span><span class="o">(</span>auth:SIMPLE<span class="o">)</span><span class="w"> </span>from<span class="w"> </span>/127.0.0.1<span class="w"> </span><span class="k">for</span><span class="w"> </span>path<span class="w"> </span>/<span class="w"> </span>at<span class="w"> </span>Mon<span class="w"> </span>Nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">13</span>:14:05<span class="w"> </span>CET<span class="w"> </span><span class="m">2023</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a><a href="#__codelineno-26-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><a href="#__codelineno-26-5"><span class="linenos" data-linenos=" 5 "></span></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a><a href="#__codelineno-26-6"><span class="linenos" data-linenos=" 6 "></span></a>Status:<span class="w"> </span>HEALTHY
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><a href="#__codelineno-26-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>data-nodes:<span class="w">  </span><span class="m">1</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a><a href="#__codelineno-26-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>racks:<span class="w">       </span><span class="m">1</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><a href="#__codelineno-26-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w"> </span>Total<span class="w"> </span>dirs:<span class="w">            </span><span class="m">1</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a><a href="#__codelineno-26-10"><span class="linenos" data-linenos="10 "></span></a><span class="w"> </span>Total<span class="w"> </span>symlinks:<span class="w">        </span><span class="m">0</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a><a href="#__codelineno-26-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12"></a><a href="#__codelineno-26-12"><span class="linenos" data-linenos="12 "></span></a>Replicated<span class="w"> </span>Blocks:
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13"></a><a href="#__codelineno-26-13"><span class="linenos" data-linenos="13 "></span></a><span class="w"> </span>Total<span class="w"> </span>size:<span class="w">    </span><span class="m">1928028583</span><span class="w"> </span>B
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14"></a><a href="#__codelineno-26-14"><span class="linenos" data-linenos="14 "></span></a><span class="w"> </span>Total<span class="w"> </span>files:<span class="w">   </span><span class="m">1</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15"></a><a href="#__codelineno-26-15"><span class="linenos" data-linenos="15 "></span></a><span class="w"> </span>Total<span class="w"> </span>blocks<span class="w"> </span><span class="o">(</span>validated<span class="o">)</span>:<span class="w">  </span><span class="m">15</span><span class="w"> </span><span class="o">(</span>avg.<span class="w"> </span>block<span class="w"> </span>size<span class="w"> </span><span class="m">128535238</span><span class="w"> </span>B<span class="o">)</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16"></a><a href="#__codelineno-26-16"><span class="linenos" data-linenos="16 "></span></a><span class="w"> </span>Minimally<span class="w"> </span>replicated<span class="w"> </span>blocks:<span class="w">   </span><span class="m">15</span><span class="w"> </span><span class="o">(</span><span class="m">100</span>.0<span class="w"> </span>%<span class="o">)</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17"></a><a href="#__codelineno-26-17"><span class="linenos" data-linenos="17 "></span></a><span class="w"> </span>Over-replicated<span class="w"> </span>blocks:<span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>%<span class="o">)</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18"></a><a href="#__codelineno-26-18"><span class="linenos" data-linenos="18 "></span></a><span class="w"> </span>Under-replicated<span class="w"> </span>blocks:<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>%<span class="o">)</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19"></a><a href="#__codelineno-26-19"><span class="linenos" data-linenos="19 "></span></a><span class="w"> </span>Mis-replicated<span class="w"> </span>blocks:<span class="w">     </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>%<span class="o">)</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20"></a><a href="#__codelineno-26-20"><span class="linenos" data-linenos="20 "></span></a><span class="w"> </span>Default<span class="w"> </span>replication<span class="w"> </span>factor:<span class="w">    </span><span class="m">1</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21"></a><a href="#__codelineno-26-21"><span class="linenos" data-linenos="21 "></span></a><span class="w"> </span>Average<span class="w"> </span>block<span class="w"> </span>replication:<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22"></a><a href="#__codelineno-26-22"><span class="linenos" data-linenos="22 "></span></a><span class="w"> </span>Missing<span class="w"> </span>blocks:<span class="w">        </span><span class="m">0</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23"></a><a href="#__codelineno-26-23"><span class="linenos" data-linenos="23 "></span></a><span class="w"> </span>Corrupt<span class="w"> </span>blocks:<span class="w">        </span><span class="m">0</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24"></a><a href="#__codelineno-26-24"><span class="linenos" data-linenos="24 "></span></a><span class="w"> </span>Missing<span class="w"> </span>replicas:<span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>%<span class="o">)</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25"></a><a href="#__codelineno-26-25"><span class="linenos" data-linenos="25 "></span></a><span class="w"> </span>Blocks<span class="w"> </span>queued<span class="w"> </span><span class="k">for</span><span class="w"> </span>replication:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26"></a><a href="#__codelineno-26-26"><span class="linenos" data-linenos="26 "></span></a>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27"></a><a href="#__codelineno-26-27"><span class="linenos" data-linenos="27 "></span></a>Erasure<span class="w"> </span>Coded<span class="w"> </span>Block<span class="w"> </span>Groups:
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28"></a><a href="#__codelineno-26-28"><span class="linenos" data-linenos="28 "></span></a><span class="w"> </span>Total<span class="w"> </span>size:<span class="w">    </span><span class="m">0</span><span class="w"> </span>B
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29"></a><a href="#__codelineno-26-29"><span class="linenos" data-linenos="29 "></span></a><span class="w"> </span>Total<span class="w"> </span>files:<span class="w">   </span><span class="m">0</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30"></a><a href="#__codelineno-26-30"><span class="linenos" data-linenos="30 "></span></a><span class="w"> </span>Total<span class="w"> </span>block<span class="w"> </span>groups<span class="w"> </span><span class="o">(</span>validated<span class="o">)</span>:<span class="w">    </span><span class="m">0</span>
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31"></a><a href="#__codelineno-26-31"><span class="linenos" data-linenos="31 "></span></a><span class="w"> </span>Minimally<span class="w"> </span>erasure-coded<span class="w"> </span>block<span class="w"> </span>groups:<span class="w">  </span><span class="m">0</span>
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32"></a><a href="#__codelineno-26-32"><span class="linenos" data-linenos="32 "></span></a><span class="w"> </span>Over-erasure-coded<span class="w"> </span>block<span class="w"> </span>groups:<span class="w">   </span><span class="m">0</span>
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33"></a><a href="#__codelineno-26-33"><span class="linenos" data-linenos="33 "></span></a><span class="w"> </span>Under-erasure-coded<span class="w"> </span>block<span class="w"> </span>groups:<span class="w">  </span><span class="m">0</span>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34"></a><a href="#__codelineno-26-34"><span class="linenos" data-linenos="34 "></span></a><span class="w"> </span>Unsatisfactory<span class="w"> </span>placement<span class="w"> </span>block<span class="w"> </span>groups:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35"></a><a href="#__codelineno-26-35"><span class="linenos" data-linenos="35 "></span></a><span class="w"> </span>Average<span class="w"> </span>block<span class="w"> </span>group<span class="w"> </span>size:<span class="w">  </span><span class="m">0</span>.0
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36"></a><a href="#__codelineno-26-36"><span class="linenos" data-linenos="36 "></span></a><span class="w"> </span>Missing<span class="w"> </span>block<span class="w"> </span>groups:<span class="w">      </span><span class="m">0</span>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37"></a><a href="#__codelineno-26-37"><span class="linenos" data-linenos="37 "></span></a><span class="w"> </span>Corrupt<span class="w"> </span>block<span class="w"> </span>groups:<span class="w">      </span><span class="m">0</span>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38"></a><a href="#__codelineno-26-38"><span class="linenos" data-linenos="38 "></span></a><span class="w"> </span>Missing<span class="w"> </span>internal<span class="w"> </span>blocks:<span class="w">   </span><span class="m">0</span>
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39"></a><a href="#__codelineno-26-39"><span class="linenos" data-linenos="39 "></span></a><span class="w"> </span>Blocks<span class="w"> </span>queued<span class="w"> </span><span class="k">for</span><span class="w"> </span>replication:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40"></a><a href="#__codelineno-26-40"><span class="linenos" data-linenos="40 "></span></a>FSCK<span class="w"> </span>ended<span class="w"> </span>at<span class="w"> </span>Mon<span class="w"> </span>Nov<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">13</span>:14:06<span class="w"> </span>CET<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">13</span><span class="w"> </span>milliseconds
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41"></a><a href="#__codelineno-26-41"><span class="linenos" data-linenos="41 "></span></a>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42"></a><a href="#__codelineno-26-42"><span class="linenos" data-linenos="42 "></span></a>
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43"></a><a href="#__codelineno-26-43"><span class="linenos" data-linenos="43 "></span></a>The<span class="w"> </span>filesystem<span class="w"> </span>under<span class="w"> </span>path<span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span>is<span class="w"> </span>HEALTHY
</span></code></pre></div>
<p>También existen otros comandos interesantes como: <code>balancer</code>, <code>cacheadmin</code>, <code>datanode</code>, <code>namenode</code>,... </p>
<p>Puedes consultar la lista completa en la <a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#Administration_Commands">documentación oficial</a></p>
<h3 id="76-snapshots">7.6 Snapshots<a class="headerlink" href="#76-snapshots" title="Permanent link">&para;</a></h3>
<p>Mediante <strong><em>Snapshots</em></strong> podemos guardar la instantánea de como se encuentra todo nuestros datos dentro del sistema de ficheros, que puede servir como copia de seguridad, para un futuro backup.</p>
<p>Vamos a realizar un ejemplo. Creamos un directorio dentro de nuestro HDFS y copiamos nuestro fichero de genoma 2021 dentro de él:</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/bda
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a><a href="#__codelineno-27-2"><span class="linenos" data-linenos="2 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-cp<span class="w"> </span>/genome_2021.zip<span class="w"> </span>/bda
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a><a href="#__codelineno-27-3"><span class="linenos" data-linenos="3 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/bda
</span></code></pre></div>
Activamos el uso de snapshot en el directorio que queramos obtener una instantánea:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfsadmin<span class="w"> </span>-allowSnapshot<span class="w"> </span>/bda
</span></code></pre></div>
<p>Procedemos a crear una instantánea indicando la carpeta y el nombre que va a tener</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-createSnapshot<span class="w"> </span>/bda<span class="w"> </span>snapshot_bda_1
</span></code></pre></div>
<p>Se crea una carpeta oculta dentro de la carpeta que contendrá la información <code>/bda/.snapshot/snapshot_bda_1</code></p>
<p>Puedes verlo también desde la interfaz web de HDFS en su apartado de Snapshot</p>
<figure style="align: center;">
    <img src="images/Figura4.3_InstalandoHDFS_Snapshot.jpg">
    <figcaption>Figura 3 Instalando HDFS: Snapshot. (Fuente: Propia)</figcaption>
</figure>

<p>Vamos a borrar el archivo que hemos copiado y comprobamos</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-rm<span class="w"> </span>/bda/genome_2021.zip
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><a href="#__codelineno-30-2"><span class="linenos" data-linenos="2 "></span></a>//Deleted<span class="w"> </span>/bda/genome_2021.zip
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><a href="#__codelineno-30-3"><span class="linenos" data-linenos="3 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/bda/
</span></code></pre></div>
Para recuperar el fichero usamos el snapshot creado anteriormente</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-cp<span class="w"> </span>/bda/.snapshot/snapshot_bda_1/genome_2021.zip<span class="w"> </span>/bda/genome_2021.zip
</span></code></pre></div>
<p>Para comprobar los directorios que actualmente soportan snapshot hacemos un ls de los mismos con su comando correspondiente:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>lsSnapshottableDir
</span></code></pre></div>
<p>Por último, para borrar un snapshot:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-deleteSnapshot<span class="w"> </span>/bda<span class="w"> </span>snapshot_bda_1
</span></code></pre></div>
<p>Y si queremos desabilitarlo los snapshot:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfsadmin<span class="w"> </span>-disallowSnapshot<span class="w"> </span>/bda
</span></code></pre></div>
<h3 id="77-navegacion-webui-hdfs">7.7 Navegación WebUI HDFS<a class="headerlink" href="#77-navegacion-webui-hdfs" title="Permanent link">&para;</a></h3>
<p>Desde el apartado <code>Browser Directory</code> del Web IU <code>http://bda-iesgrancapitan:9870/explorer.html</code> podemos acceder al sistema de ficheros y su contenido de HDFS, incluidos los bloques.</p>
<figure style="align: center;">
    <img src="images/Figura4.4_InstalandoHDFS_Navegacion_WebUI.jpg">
    <figcaption>Figura 4 Instalando HDFS: Navegación WebUI. (Fuente: Propia)</figcaption>
</figure>

<h3 id="78-permisos-webui-hdfs">7.8 Permisos WebUI HDFS<a class="headerlink" href="#78-permisos-webui-hdfs" title="Permanent link">&para;</a></h3>
<p>Como hemos comentado en el punto anterior, podemos acceder al sistema de ficheros y su contenido de HDFS. Pero si intentamos borrar algún contenido nos salta un error de permisos: <code>Permission denied: user=dr.who, access=WRITE, inode="/bda":hadoop:supergroup:drwxr-xr-x</code>. Esto es debido a que, por defecto, los recursos vía web se realizan desde el usuario <code>dr.who</code></p>
<figure style="align: center;">
    <img src="images/Figura4.5_InstalandoHDFS_WebUI_Permisos.jpg">
    <figcaption>Figura 5 Instalando HDFS: Permisos WebUI. (Fuente: Propia)</figcaption>
</figure>

<p>Para poder tener permisos para ello podemos modificar los permisos:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos="1 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/bda/prueba_permisos
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a><a href="#__codelineno-35-2"><span class="linenos" data-linenos="2 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-chmod<span class="w"> </span><span class="m">777</span><span class="w"> </span>/bda/prueba_permisos
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><a href="#__codelineno-35-3"><span class="linenos" data-linenos="3 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-cp<span class="w"> </span>/bda/genome_2021.zip<span class="w"> </span>/bda/prueba_permisos/
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a><a href="#__codelineno-35-4"><span class="linenos" data-linenos="4 "></span></a>//Ya<span class="w"> </span>podríamos<span class="w"> </span>borrar<span class="w"> </span>cualquier<span class="w"> </span>archivo<span class="w"> </span>dentro<span class="w"> </span>del<span class="w"> </span>directorio<span class="w"> </span>pruebas_permisos<span class="w"> </span>desde<span class="w"> </span>la<span class="w"> </span>WebUI
</span></code></pre></div>
<p>Otra posibilidad es modificar el archivo de configuraciónb <code>core-site.xml</code> y añadir la propiedad para modificar el usuario estático, en mi caso, el usuario <code>hadoop</code></p>
<div class="language-xml highlight"><span class="filename">core-site.xml</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">&lt;property&gt;</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a><a href="#__codelineno-36-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>hadoop.http.staticuser.user<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a><a href="#__codelineno-36-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">    </span><span class="nt">&lt;value&gt;</span>hadoop<span class="nt">&lt;/value&gt;</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4"></a><a href="#__codelineno-36-4"><span class="linenos" data-linenos="4 "></span></a><span class="nt">&lt;/property&gt;</span>
</span></code></pre></div>
<h3 id="79-acceso-a-hdfs-a-traves-de-python">7.9 Acceso a HDFS a través de Python<a class="headerlink" href="#79-acceso-a-hdfs-a-traves-de-python" title="Permanent link">&para;</a></h3>
<p>Para ello, usaremos la libreria <a href="https://pypi.org/project/hdfs/">HdfsCLI</a>. La instalamos mediante <code>pip</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a>pip<span class="w"> </span>install<span class="w"> </span>hdfs
</span></code></pre></div>
<p>Para nuestro ejemplo, vamos a descargar un ejemplo con formato csv y añadirlo a nuestro HDFS</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos="1 "></span></a>wget<span class="w"> </span>https://www.ine.es/jaxi/files/tpx/csv_bdsc/53938.csv
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a><a href="#__codelineno-38-2"><span class="linenos" data-linenos="2 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/bda/python
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a><a href="#__codelineno-38-3"><span class="linenos" data-linenos="3 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-copyFromLocal<span class="w"> </span><span class="m">53938</span>.csv<span class="w">  </span>/bda/python/
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a><a href="#__codelineno-38-4"><span class="linenos" data-linenos="4 "></span></a>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/bda/python
</span></code></pre></div>
<p><a href="https://hdfscli.readthedocs.io/en/latest/quickstart.html#python-bindings">Teniendo como referencia la documentación</a>, vamos a conectarnos a HDFS y copiar un archivo</p>
<p>Creamos un fichero python con el siguiente código:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a><a href="#__codelineno-39-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span> <span class="nn">hdfs</span> <span class="kn">import</span> <span class="n">InsecureClient</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a><a href="#__codelineno-39-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a><a href="#__codelineno-39-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="c1"># Datos de conexión</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a><a href="#__codelineno-39-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">HDFS_HOSTNAME</span> <span class="o">=</span> <span class="s1">&#39;bda-iesgrancapitan&#39;</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a><a href="#__codelineno-39-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">HDFS_PORT</span> <span class="o">=</span> <span class="mi">9870</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a><a href="#__codelineno-39-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">HDFS_CONNECTION</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://</span><span class="si">{</span><span class="n">HDFS_HOSTNAME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">HDFS_PORT</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a><a href="#__codelineno-39-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8"></a><a href="#__codelineno-39-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># En nuestro caso, al no usar Kerberos, creamos una conexión no segura</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9"></a><a href="#__codelineno-39-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">hdfs_client</span> <span class="o">=</span> <span class="n">InsecureClient</span><span class="p">(</span><span class="n">HDFS_CONNECTION</span><span class="p">)</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10"></a><a href="#__codelineno-39-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11"></a><a href="#__codelineno-39-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1">#Lectura</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12"></a><a href="#__codelineno-39-12"><span class="linenos" data-linenos="12 "></span></a><span class="c1"># Leemos el fichero de &#39;53938.csv&#39; que tenemos en HDFS</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13"></a><a href="#__codelineno-39-13"><span class="linenos" data-linenos="13 "></span></a><span class="n">fichero</span> <span class="o">=</span> <span class="s1">&#39;/bda/python/53938.csv&#39;</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14"></a><a href="#__codelineno-39-14"><span class="linenos" data-linenos="14 "></span></a><span class="k">with</span> <span class="n">hdfs_client</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fichero</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15"></a><a href="#__codelineno-39-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">texto</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16"></a><a href="#__codelineno-39-16"><span class="linenos" data-linenos="16 "></span></a>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17"></a><a href="#__codelineno-39-17"><span class="linenos" data-linenos="17 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">texto</span><span class="p">)</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18"></a><a href="#__codelineno-39-18"><span class="linenos" data-linenos="18 "></span></a>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19"></a><a href="#__codelineno-39-19"><span class="linenos" data-linenos="19 "></span></a><span class="c1">#Escritura</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20"></a><a href="#__codelineno-39-20"><span class="linenos" data-linenos="20 "></span></a><span class="c1"># Escribimos los elementos de la lista en formato csv</span>
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21"></a><a href="#__codelineno-39-21"><span class="linenos" data-linenos="21 "></span></a><span class="n">datos</span><span class="o">=</span><span class="s2">&quot;dni,nombre,apellidos,direccion,cp</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22"></a><a href="#__codelineno-39-22"><span class="linenos" data-linenos="22 "></span></a><span class="n">lista</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre1&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellidos1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mikasa1&#39;</span><span class="p">,</span> <span class="s1">&#39;14000&#39;</span><span class="p">],</span>
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23"></a><a href="#__codelineno-39-23"><span class="linenos" data-linenos="23 "></span></a>         <span class="p">[</span><span class="s1">&#39;456&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre4&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellidos4&#39;</span><span class="p">,</span> <span class="s1">&#39;Mikasa4&#39;</span><span class="p">,</span> <span class="s1">&#39;41000&#39;</span><span class="p">],</span>
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24"></a><a href="#__codelineno-39-24"><span class="linenos" data-linenos="24 "></span></a>         <span class="p">[</span><span class="s1">&#39;789&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre7&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellidos7&#39;</span><span class="p">,</span> <span class="s1">&#39;Mikasa7&#39;</span><span class="p">,</span> <span class="s1">&#39;19000&#39;</span><span class="p">]]</span>
</span><span id="__span-39-25"><a id="__codelineno-39-25" name="__codelineno-39-25"></a><a href="#__codelineno-39-25"><span class="linenos" data-linenos="25 "></span></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-39-26"><a id="__codelineno-39-26" name="__codelineno-39-26"></a><a href="#__codelineno-39-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-39-27"><a id="__codelineno-39-27" name="__codelineno-39-27"></a><a href="#__codelineno-39-27"><span class="linenos" data-linenos="27 "></span></a>        <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="__span-39-28"><a id="__codelineno-39-28" name="__codelineno-39-28"></a><a href="#__codelineno-39-28"><span class="linenos" data-linenos="28 "></span></a>            <span class="n">datos</span><span class="o">+=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1">,&#39;</span>
</span><span id="__span-39-29"><a id="__codelineno-39-29" name="__codelineno-39-29"></a><a href="#__codelineno-39-29"><span class="linenos" data-linenos="29 "></span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-39-30"><a id="__codelineno-39-30" name="__codelineno-39-30"></a><a href="#__codelineno-39-30"><span class="linenos" data-linenos="30 "></span></a>            <span class="n">datos</span><span class="o">+=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="__span-39-31"><a id="__codelineno-39-31" name="__codelineno-39-31"></a><a href="#__codelineno-39-31"><span class="linenos" data-linenos="31 "></span></a><span class="n">hdfs_client</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;/bda/python/datos.csv&quot;</span><span class="p">,</span> <span class="n">datos</span><span class="p">)</span>
</span></code></pre></div>
<p>Ejecutamos el fichero</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><a href="#__codelineno-40-1"><span class="linenos" data-linenos="1 "></span></a>python3<span class="w"> </span>prueba_hdfs_Python.py
</span></code></pre></div>
<p>Comprobamos la cración del nuevo fichero</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a><a href="#__codelineno-41-1"><span class="linenos" data-linenos="1 "></span></a>hadoop@hadoop-VirtualBox:~$<span class="w"> </span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/bda/python/
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a><a href="#__codelineno-41-2"><span class="linenos" data-linenos="2 "></span></a>Found<span class="w"> </span><span class="m">2</span><span class="w"> </span>items
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3"></a><a href="#__codelineno-41-3"><span class="linenos" data-linenos="3 "></span></a>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>supergroup<span class="w">      </span><span class="m">60116</span><span class="w"> </span><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">13</span>:55<span class="w"> </span>/bda/python/53938.csv
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4"></a><a href="#__codelineno-41-4"><span class="linenos" data-linenos="4 "></span></a>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>hadoop<span class="w"> </span>supergroup<span class="w">        </span><span class="m">145</span><span class="w"> </span><span class="m">2023</span>-11-27<span class="w"> </span><span class="m">13</span>:56<span class="w"> </span>/bda/python/datos.csv
</span></code></pre></div>
<p>Adicionalmente, esta librería te da <a href="https://pypi.org/project/hdfs/">funcionalidad opcional</a> para <code>avro</code>, <code>dataframe</code> (con Pandas) y <code>Kerberos</code>. Estos casos son los más habituales en el mundo real.</p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023-2024 Jaime Rabasco - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/jaimerabasco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<jaimerabasco@iesgrancapitan.org>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.indexes", "toc.follow", "navigation.top", "header.autohide", "announce.dismiss", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>